!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){n(1),n(9),n(2),n(3),n(4),n(5),n(6),n(7),e.exports=n(8)},function(e,t,n){var i=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var r=t&&t.prototype instanceof d?t:d,o=Object.create(r.prototype),a=new T(i||[]);return o._invoke=function(e,t,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return j()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=k(a,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=u(e,t,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var c={};function d(){}function h(){}function f(){}var m={};s(m,r,(function(){return this}));var p=Object.getPrototypeOf,v=p&&p(p(x([])));v&&v!==t&&n.call(v,r)&&(m=v);var y=f.prototype=d.prototype=Object.create(m);function g(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var i;this._invoke=function(r,o){function a(){return new t((function(i,a){!function i(r,o,a,s){var l=u(e[r],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}(r,o,i,a)}))}return i=i?i.then(a,a):a()}}function k(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,c;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function x(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return h.prototype=f,s(y,"constructor",f),s(f,"constructor",h),h.displayName=s(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},g(b.prototype),s(b.prototype,o,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var a=new b(l(t,n,i,r),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(y),s(y,a,"Generator"),s(y,r,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=x,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;C(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=i}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var i,r;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),function(e){e[e.identifier=0]="identifier",e[e.integerConstant=1]="integerConstant",e[e.floatingPointConstant=2]="floatingPointConstant",e[e.booleanConstant=3]="booleanConstant",e[e.stringConstant=4]="stringConstant",e[e.charConstant=5]="charConstant",e[e.true=6]="true",e[e.false=7]="false",e[e.keywordRename=8]="keywordRename",e[e.keywordTo=9]="keywordTo",e[e.keywordAlter=10]="keywordAlter",e[e.keywordCommit=11]="keywordCommit",e[e.keywordAdd=12]="keywordAdd",e[e.keywordDelete=13]="keywordDelete",e[e.keywordSelect=14]="keywordSelect",e[e.keywordInsert=15]="keywordInsert",e[e.keywordInto=16]="keywordInto",e[e.keywordValues=17]="keywordValues",e[e.keywordUpdate=18]="keywordUpdate",e[e.keywordSet=19]="keywordSet",e[e.keywordNo=20]="keywordNo",e[e.keywordUse=21]="keywordUse",e[e.keywordCreate=22]="keywordCreate",e[e.keywordReferences=23]="keywordReferences",e[e.keywordPrimary=24]="keywordPrimary",e[e.keywordForeign=25]="keywordForeign",e[e.keywordTable=26]="keywordTable",e[e.keywordTables=27]="keywordTables",e[e.keywordColumn=28]="keywordColumn",e[e.keywordDrop=29]="keywordDrop",e[e.keywordUnique=30]="keywordUnique",e[e.keywordKey=31]="keywordKey",e[e.keywordIndex=32]="keywordIndex",e[e.keywordConstraint=33]="keywordConstraint",e[e.keywordModify=34]="keywordModify",e[e.keywordCascade=35]="keywordCascade",e[e.keywordRestrict=36]="keywordRestrict",e[e.keywordAction=37]="keywordAction",e[e.keywordAutoincrement=38]="keywordAutoincrement",e[e.keywordFrom=39]="keywordFrom",e[e.keywordWhere=40]="keywordWhere",e[e.keywordGroup=41]="keywordGroup",e[e.keywordBy=42]="keywordBy",e[e.keywordHaving=43]="keywordHaving",e[e.keywordOrder=44]="keywordOrder",e[e.keywordAscending=45]="keywordAscending",e[e.keywordDescending=46]="keywordDescending",e[e.keywordNulls=47]="keywordNulls",e[e.keywordFirst=48]="keywordFirst",e[e.keywordLast=49]="keywordLast",e[e.keywordIs=50]="keywordIs",e[e.keywordNull=51]="keywordNull",e[e.keywordDatabase=52]="keywordDatabase",e[e.keywordOr=53]="keywordOr",e[e.keywordAnd=54]="keywordAnd",e[e.keywordNot=55]="keywordNot",e[e.keywordJoin=56]="keywordJoin",e[e.keywordNatural=57]="keywordNatural",e[e.keywordLeft=58]="keywordLeft",e[e.keywordCross=59]="keywordCross",e[e.keywordInner=60]="keywordInner",e[e.keywordOuter=61]="keywordOuter",e[e.keywordOn=62]="keywordOn",e[e.keywordAs=63]="keywordAs",e[e.keywordLimit=64]="keywordLimit",e[e.keywordOffset=65]="keywordOffset",e[e.keywordIn=66]="keywordIn",e[e.keywordNotIn=67]="keywordNotIn",e[e.keywordLike=68]="keywordLike",e[e.keywordCollate=69]="keywordCollate",e[e.keywordDefault=70]="keywordDefault",e[e.keywordComment=71]="keywordComment",e[e.keywordEngine=72]="keywordEngine",e[e.keywordCharset=73]="keywordCharset",e[e.keywordCharacter=74]="keywordCharacter",e[e.keywordStart=75]="keywordStart",e[e.keywordTransaction=76]="keywordTransaction",e[e.keywordIf=77]="keywordIf",e[e.keywordExists=78]="keywordExists",e[e.keywordLock=79]="keywordLock",e[e.keywordUnlock=80]="keywordUnlock",e[e.keywordWrite=81]="keywordWrite",e[e.keywordRead=82]="keywordRead",e[e.leftBracket=83]="leftBracket",e[e.rightBracket=84]="rightBracket",e[e.leftSquareBracket=85]="leftSquareBracket",e[e.rightSquareBracket=86]="rightSquareBracket",e[e.leftCurlyBracket=87]="leftCurlyBracket",e[e.rightCurlyBracket=88]="rightCurlyBracket",e[e.leftRightSquareBracket=89]="leftRightSquareBracket",e[e.dot=90]="dot",e[e.modulo=91]="modulo",e[e.minus=92]="minus",e[e.plus=93]="plus",e[e.multiplication=94]="multiplication",e[e.division=95]="division",e[e.singleQuote=96]="singleQuote",e[e.doubleQuote=97]="doubleQuote",e[e.identifierQuote=98]="identifierQuote",e[e.lower=99]="lower",e[e.greater=100]="greater",e[e.lowerOrEqual=101]="lowerOrEqual",e[e.greaterOrEqual=102]="greaterOrEqual",e[e.concatenation=103]="concatenation",e[e.equal=104]="equal",e[e.notEqual=105]="notEqual",e[e.semicolon=106]="semicolon",e[e.colon=107]="colon",e[e.comma=108]="comma",e[e.backslash=109]="backslash",e[e.pipe=110]="pipe",e[e.at=111]="at",e[e.hash=112]="hash",e[e.space=113]="space",e[e.tab=114]="tab",e[e.newline=115]="newline",e[e.linefeed=116]="linefeed",e[e.identifierChar=117]="identifierChar",e[e.comment=118]="comment",e[e.endofSourcecode=119]="endofSourcecode",e[e.constantNode=120]="constantNode",e[e.callMethod=121]="callMethod",e[e.unaryOp=122]="unaryOp",e[e.binaryOp=123]="binaryOp",e[e.table=124]="table",e[e.subquery=125]="subquery",e[e.list=126]="list",e[e.column=127]="column",e[e.columnDef=128]="columnDef",e[e.allColumns=129]="allColumns",e[e.isNull=130]="isNull",e[e.isNot=131]="isNot",e[e.isNotNull=132]="isNotNull",e[e.omittedeStatement=133]="omittedeStatement"}(r||(r={}));var a,s=(o(i={},r.identifier,"ein Bezeichner"),o(i,r.integerConstant,"eine Integer-Konstante"),o(i,r.floatingPointConstant,"eine Fließkomma-Konstante"),o(i,r.booleanConstant,"eine boolesche Konstante"),o(i,r.stringConstant,"eine Zeichenketten-Konstante"),o(i,r.charConstant,"eine char-Konstante"),o(i,r.true,"true"),o(i,r.false,"false"),o(i,r.keywordRename,"rename"),o(i,r.keywordTo,"to"),o(i,r.keywordAlter,"alter"),o(i,r.keywordCommit,"commit"),o(i,r.keywordAdd,"add"),o(i,r.keywordDelete,"delete"),o(i,r.keywordSelect,"select"),o(i,r.keywordInsert,"insert"),o(i,r.keywordInto,"into"),o(i,r.keywordValues,"values"),o(i,r.keywordUpdate,"update"),o(i,r.keywordSet,"set"),o(i,r.keywordNo,"no"),o(i,r.keywordUse,"use"),o(i,r.keywordCreate,"create"),o(i,r.keywordReferences,"references"),o(i,r.keywordPrimary,"primary"),o(i,r.keywordForeign,"foreign"),o(i,r.keywordTable,"table"),o(i,r.keywordTables,"tables"),o(i,r.keywordColumn,"column"),o(i,r.keywordDrop,"drop"),o(i,r.keywordUnique,"unique"),o(i,r.keywordKey,"key"),o(i,r.keywordIndex,"index"),o(i,r.keywordConstraint,"constraint"),o(i,r.keywordModify,"modify"),o(i,r.keywordCascade,"cascade"),o(i,r.keywordRestrict,"restrict"),o(i,r.keywordAction,"action"),o(i,r.keywordAutoincrement,"autoincrement"),o(i,r.keywordFrom,"from"),o(i,r.keywordWhere,"where"),o(i,r.keywordGroup,"group"),o(i,r.keywordBy,"by"),o(i,r.keywordHaving,"having"),o(i,r.keywordOrder,"order"),o(i,r.keywordAscending,"ascending"),o(i,r.keywordDescending,"descending"),o(i,r.keywordNulls,"nulls"),o(i,r.keywordFirst,"first"),o(i,r.keywordLast,"last"),o(i,r.keywordIs,"is"),o(i,r.keywordNull,"null"),o(i,r.keywordDatabase,"database"),o(i,r.keywordAnd,"and"),o(i,r.keywordOr,"or"),o(i,r.keywordNot,"not"),o(i,r.keywordJoin,"join"),o(i,r.keywordNatural,"natural"),o(i,r.keywordLeft,"left"),o(i,r.keywordCross,"cross"),o(i,r.keywordInner,"inner"),o(i,r.keywordOuter,"outer"),o(i,r.keywordOn,"on"),o(i,r.keywordAs,"as"),o(i,r.keywordLimit,"limit"),o(i,r.keywordOffset,"offset"),o(i,r.keywordIn,"in"),o(i,r.keywordNotIn,"not in"),o(i,r.keywordLike,"like"),o(i,r.keywordCollate,"collate"),o(i,r.keywordDefault,"default"),o(i,r.keywordComment,"comment"),o(i,r.keywordEngine,"engine"),o(i,r.keywordCharset,"charset"),o(i,r.keywordCharacter,"character"),o(i,r.keywordStart,"start"),o(i,r.keywordTransaction,"transaction"),o(i,r.keywordIf,"if"),o(i,r.keywordExists,"exists"),o(i,r.keywordLock,"lock"),o(i,r.keywordUnlock,"unlock"),o(i,r.keywordWrite,"write"),o(i,r.keywordRead,"read"),o(i,r.leftBracket,"("),o(i,r.rightBracket,")"),o(i,r.leftSquareBracket,"["),o(i,r.rightSquareBracket,"]"),o(i,r.leftCurlyBracket,"{"),o(i,r.rightCurlyBracket,"}"),o(i,r.leftRightSquareBracket,"[]"),o(i,r.dot,"."),o(i,r.minus,"-"),o(i,r.modulo,"%"),o(i,r.plus,"+"),o(i,r.multiplication,"*"),o(i,r.division,"/"),o(i,r.singleQuote,"'"),o(i,r.doubleQuote,'"'),o(i,r.identifierQuote,"`"),o(i,r.lower,"<"),o(i,r.greater,">"),o(i,r.equal,"="),o(i,r.lowerOrEqual,"<="),o(i,r.greaterOrEqual,">="),o(i,r.concatenation,"||"),o(i,r.semicolon,";"),o(i,r.colon,":"),o(i,r.comma,","),o(i,r.backslash,"\\"),o(i,r.at,"@"),o(i,r.hash,"#"),o(i,r.pipe,"|"),o(i,r.space,"ein Leerzeichen"),o(i,r.tab,"ein Tabulatorzeichen"),o(i,r.newline,"ein Zeilenumbruch"),o(i,r.identifierChar,"eines der Zeichen a..z, A..Z, _"),o(i,r.comment,"ein Kommentar"),o(i,r.endofSourcecode,"das Ende des Programmes"),i),l={"(":r.leftBracket,")":r.rightBracket,"[":r.leftSquareBracket,"]":r.rightSquareBracket,"{":r.leftCurlyBracket,"}":r.rightCurlyBracket,".":r.dot,",":r.comma,"-":r.minus,"%":r.modulo,"+":r.plus,"*":r.multiplication,"/":r.division,"\\":r.backslash,"@":r.at,"#":r.hash,"|":r.pipe,"'":r.singleQuote,'"':r.doubleQuote,"`":r.identifierQuote,"<":r.lower,">":r.greater,"=":r.equal,"<>":r.notEqual,";":r.semicolon,":":r.colon," ":r.space,"\t":r.tab,"\n":r.newline,"\r":r.linefeed},u={rename:r.keywordRename,to:r.keywordTo,alter:r.keywordAlter,commit:r.keywordCommit,add:r.keywordAdd,delete:r.keywordDelete,select:r.keywordSelect,insert:r.keywordInsert,into:r.keywordInto,values:r.keywordValues,update:r.keywordUpdate,set:r.keywordSet,no:r.keywordNo,use:r.keywordUse,create:r.keywordCreate,references:r.keywordReferences,primary:r.keywordPrimary,foreign:r.keywordForeign,table:r.keywordTable,tables:r.keywordTables,column:r.keywordColumn,drop:r.keywordDrop,unique:r.keywordUnique,key:r.keywordKey,index:r.keywordIndex,constraint:r.keywordConstraint,modify:r.keywordModify,cascade:r.keywordCascade,restrict:r.keywordRestrict,action:r.keywordAction,autoincrement:r.keywordAutoincrement,auto_increment:r.keywordAutoincrement,from:r.keywordFrom,where:r.keywordWhere,true:r.true,false:r.false,group:r.keywordGroup,by:r.keywordBy,having:r.keywordHaving,order:r.keywordOrder,asc:r.keywordAscending,desc:r.keywordDescending,nulls:r.keywordNulls,first:r.keywordFirst,last:r.keywordLast,is:r.keywordIs,null:r.keywordNull,database:r.keywordDatabase,or:r.keywordOr,and:r.keywordAnd,not:r.keywordNot,join:r.keywordJoin,natural:r.keywordNatural,left:r.keywordLeft,cross:r.keywordCross,inner:r.keywordInner,outer:r.keywordOuter,on:r.keywordOn,as:r.keywordAs,limit:r.keywordLimit,offset:r.keywordOffset,in:r.keywordIn,"not in":r.keywordNotIn,like:r.keywordLike,collate:r.keywordCollate,default:r.keywordDefault,comment:r.keywordComment,engine:r.keywordEngine,charset:r.keywordCharset,character:r.keywordCharacter,start:r.keywordStart,transaction:r.keywordTransaction,if:r.keywordIf,exists:r.keywordExists,lock:r.keywordLock,unlock:r.keywordUnlock,write:r.keywordWrite,read:r.keywordRead},c={n:"\n",r:"\r",t:"\t",'"':'"',"'":"'","\\":"\\"};function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e){e[e.number=0]="number",e[e.identifier=1]="identifier",e[e.stringConstant=2]="stringConstant",e[e.characterConstant=3]="characterConstant",e[e.multilineComment=4]="multilineComment",e[e.EndoflineComment=5]="EndoflineComment"}(a||(a={}));var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.spaceTokens=[r.space,r.tab,r.newline],this.correspondingBracket={},this.tokenTypesToMerge=[{first:r.keywordNotIn,second:r.keywordIn,merged:r.keywordNotIn},{first:r.keywordIs,second:r.keywordNot,merged:r.isNot},{first:r.isNot,second:r.keywordNull,merged:r.isNotNull},{first:r.keywordIs,second:r.keywordNull,merged:r.isNull}],this.correspondingBracket[r.leftBracket]=r.rightBracket,this.correspondingBracket[r.leftCurlyBracket]=r.rightCurlyBracket,this.correspondingBracket[r.leftSquareBracket]=r.rightSquareBracket,this.correspondingBracket[r.rightBracket]=r.leftBracket,this.correspondingBracket[r.rightCurlyBracket]=r.leftCurlyBracket,this.correspondingBracket[r.rightSquareBracket]=r.leftSquareBracket}var t,n,i;return t=e,(n=[{key:"lex",value:function(e){if(this.input=e.replace(" "," "),this.tokenList=[],this.errorList=[],this.bracketError=null,this.bracketStack=[],this.pos=0,this.line=1,this.column=1,this.nonSpaceLastTokenType=null,this.nonSpaceLastToken=null,0==e.length)return{tokens:this.tokenList,errors:this.errorList,bracketError:null};for(this.currentChar=e.charAt(0),this.nextChar=e.length>1?e.charAt(1):"►";"►"!=this.currentChar;)this.mainState();if(this.bracketStack.length>0){var t=this.bracketStack.pop(),n=this.correspondingBracket[t];this.setBracketError(s[t]+" "+s[n])}return{tokens:this.tokenList,errors:this.errorList,bracketError:this.bracketError}}},{key:"checkClosingBracket",value:function(e){if(0!=this.bracketStack.length){var t=this.bracketStack.pop(),n=this.correspondingBracket[t];e!=n&&this.setBracketError(s[t]+" "+s[n])}else{var i=this.correspondingBracket[e];this.setBracketError(s[i]+" "+s[e])}}},{key:"setBracketError",value:function(e){null==this.bracketError&&(this.bracketError=e)}},{key:"next",value:function(){this.pos++,this.currentChar=this.nextChar,this.pos+1<this.input.length?this.nextChar=this.input.charAt(this.pos+1):this.nextChar="►",this.column++}},{key:"mainState",value:function(){var e=this.currentChar,t=l[e];if(null!=t){switch(t){case r.leftSquareBracket:return"]"==this.nextChar?(this.pushToken(r.leftRightSquareBracket,"[]"),this.next(),void this.next()):(this.pushToken(r.leftSquareBracket,"["),this.bracketStack.push(t),void this.next());case r.division:return"*"==this.nextChar?void this.lexMultilineComment():(this.pushToken(r.division,"/"),void this.next());case r.pipe:return"|"==this.nextChar?(this.pushToken(r.concatenation,"||"),this.next(),void this.next()):(this.pushToken(r.pipe,"|"),void this.next());case r.lower:return">"==this.nextChar?(this.pushToken(r.notEqual,"<>"),this.next(),void this.next()):(this.pushToken(r.lower,"<"),void this.next());case r.rightSquareBracket:this.checkClosingBracket(t);break;case r.leftBracket:this.bracketStack.push(t);break;case r.rightBracket:this.checkClosingBracket(t);break;case r.leftCurlyBracket:this.bracketStack.push(t);break;case r.rightCurlyBracket:this.checkClosingBracket(t);break;case r.minus:return!this.isDigit(this.nextChar,10)||[r.identifier,r.integerConstant,r.floatingPointConstant,r.rightBracket].indexOf(this.nonSpaceLastTokenType)>=0?"-"==this.nextChar?void this.lexEndofLineComment("--"):(this.pushToken(r.minus,"-"),void this.next()):void this.lexNumber();case r.hash:if(null==this.nonSpaceLastToken||this.nonSpaceLastToken.position.line<this.line)return void this.lexEndofLineComment("#");this.pushToken(r.hash,"#"),this.next();break;case r.singleQuote:return void this.lexStringConstant("'");case r.doubleQuote:return void this.lexStringConstant('"');case r.newline:return this.pushToken(r.newline,"\n"),this.line++,this.column=0,void this.next();case r.space:case r.tab:return void this.lexSpace();case r.linefeed:return void this.next();case r.at:return void this.lexAnnotation();case r.identifierQuote:return void this.lexQuotedIdentifier()}return this.pushToken(t,e),void this.next()}this.isDigit(e,10)?this.lexNumber():this.lexIdentifierOrKeyword()}},{key:"lexQuotedIdentifier",value:function(){var e=this.line,t=this.column,n="";for(this.next();"`"!=this.currentChar&&"►"!=this.currentChar;)n+=this.currentChar,this.next();"►"==this.currentChar?this.pushError("Innerhalb eines in `` eingeschlossenen Bezeichners wurde das Ende der Datei erreicht.",n.length+1,"error",e,t):(this.next(),this.pushToken(r.identifier,n,e,t))}},{key:"pushToken",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.line,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.column,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(""+t).length,a={tt:e,value:t,position:{column:r,line:i,length:o}},s=d(this.tokenTypesToMerge);try{for(s.s();!(n=s.n()).done;){var l=n.value;if(e==l.second&&this.nonSpaceLastTokenType==l.first){var u=r-this.nonSpaceLastToken.position.column+o;return this.nonSpaceLastToken.tt=l.merged,this.nonSpaceLastToken.position={column:this.nonSpaceLastToken.position.column,line:i,length:u},this.nonSpaceLastToken.value=this.nonSpaceLastToken.value+" "+t,void(this.nonSpaceLastTokenType=l.merged)}}}catch(e){s.e(e)}finally{s.f()}this.spaceTokens.indexOf(e)>=0||(this.nonSpaceLastTokenType=e,this.nonSpaceLastToken=a),this.tokenList.push(a)}},{key:"pushError",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"error",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.line,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.column;this.errorList.push({text:e,position:{line:i,column:r,length:t},level:n})}},{key:"isDigit",value:function(e,t){var n=e.charCodeAt(0);return 10==t?n>=48&&n<=57:2==t?n>=48&&n<=49:8==t?n>=48&&n<=55:16==t?n>=48&&n<=57||n>=97&&n<=102||n>=65&&n<=70:void 0}},{key:"lexSpace",value:function(){for(var e=this.column,t=this.line,n=this.pos;" "==this.currentChar||"\t"==this.currentChar;)this.next();var i=this.pos;this.pushToken(r.space,this.input.substring(n,i),t,e)}},{key:"lexCharacterConstant",value:function(){var e=this.column,t=this.line;this.next();var n=this.currentChar;if("\\"==n){var i=c[this.nextChar];null==i?(this.pushError("Die Escape-Sequenz \\"+this.nextChar+" gibt es nicht.",2),"'"!=this.nextChar&&(n=this.nextChar,this.next())):(n=i,this.next())}this.next(),"'"!=this.currentChar?this.pushError("Das Ende der char-Konstante wird erwartet (').",1):this.next(),this.pushToken(r.charConstant,n,t,e)}},{key:"lexStringConstant",value:function(e){var t=this.line,n=this.column,i="";for(this.next();;){var o=this.currentChar;if("\\"==o){var a=c[this.nextChar];null==a?this.pushError("Die Escape-Sequenz \\"+this.nextChar+" gibt es nicht.",2):(o=a,this.next())}else{if(o==e){this.next();break}if("\n"==o||"►"==o){this.pushError("Innerhalb einer String-Konstante wurde das Zeilenende erreicht.",i.length+1,"error",t,n);break}}i+=o,this.next()}"'"==e?this.pushToken(r.stringConstant,i,t,n,i.length+2):(this.pushToken(r.identifier,i,t,n,i.length+2),this.tokenList[this.tokenList.length-1].isDoubleQuotedIdentifier=!0)}},{key:"lexMultilineComment",value:function(){var e=this.line,t=this.column,n=!1,i="/*";for(this.next(),this.next();;){var o=this.currentChar;if("*"==o&&"/"==this.nextChar){this.next(),this.next(),i+="*/";break}if("►"==o){this.pushError("Innerhalb eines Mehrzeilenkommentars (/*... */) wurde das Dateiende erreicht.",1);break}"\n"==o?(this.line++,this.column=0,n=!0,i+=o):n&&" "==o||(i+=o,n=!1),this.next()}this.pushToken(r.comment,i,e,t)}},{key:"lexEndofLineComment",value:function(e){for(var t=this.line,n=this.column,i=e,o=0;o<e.length;o++)this.next();for(;;){var a=this.currentChar;if("\n"==a)break;if("►"==a)break;i+=a,this.next()}this.pushToken(r.comment,i,t,n)}},{key:"lexNumber",value:function(){var e=this.line,t=this.column,n=1;"-"==this.currentChar&&(n=-1,this.next());var i=this.pos,o=this.currentChar;this.next();var a=10;for("0"==o&&["b","x","0","1","2","3","4","5","6","7"].indexOf(this.currentChar)>=0&&("x"==this.currentChar?(a=16,this.next()):"b"==this.currentChar?(a=2,this.next()):a=8,i=this.pos);this.isDigit(this.currentChar,a);)this.next();var s=r.integerConstant;if("."==this.currentChar){for(s=r.floatingPointConstant,this.next();this.isDigit(this.currentChar,10);)this.next();10!=a&&this.pushError("Eine float/double-Konstante darf nicht mit 0, 0b oder 0x beginnen.",this.pos-i,"error",this.line,this.column-(this.pos-i))}var l=this.input.substring(i,this.pos);i=this.pos;var u=0;if("e"==this.currentChar){this.next();var c=this.pos;for("-"==this.currentChar&&this.next();this.isDigit(this.currentChar,10);)this.next();10!=a&&this.pushError("Eine float/double-Konstante darf nicht mit 0, 0b oder 0x beginnen.",this.pos-i,"error",this.line,this.column-(this.pos-i));var d=this.input.substring(c,this.pos);u=Number.parseInt(d)}"d"!=this.currentChar&&"f"!=this.currentChar||(r.floatingPointConstant,this.next(),10!=a&&this.pushError("Eine float/double-Konstante darf nicht mit 0, 0b oder 0x beginnen.",this.pos-i,"error",this.line,this.column-(this.pos-i)));var h=s==r.integerConstant?Number.parseInt(l,a):Number.parseFloat(l);h*=n,0!=u&&(h*=Math.pow(10,u)),this.pushToken(s,h,e,t)}},{key:"lexAnnotation",value:function(){var e=this.line,t=this.column-1,n=this.pos,i=this.currentChar;for(this.next();null==l[i]&&!this.isSpace(i)&&"►"!=i;)this.next(),i=this.currentChar;var o=this.pos,a=this.input.substring(n,o);this.pushToken(r.at,a,e,t,a.length+1)}},{key:"lexIdentifierOrKeyword",value:function(){for(var e=this.line,t=this.column,n=this.pos,i=this.currentChar;null==l[i]&&!this.isSpace(i)&&"►"!=i;)this.next(),i=this.currentChar;var o=this.pos,a=this.input.substring(n,o),s=u[a.toLowerCase()];if(null==s||"number"!=typeof s)this.pushToken(r.identifier,a,e,t);else switch(s){case r.true:this.pushToken(r.booleanConstant,!0,e,t);break;case r.false:this.pushToken(r.booleanConstant,!1,e,t);break;default:this.pushToken(s,a,e,t)}}},{key:"isSpace",value:function(e){return" "==e||"\n"==e}}])&&f(t.prototype,n),i&&f(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.autoFormatTriggerCharacters=["\n"],this.displayName="Java-Autoformat"}var t,n,i;return t=e,(n=[{key:"init",value:function(){monaco.languages.registerDocumentFormattingEditProvider("myJava",this),monaco.languages.registerOnTypeFormattingEditProvider("myJava",this)}},{key:"provideOnTypeFormattingEdits",value:function(e,t,n,i,r){var o=this.format(e);return Promise.resolve(o)}},{key:"deleteOverlappingRanges",value:function(e){for(var t=0;t<e.length-1;t++){var n=e[t],i=e[t+1];if(!(n.range.endLineNumber<i.range.startLineNumber)&&n.range.endLineNumber==i.range.startLineNumber)if(n.range.endColumn>=i.range.startColumn)e.splice(t+1,1);else if(0==n.range.endColumn&&n.text.length>0&&1==i.range.startColumn&&i.range.endColumn>i.range.startColumn&&""==i.text){var r=n.text.length-(i.range.endColumn-i.range.startColumn);r>0?(n.text=n.text.substr(0,r),e.splice(t+1,1)):r<0?(i.range.endColumn=i.range.startColumn-r,e.splice(t,1),t--):(e.splice(t,2),t--)}}}},{key:"provideDocumentFormattingEdits",value:function(e,t,n){var i=this.format(e);return Promise.resolve(i)}},{key:"format",value:function(e){var t=[],n=e.getValue(monaco.editor.EndOfLinePreference.LF),i=(new m).lex(n).tokens;if(null==i)return[];for(var o=null,a=0,s=[],l=[],u=!1,c=0,d=0,h=0;h<i.length;h++){var f=i[h];switch(c--,f.tt){case r.leftCurlyBracket:if(u&&(u=!1,l.push(a+2),a++),a++,s.push(f.position.line),null!=o){var p=o.tt;p!=r.rightBracket&&p!=r.identifier&&p!=r.leftRightSquareBracket||this.replaceBetween(o,f,t," ")}if(h<i.length-1){var v=i[h+1];v.tt!=r.newline&&v.tt!=r.space&&this.insertSpaces(t,v.position.line,v.position.column,1)}break;case r.rightCurlyBracket:l[l.length-1]==a&&(l.pop(),a--,this.deleteSpaces(t,f.position.line,1,3)),a--;var y=s.pop();if(null!=y&&y!=f.position.line)null!=o&&o.position.line==f.position.line&&this.replace(t,f.position,f.position,"\n"+" ".repeat(3*a));else if(h>0){var g=i[h-1];g.tt!=r.space&&g.tt!=r.newline&&this.insertSpaces(t,f.position.line,f.position.column,1)}break;case r.leftBracket:if(d++,h<i.length-2){var b=i[h+1],k=i[h+2];b.tt==r.space&&k.tt!=r.newline&&(this.deleteSpaces(t,b.position.line,b.position.column,b.position.length),h++,k.tt==r.rightBracket&&(h++,d--))}if(h>1){var w=i[h-1],C=i[h-2];w.tt!=r.space||C.tt==r.newline||this.isBinaryOperator(C.tt)||1==w.position.length&&this.deleteSpaces(t,w.position.line,w.position.column,1)}break;case r.rightBracket:if(d--,h>1){var T=i[h-1],x=i[h-2];T.tt==r.space&&x.tt!=r.newline&&this.deleteSpaces(t,T.position.line,T.position.column,T.position.length)}break;case r.newline:if(c=2,h<i.length-2){var j=this.isBinaryOperator(null==o?void 0:o.tt),S=this.isBinaryOperator(this.getNextNonSpaceToken(h,i).tt),E=i[h+1],_=i[h+2],D=0;if(E.tt==r.newline)break;var P=0;if(E.tt==r.space){if(_.tt==r.newline)break;D=E.position.length,h++,_.tt==r.rightCurlyBracket&&(P=-1)}E.tt==r.rightCurlyBracket&&(P=-1),(S||j)&&(P=1);var L=a+P;d>0&&L++,L<0&&(L=0);var O=3*L;O>D?this.insertSpaces(t,f.position.line+1,0,O-D):O<D&&this.deleteSpaces(t,f.position.line+1,0,D-O)}break;case r.space:h<i.length-1&&i[h+1].tt!=r.comment&&h>0&&i[h-1].tt!=r.newline&&f.position.length>1&&this.deleteSpaces(t,f.position.line,f.position.column,f.position.length-1);break;case r.comma:case r.semicolon:if(h>1){var I=i[h-1],A=i[h-2];I.tt==r.newline||A.tt==r.newline||this.isBinaryOperator(A.tt)||I.tt==r.space&&1==I.position.length&&this.deleteSpaces(t,I.position.line,I.position.column,1)}if(h<i.length-1){var M=i[h+1];M.tt!=r.comment&&M.tt!=r.space&&M.tt!=r.newline&&this.insertSpaces(t,M.position.line,M.position.column,1)}break;case r.rightSquareBracket:null!=o&&o.tt==r.leftSquareBracket&&this.replaceBetween(o,f,t,"")}if(this.isBinaryOperator(f.tt)){var B=f.tt==r.lower&&this.lowerBelongsToGenericExpression(h,i),N=f.tt==r.greater&&this.greaterBelongsToGenericExpression(h,i);if(c<=0&&null!=o&&[r.leftBracket,r.comma].indexOf(o.tt)<0){if(h>0){var F=i[h-1],$=B||N?0:1;F.tt==r.space?F.position.length!=$&&this.insertSpaces(t,F.position.line,F.position.column,$-F.position.length):1==$&&this.insertSpaces(t,f.position.line,f.position.column,1)}if(h<i.length-1){var R=i[h+1],Q=B?0:1;R.tt==r.space?(N&&h<i.length-2&&i[h+2].tt==r.leftBracket&&(Q=0),R.position.length!=Q&&this.insertSpaces(t,R.position.line,R.position.column,Q-R.position.length)):(N&&R.tt==r.leftBracket&&(Q=0),1==Q&&this.insertSpaces(t,R.position.line,R.position.column,1))}}}f.tt!=r.space&&f.tt!=r.newline&&(o=f)}return this.deleteOverlappingRanges(t),t}},{key:"getNextNonSpaceToken",value:function(e,t){if(e==t.length-1)return t[e];for(var n=e+1;n<t.length-1&&t[n].tt==r.space;)n++;return t[n]}},{key:"lowerBelongsToGenericExpression",value:function(e,t){for(var n=e+1;n<t.length;){var i=t[n].tt;if(i==r.greater)return!0;if([r.space,r.comma,r.identifier].indexOf(i)<0)return!1;n++}return!1}},{key:"greaterBelongsToGenericExpression",value:function(e,t){for(var n=e-1;n>=0;){var i=t[n].tt;if(i==r.lower)return!0;if([r.space,r.comma,r.identifier].indexOf(i)<0)return!1;n--}return!1}},{key:"isBinaryOperator",value:function(e){return null!=e&&e>=r.modulo&&e<=r.equal}},{key:"replaceBetween",value:function(e,t,n,i){var r={line:e.position.line,column:e.position.column+e.position.length},o={line:t.position.line,column:t.position.column};r.line==o.line&&o.column-r.column==i.length||this.replace(n,r,o,i)}},{key:"deleteSpaces",value:function(e,t,n,i){e.push({range:{startColumn:n,startLineNumber:t,endColumn:n+i+(0==n?1:0),endLineNumber:t},text:""})}},{key:"insertSpaces",value:function(e,t,n,i){i<0?this.deleteSpaces(e,t,n,-i):e.push({range:{startColumn:n,startLineNumber:t,endColumn:n,endLineNumber:t},text:" ".repeat(i)})}},{key:"replace",value:function(e,t,n,i){e.push({range:{startColumn:t.column,startLineNumber:t.line,endColumn:n.column,endLineNumber:n.line},text:i})}}])&&p(t.prototype,n),i&&p(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var k=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.themes=[],this.initThemes()}var t,n,i;return t=e,(n=[{key:"switchTheme",value:function(e){var t,n=y(this.themes);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.name==e){this.internalSwitchTheme(i);break}}}catch(e){n.e(e)}finally{n.f()}}},{key:"internalSwitchTheme",value:function(e){monaco.editor.setTheme(e.monacoTheme);for(var t=document.documentElement,n=0,i=Object.keys(e.cssColors);n<i.length;n++){var r=i[n],o=e.cssColors[r];t.style.setProperty(r,o)}}},{key:"initThemes",value:function(){this.themes.push({name:"dark",monacoTheme:"myCustomThemeDark",cssColors:{"--backgroundDark":"#1e1e1e","--backgroundLight":"#252526","--backgroundHeading":"#37373d","--backgroundSelected":"#2a2d2e","--fontColorNormal":"#c2cccc","--fontColorLight":"#e7e7e7","--slider":"#414141","--loginButtonBackgrond":"#59a15d","--loginButtonFontColor":"#000000","--loginMessageColor":"rgb(122, 48, 48)","--loginButtonHover":"#63a867","--loginButtonActive":"#94ffd1","--scrollbar":"#1e1e1e","--scrollbar-thumb":"#3e3e3e","--scrollbar-thumb-hover":"#5e5e5e","--scrollbar-thumb-active":"#7e7e7e","--submenu-hover":"#094771","--submenu-color":"#ffffff","--menuitemsdivider":"#616162","--file-hover":"hsla(0, 0%, 38%, 0.125)","--file-active":"#094771","--file-active-hover":"rgba(9, 71, 113, 0.827)","--file-errorcount":"red","--inplace-editor":"blue","--contextmenu-background":"#3c3c3c","--contextmenu-color":"rgb(212,212,212)","--contextmenu-hover-background":"#094771","--contextmenu-hover-color":"#ffffff","--error-filename":"#2a709e","--error-line-ative":"#094771","--error-line-hover":"rgba(96, 96, 96, 0.125)","--error-position":"#c0802d","--linecolumn":"#14c714","--reveal-error":"rgba(253, 101, 101, 0.745)","--reveal-method":"#2b2b7d2f","--reveal-errorline-background":"red","--reveal-error-whole-line":"rgba(255, 0, 0, 0.555)","--reveal-programpointer":"rgba(111, 214, 27, 0.337)","--reveal-syntaxelement":"rgb(85,85,85)","--margin-breakpoint":"rgba(255, 0, 0, 0.623)","--speedcontrol-bar":"#9d9d9d","--speedcontrol-grip":"#588555","--speedcontrol-grip-hover":"#89d185","--speedcontrol-display-background":"#383838","--speedcontrol-display-border":"#9d9d9d","--editorTooltip-background":"#252526","--editorTooltip-border":"#454545","--renameInput-color":"#ffffff","--bottomdiv-tabheading-hover":"white","--bottomdiv-tabheading-active":"rgb(97,97,255)","--noErrorMessage":"rgb(37, 211, 37)","--console-top-borderbottom":"#c4c4c4","--console-top-background":"#1e1e1e","--consoleEntry-withBorder":"#303030","--consoleEntryValue":"white","--consoleEntryIdentifier":"rgb(156, 156, 235)","--consoleEntryNoValue":"gray","--consoleEntryCaption":"white","--error-Caption":"rgb(166, 165, 176)","--console-error":"rgb(155, 51, 51)","--deIdentifier":"rgb(156, 156, 235)","--deValue":"white","--helper-background-color":"#383838","--helper-border-color":"#d4d4d4","--arrowBoxButtonOuter-background":"#59a15d","--arrowBoxButtonOuter-border":"#3d3d3d","--arrowBoxButtonOuter-color":"black","--arrowBoxButtonOuter-button-hover":"#63a867","--arrowBox-after":"rgba(136, 183, 213, 0)","--arrowBox-before":"rgba(194, 225, 245, 0)","--defaultOutputColor":"#ffffff","--runInputColor":"#ffffff","--runBackgroundColor":"rgba(255, 255, 255, 0.2)"}}),this.themes.push({name:"light",monacoTheme:"myCustomThemeLight",cssColors:{"--backgroundDark":"white","--backgroundLight":"#f3f3f3","--backgroundHeading":"#dcdcdc","--backgroundSelected":"#e8e8e8","--fontColorNormal":"#756161","--fontColorLight":"#756161","--slider":"#b0b0b0","--loginButtonBackgrond":"#59a15d","--loginButtonFontColor":"#000000","--loginMessageColor":"rgb(122, 48, 48)","--loginButtonHover":"#63a867","--loginButtonActive":"#94ffd1","--scrollbar":"#e3e3e3","--scrollbar-thumb":"#bababa","--scrollbar-thumb-hover":"#8e8e8e","--scrollbar-thumb-active":"#616161","--submenu-hover":"#8080ff","--submenu-color":"#ffffff","--menuitemsdivider":"#cfcfcf","--file-hover":"#e8e8e8","--file-active":"#8080ff","--file-active-hover":"#a0a0ff","--file-errorcount":"red","--inplace-editor":"white","--contextmenu-background":"white","--contextmenu-color":"#756161","--contextmenu-hover-background":"#8080ff","--contextmenu-hover-color":"#a0a0ff","--error-filename":"#ff0000","--error-line-ative":"#ffa0a0","--error-line-hover":"#ffc0c0","--error-position":"#804040","--linecolumn":"#14c714","--reveal-error":"rgba(253, 101, 101, 0.745)","--reveal-method":"#babaec80","--reveal-errorline-background":"red","--reveal-error-whole-line":"rgba(255, 0, 0, 0.555)","--reveal-programpointer":"rgba(111, 214, 27, 0.337)","--reveal-syntaxelement":"#c0c0c0","--margin-breakpoint":"rgba(255, 0, 0, 0.623)","--speedcontrol-bar":"#9d9d9d","--speedcontrol-grip":"#588555","--speedcontrol-grip-hover":"#89d185","--speedcontrol-display-background":"#e0e0e0","--speedcontrol-display-border":"#9d9d9d","--editorTooltip-background":"#e0e0e0","--editorTooltip-border":"#9d9d9d","--renameInput-color":"#000000","--bottomdiv-tabheading-hover":"#424242","--bottomdiv-tabheading-active":"#424242","--noErrorMessage":"rgb(17, 180, 17)","--console-top-borderbottom":"#c4c4c4","--console-top-background":"white","--consoleEntry-withBorder":"#303030","--consoleEntryValue":"#0000a0","--consoleEntryIdentifier":"black","--consoleEntryNoValue":"gray","--consoleEntryCaption":"#756161","--error-Caption":"rgb(166, 165, 176)","--console-error":"rgb(155, 21, 21)","--deIdentifier":"black","--deValue":"#0000a0","--helper-background-color":"#f3f3f3","--helper-border-color":"#606060","--arrowBoxButtonOuter-background":"#59a15d","--arrowBoxButtonOuter-border":"#3d3d3d","--arrowBoxButtonOuter-color":"black","--arrowBoxButtonOuter-button-hover":"#63a867","--arrowBox-after":"rgba(136, 183, 213, 0)","--arrowBox-before":"rgba(194, 225, 245, 0)","--defaultOutputColor":"#303030","--runInputColor":"#000000","--runBackgroundColor":"rgba(0, 0, 0, 0.2)"}})}}])&&b(t.prototype,n),i&&b(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=S(e);if(t){var r=S(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return j(this,n)}}function j(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _(e,t,n){return t&&E(e.prototype,t),n&&E(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var P=_((function e(){D(this,e)})),L=function(e){C(n,e);var t=x(n);function n(e,i,r,o,a){var s;D(this,n),(s=t.call(this)).name=e,s.parameterDescriptions=i,s.checkFunction=r,s.outputFunction=o,s.binaryResultTypes=new Map,s.unaryOperators=[],s.canCastToList=a.slice(0);var l=s.canCastToList.indexOf(e);return l>=0&&s.canCastToList.splice(l,1),s}return _(n,[{key:"getBaseTypeName",value:function(){return this.name}},{key:"toString",value:function(){return this.name}},{key:"addBinaryOperation",value:function(e,t,n){var i=this,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Array.isArray(e)||(e=[e]),e.forEach((function(e){var o=i.binaryResultTypes.get(e);null==o&&(o=new Map,i.binaryResultTypes.set(e,o)),o.set(t,n),r&&t!=i&&t.addBinaryOperation(e,i,n,!1)}))}},{key:"canCastTo",value:function(e){var t=e instanceof n?e:e.baseType;return this.canCastToList.indexOf(t.name)>=0||this.name==t.name}},{key:"getBinaryResultType",value:function(e,t){var i=this.binaryResultTypes.get(e);if(null==i)return null;var r=t instanceof n?t:t.baseType;return i.get(r)}},{key:"getUnaryResultType",value:function(e){return[r.isNull,r.isNotNull].indexOf(e)>=0?re:this.unaryOperators.indexOf(e)>=0?this:void 0}},{key:"getBinaryResult",value:function(e,t,n){switch(e){case r.concatenation:case r.plus:return null!=t&&null!=n?t+n:null!=t?t:n;case r.minus:return null!=t&&null!=n?t-n:null!=t?t:n;case r.multiplication:case r.division:case r.keywordAnd:return null!=t&&null!=n?t*n:null!=t?t:n;case r.keywordOr:return null!=t&&null!=n?Math.max(t,n):null!=t?t:n;case r.lower:return null!=t&&null!=n?t<n:null==t;case r.greater:return null!=t&&null!=n?t>=n:null==t;case r.lowerOrEqual:return null!=t&&null!=n?t<=n:null==t;case r.greaterOrEqual:return null!=t&&null!=n?t>=n:null==t;case r.equal:return t==n;case r.notEqual:return t!=n}}}],[{key:"fromConstantType",value:function(e){switch(e){case r.stringConstant:return this.baseTypeMap.get("text");case r.integerConstant:return this.baseTypeMap.get("integer");case r.floatingPointConstant:return this.baseTypeMap.get("float");case r.charConstant:return this.baseTypeMap.get("text");case r.booleanConstant:return this.baseTypeMap.get("boolean");case r.keywordNull:return this.baseTypeMap.get("null")}}},{key:"getBaseType",value:function(e){return"char"==e&&(e="varchar"),this.baseTypeMap.get(e.toLocaleLowerCase())}},{key:"addBaseTypes",value:function(e){n.baseTypes=n.baseTypes.concat(e),e.forEach((function(e){return n.baseTypeMap.set(e.name,e)}))}}]),n}(P);L.baseTypes=[],L.baseTypeMap=new Map;var O=[1,10,100,1e3,1e5,1e5,1e6,1e7,1e8,1e9],I=function(e){C(n,e);var t=x(n);function n(e,i){var r;D(this,n),(r=t.call(this)).baseType=e,r.parameterValues=i;var o=i.join(", ");return r.name=e.name+"("+o+")",r}return _(n,[{key:"toString",value:function(){return this.name}},{key:"getBaseTypeName",value:function(){return this.baseType.name}},{key:"canCastTo",value:function(e){var t=e instanceof L?e:e.baseType;return this.baseType.canCastToList.indexOf(t.name)>=0||this.baseType.name==t.name}},{key:"getBinaryResultType",value:function(e,t){var i=this.baseType.binaryResultTypes.get(e);if(null==i)return null;var o=t instanceof L?t:t.baseType,a=i.get(o);if(this.baseType==o&&this.baseType==a&&t instanceof n){if("varchar"==this.baseType.name||e==r.concatenation)return new n(this.baseType,[this.parameterValues[0]+t.parameterValues[0]]);if("decimal"==this.baseType.name)return new n(this.baseType,[Math.max(this.parameterValues[0],t.parameterValues[0]),Math.max(this.parameterValues[1],t.parameterValues[1])])}return i.get(o)}},{key:"getUnaryResultType",value:function(e){return this.baseType.getUnaryResultType(e)}},{key:"getBinaryResult",value:function(e,t,n){var i=this.baseType.getBinaryResult(e,t,n);return(this.name="varchar")?null==i?null:(""+i).substr(0,this.parameterValues[0]):"decimal"==this.name?null==i?null:Math.round(i*O[this.parameterValues[1]])/O[this.parameterValues[1]]:i}}]),n}(P),A=["varchar","char","text","tinytext","mediumtext","longtext"],M=new L("varchar",["Maximale Länge"],(function(e,t){return"check(length(".concat(e,") <= ").concat(t[0],")")}),(function(e,t){return e.substring(0,t[0])}),A),B=new L("char",["Maximale Länge"],(function(e,t){return"check(length(".concat(e,") <= ").concat(t[0],")")}),(function(e,t){return e.substring(0,t[0])}),A),N=new L("text",["Maximale Länge"],(function(e,t){return""}),(function(e,t){return e}),A.concat(["date","datetime","timestamp"])),F=new L("tinyText",[],(function(e,t){return""}),(function(e,t){return e}),A),R=new L("mediumText",[],(function(e,t){return""}),(function(e,t){return e}),A),Q=new L("longText",[],(function(e,t){return""}),(function(e,t){return e}),A),W=["decimal","numeric","double","real","float"],z=new L("decimal",["Gesamtzahl der Stellen","Nachkommastellen"],(function(e,t){return""}),(function(e,t){var n=Math.trunc(e),i=e-n;return n+(t[1]>0?"."+Math.round(i*O[t[1]]):"")}),W),q=new L("numeric",["Gesamtzahl der Stellen","Nachkommastellen"],(function(e,t){return""}),(function(e,t){return""+e}),W),U=new L("double",["Gesamtzahl der Stellen","Nachkommastellen"],(function(e,t){return""}),(function(e,t){return""+e}),W),H=new L("real",[],(function(e,t){return""}),(function(e,t){return""+e}),W),K=new L("float",[],(function(e,t){return""}),(function(e,t){return""+e}),W),V=["int","integer","tinyint","smallint","mediumint","bigint"].concat(W),G=new L("int",["Maximale Anzahl der Stellen"],(function(e,t){return"check(round(".concat(e,") = ").concat(e,")")}),(function(e,t){return""+Math.round(e)}),V),J=new L("integer",["Maximale Anzahl der Stellen"],(function(e,t){return"check(round(".concat(e,") = ").concat(e,")")}),(function(e,t){return""+Math.round(e)}),V),Y=new L("tinyint",["Maximale Anzahl der Stellen"],(function(e,t){return"check(round(".concat(e,") = ").concat(e,")")}),(function(e,t){return""+Math.round(e)}),V),X=new L("smallint",["Maximale Anzahl der Stellen"],(function(e,t){return"check(round(".concat(e,") = ").concat(e,")")}),(function(e,t){return""+Math.round(e)}),V),Z=new L("mediumint",["Maximale Anzahl der Stellen"],(function(e,t){return"check(round(".concat(e,") = ").concat(e,")")}),(function(e,t){return""+Math.round(e)}),V),ee=new L("bigint",["Maximale Anzahl der Stellen"],(function(e,t){return"check(round(".concat(e,") = ").concat(e,")")}),(function(e,t){return""+Math.round(e)}),V),te=new L("date",[],(function(e,t){return"check(isDate(".concat(e,"))")}),(function(e,t){return e}),[]),ne=new L("datetime",[],(function(e,t){return"check(isDateTime(".concat(e,"))")}),(function(e,t){return e}),["timestamp"]),ie=new L("timestamp",[],(function(e,t){return"check(isDateTime(".concat(e,"))")}),(function(e,t){return e}),["datetime"]),re=new L("boolean",[],(function(e,t){return"check(".concat(e," == 0 or ").concat(e," == 1)")}),(function(e,t){return 1==e?"true":"false"}),["varchar","text","decimal","numeric"]),oe=new L("null",[],(function(e,t){return""}),(function(e,t){return e}),[]),ae=[z,q,U,H,K,G,J,Y,X,Z,ee],se=[M,B,N,F,R,Q,te,ne,ie,re,oe].concat(ae);L.addBaseTypes(se),M.addBinaryOperation(r.concatenation,M,M),M.addBinaryOperation(r.concatenation,B,M),M.addBinaryOperation(r.concatenation,N,N),N.addBinaryOperation(r.concatenation,N,N),M.addBinaryOperation(r.keywordLike,M,re),M.addBinaryOperation(r.keywordLike,N,re),N.addBinaryOperation(r.keywordLike,N,re),B.addBinaryOperation(r.concatenation,B,B),B.addBinaryOperation(r.concatenation,M,B),B.addBinaryOperation(r.concatenation,N,N),N.addBinaryOperation(r.concatenation,N,N),B.addBinaryOperation(r.keywordLike,B,re),B.addBinaryOperation(r.keywordLike,N,re),N.addBinaryOperation(r.keywordLike,N,re);for(var le=[r.plus,r.minus,r.multiplication,r.division,r.modulo],ue=[r.lower,r.lowerOrEqual,r.greater,r.greaterOrEqual,r.equal,r.notEqual],ce=0;ce<ae.length;ce++){for(var de=ce;de<ae.length;de++)ae[ce].addBinaryOperation(le,ae[de],ae[de]),ae[ce].addBinaryOperation(ue,ae[de],re);ae[ce].unaryOperators=[r.minus]}z.addBinaryOperation(le,z,z);for(var he=[M,N],fe=0;fe<he.length;fe++)for(var me=fe;me<he.length;me++)he[fe].addBinaryOperation(r.concatenation,he[me],he[me]),he[fe].addBinaryOperation(ue,he[me],re);var pe=[r.keywordAnd,r.keywordOr];function ve(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ge(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}re.addBinaryOperation(pe,re,re),re.unaryOperators=[r.keywordNot],se.forEach((function(e){return e.unaryOperators=e.unaryOperators.concat([r.isNull,r.isNotNull])}));var be=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lookahead=4,this.endToken={position:{line:0,column:0,length:1},tt:r.endofSourcecode,value:"das Ende des Programms"},this.beginStatementKeywords=["select","insert into","update","create table","delete from","alter table","drop table"]}var t,n,i;return t=e,(n=[{key:"parse",value:function(e){if(this.module=e,this.tokenList=e.tokenList,this.errorList=[],e.completionHints=new Map,0==this.tokenList.length)return this.module.sqlStatements=[],this.module.errors[1]=this.errorList,void this.module.addCompletionHint({line:0,column:0,length:0},{line:2e4,column:100,length:0},!1,!1,this.beginStatementKeywords);this.pos=0,this.initializeLookahead();var t=this.tokenList[this.tokenList.length-1];this.endToken.position={line:t.position.line,column:t.position.column+t.position.length,length:1},this.module.sqlStatements=this.parseMain(),this.module.errors[1]=this.errorList}},{key:"initializeLookahead",value:function(){this.ct=[];for(var e=0;e<this.lookahead;e++){for(var t=this.endToken;!(this.pos>=this.tokenList.length);){var n=this.tokenList[this.pos];if(n.tt==r.comment&&(this.lastComment=n),n.tt!=r.newline&&n.tt!=r.space&&n.tt!=r.comment){t=n,null!=this.lastComment&&(t.commentBefore=this.lastComment,this.lastComment=null);break}this.pos++}this.ct.push(t),e<this.lookahead-1&&this.pos++}this.cct=this.ct[0],this.tt=this.cct.tt,this.position=this.cct.position}},{key:"nextToken",value:function(){var e;for(this.lastToken=this.cct;;){if(this.pos++,this.pos>=this.tokenList.length){e=this.endToken;break}if((e=this.tokenList[this.pos]).tt==r.comment&&(this.lastComment=e),e.tt!=r.newline&&e.tt!=r.space&&e.tt!=r.comment){e.commentBefore=this.lastComment,this.lastComment=null;break}}for(var t=0;t<this.lookahead-1;t++)this.ct[t]=this.ct[t+1];this.ct[this.lookahead-1]=e,this.cct=this.ct[0],this.tt=this.cct.tt,this.position=this.cct.position}},{key:"pushError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;null==n&&(n=Object.assign({},this.position)),this.errorList.push({text:e,position:n,quickFix:i,level:t})}},{key:"skip",value:function(e){Array.isArray(e)||(e=[e]),e.indexOf(this.tt)>=0&&this.nextToken()}},{key:"expect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.tt!=e&&!(Array.isArray(e)&&e.indexOf(this.tt)>=0)){if(e==r.semicolon&&this.tt==r.endofSourcecode)return!0;var i=this.cct.position;e==r.semicolon&&null!=this.lastToken&&this.lastToken.position.line<i.line&&(i={line:this.lastToken.position.line,column:this.lastToken.position.column+this.lastToken.position.length,length:1});var o=null;if(e==r.semicolon&&this.lastToken.position.line<this.cct.position.line&&!this.isOperatorOrDot(this.lastToken.tt)&&(o={title:"Strichpunkt hier einfügen",editsProvider:function(e){return[{resource:e,edit:{range:{startLineNumber:i.line,startColumn:i.column,endLineNumber:i.line,endColumn:i.column,message:"",severity:monaco.MarkerSeverity.Error},text:";"}}]}},n&&this.module.main.getSemicolonAngel().register(i,this.module)),Array.isArray(e)){var a=e.map((function(e){return s[e]})).join(", ");this.pushError("Erwartet wird eines der folgenden: "+a+" - Gefunden wurde: "+s[this.tt],"error",i,o)}else this.pushError("Erwartet wird: "+s[e]+" - Gefunden wurde: "+s[this.tt],"error",i,o);return!1}return t&&this.nextToken(),!0}},{key:"getEndOfPosition",value:function(e){return{line:e.line,column:e.column+e.length,length:0}}},{key:"isOperatorOrDot",value:function(t){if(t==r.dot)return!0;var n,i=ve(e.operatorPrecedence);try{for(i.s();!(n=i.n()).done;){var o,a=ve(n.value);try{for(a.s();!(o=a.n()).done;)if(t==o.value)return!0}catch(e){a.e(e)}finally{a.f()}}}catch(e){i.e(e)}finally{i.f()}}},{key:"isEnd",value:function(){return this.cct==this.endToken}},{key:"comesToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Array.isArray(e)){var n=this.tt==e;return n&&t&&this.nextToken(),n}return e.indexOf(this.tt)>=0}},{key:"getCurrentPosition",value:function(){return Object.assign({},this.position)}},{key:"getCurrentPositionPlus",value:function(e){if(this.tt==r.endofSourcecode)return{line:this.endToken.position.line,column:100,length:1};for(var t=0,n=e,i=0;t<this.lookahead-1&&(i=this.ct[t].position.length)<n;)n-=i,t++;var o=this.ct[t].position;return null==o&&(o=this.getCurrentPosition()),{line:o.line,column:o.column+n,length:1}}},{key:"getEndOfCurrentToken",value:function(){var e=this.getCurrentPosition();return e.column=e.column+this.position.length,e.length=0,e}},{key:"parseMain",value:function(){var e=[],t={column:0,line:0,length:0},n=!0;for(this.module.addCompletionHint(t,this.getCurrentPositionPlus(8),!1,!1,this.beginStatementKeywords);!this.isEnd();){for(var i=this.pos,o=this.errorList.length;[r.space,r.newline,r.comment,r.semicolon].indexOf(this.cct.tt)>=0;)this.nextToken();var a=this.getCurrentPosition(),l=this.parseStatement();for(t={line:this.lastToken.position.line+1,column:0,length:0},n=this.tt==r.semicolon;this.tt==r.semicolon;)this.nextToken();for(var u=!1,c=o;c<this.errorList.length;c++)"error"==this.errorList[c].level&&(u=!0);if(null!=l&&e.push({ast:l,from:a,to:this.getEndOfPosition(this.lastToken.position),hasErrors:u,acceptedBySQLite:!1}),this.getCurrentPosition(),this.pos==i)for(var d=[r.keywordSelect,r.keywordUpdate,r.keywordCreate,r.keywordInsert,r.keywordDelete,r.keywordDrop,r.keywordAlter],h=!0;!this.isEnd()&&d.indexOf(this.tt)<0;)[r.space,r.newline].indexOf(this.tt)<0&&h&&(this.pushError("Erwartet wird eines dieser Schlüsselwörter: "+d.map((function(e){return s[e]})).join(", ")+"; Gefunden wurde: "+this.cct.value),h=!0),this.nextToken();(n||this.cct.position.line-t.line>0)&&this.module.addCompletionHint(t,this.getCurrentPositionPlus(8),!1,!1,this.beginStatementKeywords)}return this.module.addCompletionHint(t,{line:this.endToken.position.line+1,column:0,length:0},!1,!1,this.beginStatementKeywords),e}},{key:"parseStatement",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var e=null;switch(this.tt){case r.keywordSelect:return this.parseSelect();case r.keywordInsert:return this.parseInsert();case r.keywordCreate:return this.parseCreateTableOrDatabase();case r.keywordUpdate:return this.parseUpdate();case r.keywordDelete:return this.parseDelete();case r.keywordDrop:return this.parseDropTable();case r.keywordAlter:return this.parseAlterTable();case r.keywordCommit:return this.pushError("Die Aweisung commit ist unnötig, da jede Anweisung automatisch commited wird.","info"),this.nextToken(),null;case r.keywordSet:return this.parseSet();case r.keywordUse:return this.parseUse();case r.keywordStart:return this.nextToken(),this.expect(r.keywordTransaction,!0),null;case r.keywordLock:case r.keywordUnlock:return this.parseLockUnlock(),null;default:var t=s[this.tt];null==t&&(t=""),t!=this.cct.value&&(t+="("+this.cct.value+")"),t+=" wird hier nicht erwartet.",this.pushError(t),this.nextToken()}return e}},{key:"parseLockUnlock",value:function(){this.nextToken(),this.expect(r.keywordTables,!0),this.skip(r.identifier),this.skip([r.keywordWrite,r.keywordRead]),this.skip(r.semicolon)}},{key:"parseSet",value:function(){this.pushError("Das SET-Statement wird von SQLite nicht unterstützt. Diese Anweisung wird daher einfach überlesen.","info");var e={type:r.omittedeStatement,position:this.getCurrentPosition(),endPosition:null,symbolTable:null};return this.nextToken(),this.expect(r.identifier,!0),this.expect(r.equal,!0),this.expect([r.identifier,r.stringConstant,r.integerConstant,r.charConstant,r.booleanConstant,r.floatingPointConstant],!0),e.endPosition=this.getCurrentPosition(),e}},{key:"parseUse",value:function(){this.pushError("Das USE-Statement wird von SQLite nicht unterstützt. Diese Anweisung wird daher einfach überlesen. Sie können eine andere Datenbank auswählen indem Sie in der Datenbankliste links darauf klicken.","info");var e={type:r.omittedeStatement,position:this.getCurrentPosition(),endPosition:null,symbolTable:null};return this.nextToken(),this.expect(r.identifier,!0),e.endPosition=this.getCurrentPosition(),e}},{key:"parseAlterTable",value:function(){var e=this.getCurrentPosition();this.nextToken();var t={type:r.keywordAlter,kind:null,position:e,endPosition:this.getEndOfPosition(this.getCurrentPosition()),symbolTable:null,tableIdentifier:null,tableIdentifierPosition:null};if(this.expect(r.keywordTable,!0)||this.addCompletionHintHere(!1,!1,["table"],1),this.addCompletionHintHere(!1,!0,[],1),!this.expect(r.identifier,!1))return t;switch(t.tableIdentifier=this.cct.value,t.tableIdentifierPosition=this.getCurrentPosition(),this.nextToken(),t.endPosition=this.getCurrentPosition(),this.addCompletionHintHere(!1,!1,["rename to","rename column","add column","drop column"],1),this.tt){case r.keywordRename:this.parseRenameTableOrColumn(t);break;case r.keywordAdd:this.parseAlterTableAdd(t);break;case r.keywordDrop:this.parseDropColumn(t);break;default:this.pushError("Erwartet wird rename to, rename column, add column oder drop column")}return t}},{key:"parseRenameTableOrColumn",value:function(e){switch(this.nextToken(),this.comesToken(r.keywordTo)||this.addCompletionHintHere(e.tableIdentifier,!1,["column","to"],3),e.endPosition=this.getEndOfCurrentToken(),this.tt){case r.keywordTo:return this.nextToken(),e.endPosition=this.getEndOfCurrentToken(),e.kind="renameTable",void(this.comesToken(r.identifier)?(e.newTableName=this.cct.value,this.nextToken(),e.endPosition=this.getEndOfCurrentToken()):this.pushError("Erwartet wird der neue Tabellenname."));case r.keywordColumn:if(this.nextToken(),e.endPosition=this.getEndOfCurrentToken(),this.addCompletionHintHere(e.tableIdentifier,!1,[],3),!this.comesToken(r.identifier))return void this.pushError("Erwartet wird der Name einer Spalte der Tabelle "+e.tableIdentifier+".");if(e.kind="renameColumn",e.oldColumnName=this.cct.value,e.oldColumnPosition=this.getCurrentPosition(),this.nextToken(),this.addCompletionHintHere(!1,!1,["to"],3),e.endPosition=this.getEndOfCurrentToken(),!this.expect(r.keywordTo,!0))return;return e.endPosition=this.getEndOfCurrentToken(),void(this.comesToken(r.identifier)?(e.newColumnName=this.cct.value,this.nextToken(),e.endPosition=this.getEndOfCurrentToken()):this.pushError("Erwartet wird der neue Spaltenname."));default:return void this.pushError("Erwartet wird das Schlüsselwort 'to' (zum Umbenennen der Tabelle) oder das Schlüsselwor 'column' (zum Umbenennen einer Spalte).")}}},{key:"parseDropColumn",value:function(e){this.nextToken(),this.comesToken(r.keywordColumn,!0),e.oldColumnPosition=this.getCurrentPosition(),this.addCompletionHintHere(e.tableIdentifier,!1,[],3),e.kind="dropColumn",e.endPosition=this.getEndOfCurrentToken(),this.comesToken(r.identifier)?(e.oldColumnName=this.cct.value,this.nextToken()):this.pushError("Erwartet wird der Bezeichner der Spalte, die gelöscht werden soll.")}},{key:"parseAlterTableAdd",value:function(e){do{this.nextToken();var t=!1;switch(this.tt){case r.keywordColumn:this.parseAddColumn(e);break;case r.keywordPrimary:this.parseAddPrimaryKey(e);break;case r.keywordUnique:this.nextToken(),t=!0,this.expect([r.keywordIndex,r.keywordKey],!1);case r.keywordKey:case r.keywordIndex:this.parseAddIndex(e,t);break;case r.keywordModify:this.parseModifyColumn(e);break;case r.keywordConstraint:this.parseAddConstraint(e)}}while(this.tt==r.comma)}},{key:"parseAddConstraint",value:function(e){if(this.nextToken(),this.expect(r.identifier)&&this.comesToken(r.keywordForeign)){var t=this.parseForeignKeyDefinition();null!=t&&(null==e.foreignKeys&&(e.foreignKeys=[]),e.foreignKeys.push(t))}}},{key:"parseForeignKeyDefinition",value:function(){var e={column:"",referencesTable:"",referencesColumn:"",referencesPosition:this.getCurrentPosition()};if(this.expect(r.keywordForeign)&&this.expect(r.keywordKey)&&this.expect(r.leftBracket))if(this.comesToken(r.identifier)){if(e.column=this.cct.value,this.nextToken(),this.expect(r.rightBracket))return this.parseReferences(e),e}else this.pushError("Der Bezeichner der Fremdschlüsselspalte wird erwartet.")}},{key:"parseReferences",value:function(e){if(this.expect(r.keywordReferences))if(this.addCompletionHintHere(!1,!0,[]),this.comesToken(r.identifier)){e.referencesTable=this.cct.value,this.nextToken();var t=this.lastToken.position,n=this.getCurrentPosition();if(this.module.addCompletionHint(this.getEndOfPosition(t),n,e.referencesTable,!1,[]),this.expect(r.leftBracket))if(this.comesToken(r.identifier)){if(e.referencesColumn=this.cct.value,this.nextToken(),this.expect(r.rightBracket))for(;this.tt==r.keywordOn;){this.nextToken();var i="";switch(this.tt){case r.keywordDelete:i="onDelete";break;case r.keywordUpdate:i="onUpdate"}switch(""==i?(this.pushError("Nach 'on' wird 'delete' oder 'update' erwartet."),this.comesToken([r.keywordCascade,r.keywordRestrict,r.keywordSet,r.keywordNo])||(this.nextToken(),i="onDelete")):this.nextToken(),this.tt){case r.keywordCascade:case r.keywordRestrict:e[i]=this.cct.value,this.nextToken();break;case r.keywordSet:e[i]="set ",this.nextToken(),[r.keywordNull,r.keywordDefault].indexOf(this.tt)>=0?(e[i]+=this.cct.value,this.nextToken()):this.pushError("Nach 'on delete/update set' wird 'null' oder 'default' erwartet.");break;case r.keywordNo:this.nextToken(),this.expect(r.keywordAction),e[i]="no action";break;default:this.pushError("Nach 'on delete/update' wird 'cascade', 'set null', 'set default' oder 'no action' erwartet.")}}}else this.pushError("Der Bezeichner der referenzierten Spalte wird erwartet.")}else this.pushError("Der Bezeichner der referenzierten Tabelle wird erwartet.")}},{key:"parseModifyColumn",value:function(e){this.nextToken();var t=this.parseColumnDefinition(!1);null!=t&&(null==e.modifyColumnInfo&&(e.modifyColumnInfo=[]),e.modifyColumnInfo.push(t))}},{key:"parseAddPrimaryKey",value:function(e){if(this.nextToken(),e.primaryKeys=[],this.expect(r.keywordKey,!0)&&this.expect(r.leftBracket,!1))do{this.nextToken(),this.tt==r.identifier&&(e.primaryKeys.push(this.cct.value),this.nextToken())}while(this.tt==r.comma);return this.expect(r.rightBracket,!0)?(e.kind="omittedKind",e):null}},{key:"parseAddIndex",value:function(e,t){this.nextToken();var n={index_name:"",column:"",unique:t};return this.tt!=r.identifier?(this.pushError("Erwartet wird der Bezeichner des Index."),null):(n.index_name=this.cct.value,this.nextToken(),this.expect(r.leftBracket,!0)?this.tt!=r.identifier?(this.pushError("Erwartet wird der Bezeichner der Spalte, für die ein Index erstellt werden soll."),null):(n.column=this.cct.value,this.nextToken(),null==e.indices&&(e.indices=[]),e.indices.push(n),e.kind="omittedKind",this.expect(r.rightBracket,!0),null):null)}},{key:"parseAddColumn",value:function(e){e.kind="addColumn",this.comesToken(r.keywordColumn,!0),e.columnDefBegin=this.getCurrentPosition(),e.columnDef=this.parseColumnDefinition(!1)}},{key:"parseDropTable",value:function(){var e=this.getCurrentPosition();this.nextToken();var t={type:r.keywordDrop,position:e,endPosition:this.getEndOfPosition(this.getCurrentPosition()),symbolTable:null,tableIdentifier:null,tableIdentifierPosition:null,ifExists:!1};return this.expect(r.keywordTable,!0)||this.addCompletionHintHere(!1,!1,["table"],1),this.comesToken(r.keywordIf,!0)&&(t.ifExists=!0,this.expect(r.keywordExists,!0)),this.addCompletionHintHere(!1,!0,[],1,"",";"),this.expect(r.identifier,!1)?(t.tableIdentifier=this.cct.value,t.tableIdentifierPosition=this.getCurrentPosition(),this.nextToken(),t.endPosition=this.getCurrentPosition(),t):t}},{key:"parseDelete",value:function(){var e=this.getCurrentPosition();this.nextToken();var t={type:r.keywordDelete,position:e,endPosition:this.getEndOfPosition(this.getCurrentPosition()),symbolTable:null,tableIdentifier:null,tableIdentifierPosition:null,whereNode:null,whereNodeBegin:null,whereNodeEnd:null};return this.expect(r.keywordFrom,!0)||this.addCompletionHintHere(!1,!1,["from"],1),this.addCompletionHintHere(!1,!0,[],1,""," where\n\t"),this.expect(r.identifier,!1)?(t.tableIdentifier=this.cct.value,t.tableIdentifierPosition=this.getCurrentPosition(),this.nextToken(),t.endPosition=this.getCurrentPosition(),this.addCompletionHintHere(!1,!1,["where\n\t"],1),this.tt!=r.keywordWhere||(this.nextToken(),t.endPosition=this.getCurrentPosition(),t.whereNodeBegin=this.getEndOfPosition(this.lastToken.position),t.whereNode=this.parseTerm(),t.whereNodeEnd=this.getCurrentPosition(),this.module.addCompletionHint(t.whereNodeBegin,this.getCurrentPositionPlus(3),t.tableIdentifier,!1,[]),t.endPosition=this.getCurrentPosition()),t):t}},{key:"parseUpdate",value:function(){var e=this.getCurrentPosition();this.nextToken();var t={type:r.keywordUpdate,position:e,endPosition:this.getEndOfPosition(this.getCurrentPosition()),symbolTable:null,tableIdentifier:null,tableIdentifierPosition:null,columnIdentifiers:[],columnIdentifierPositions:[],values:[],valuePosBegin:[],valuePosEnd:[],whereNode:null,whereNodeBegin:null,whereNodeEnd:null};if(this.addCompletionHintHere(!1,!0,[],1,""," set\n\t"),!this.expect(r.identifier,!1))return t;if(t.tableIdentifier=this.cct.value,t.tableIdentifierPosition=this.getCurrentPosition(),this.nextToken(),t.endPosition=this.getCurrentPosition(),this.addCompletionHintHere(!1,!1,["set\n\t"],1),!this.expect(r.keywordSet))return t;var n=!0;do{if(this.addCompletionHintHere(t.tableIdentifier,!1,n?[]:["where"],1,null," = "),n=!1,this.tt!=r.identifier){this.pushError("Hier wird der Bezeichner derjenigen Spalte der Tabelle "+t.tableIdentifier+" erwaretet, deren Wert verändert werden soll.","error");break}t.columnIdentifiers.push(this.cct.value),t.columnIdentifierPositions.push(this.getCurrentPosition()),this.nextToken(),this.expect(r.equal,!0),t.valuePosBegin.push(this.getCurrentPosition()),t.values.push(this.parseTerm()),t.valuePosEnd.push(this.getCurrentPosition())}while(this.comesToken(r.comma,!0));if(t.endPosition=this.getCurrentPosition(),this.lastToken.tt!=r.comma||this.comesToken(r.keywordWhere)){if(!this.expect(r.keywordWhere,!0))return t;t.whereNodeBegin=this.getEndOfPosition(this.lastToken.position),t.whereNode=this.parseTerm(),t.whereNodeEnd=this.getCurrentPosition(),this.module.addCompletionHint(t.whereNodeBegin,t.whereNodeEnd,t.tableIdentifier,!1,[]),t.endPosition=this.getCurrentPosition()}else this.comesToken(r.keywordWhere,!0);return t}},{key:"parseCreateTableOrDatabase",value:function(){switch(this.ct[1].tt){case r.keywordDatabase:return this.parseCreateDatabase();case r.keywordTable:return this.parseCreateTable();default:return this.nextToken(),this.pushError("Nach 'create' wird 'table' erwartet."),this.nextToken(),null}}},{key:"parseCreateDatabase",value:function(){var e={type:r.omittedeStatement,position:this.getCurrentPosition(),endPosition:null,symbolTable:null};for(this.nextToken(),this.pushError("Die CREATE-DATABASE-Anweisung wird von der SQLite-Engine nicht unterstützt. Sie können eine neue Datenbank anlegen, indem Sie auf den entsprechenden Button oberhalb der Liste der Datenbanken (linke Seite des Fensters) klicken. Diese Anweisung wird überlesen.","info");this.tt!=r.semicolon&&this.tt!=r.endofSourcecode;)e.endPosition=this.getEndOfCurrentToken(),this.nextToken();return e}},{key:"parseCreateTable",value:function(){var e=this.getCurrentPosition();this.nextToken(),this.expect(r.keywordTable,!0)||this.module.addCompletionHint(e,this.getCurrentPositionPlus(3),!1,!1,["table"]);var t=!1;this.comesToken(r.keywordIf)&&(this.nextToken(),this.expect(r.keywordNot,!0),this.expect(r.keywordExists,!0),t=!0);var n="";this.expect(r.identifier,!1)&&(n=this.cct.value,this.module.addCompletionHint(this.getCurrentPosition(),this.getCurrentPositionPlus(n.length+3),!1,!1,["("]),this.nextToken());var i={type:r.keywordCreate,identifier:n,position:e,endPosition:null,columnList:[],symbolTable:null,combinedPrimaryKeyColumns:[],foreignKeyInfoList:[],ifNotExists:t,uniqueConstraints:[]};if(!this.expect(r.leftBracket,!0))return i;for(var o=!1,a=!0;this.tt!=r.rightBracket;){switch(a||this.expect(r.comma,!0),a=!1,this.comesToken(r.keywordConstraint,!0)&&(this.expect(r.identifier,!0),this.expect([r.keywordForeign,r.keywordPrimary,r.keywordUnique],!1)),this.tt){case r.keywordPrimary:o&&this.pushError("Je Tabelle darf nur ein einziger Primärschlüssel definiert werden.","error",this.getCurrentPosition()),this.parsePrimaryKeyTerm(o,i),o=!0;break;case r.keywordUnique:this.parseUniqueTerm(i);break;case r.keywordForeign:var l=this.parseForeignKeyDefinition();null!=l&&i.foreignKeyInfoList.push(l);break;case r.identifier:var u=this.parseColumnDefinition(o);i.columnList.push(u),o=o||u.isPrimary;break;default:this.pushError(s[this.tt]+" wird hier nicht erwartet.","error")}if(!this.comesToken(r.comma))break}for(this.expect(r.rightBracket,!0);[r.keywordEngine,r.keywordDefault,r.keywordCollate].indexOf(this.tt)>=0;)switch(this.tt){case r.keywordCollate:case r.keywordEngine:this.nextToken(),this.skip(r.equal),this.expect(r.identifier,!0);break;case r.keywordDefault:this.nextToken(),this.expect([r.keywordCharset,r.keywordCharacter],!0),this.skip(r.keywordSet),this.skip(r.equal),this.expect(r.identifier,!0)}var c,d=ve(i.columnList);try{for(d.s();!(c=d.n()).done;){var h=c.value;h.isAutoIncrement&&!(h.isPrimary||i.combinedPrimaryKeyColumns.indexOf(h.identifier)>=0)&&this.pushError("autoincrement gibt es nur bei Primärschlüsseln, d.h. es fehlt wahrscheinlich 'primary key'.","warning",i.position)}}catch(e){d.e(e)}finally{d.f()}return i.endPosition=this.getCurrentPosition(),i}},{key:"parsePrimaryKeyTerm",value:function(e,t){e&&this.pushError("Die Tabelle kann nur einen einzigen Primärschlüssel haben."),this.nextToken(),this.expect(r.keywordKey,!0);var n=t.columnList.map((function(e){return e.identifier}));if(this.addCompletionHintHere(!1,!1,n),this.comesToken(r.leftBracket)){for(this.addCompletionHintHere(!1,!1,n),this.nextToken();;){if(!this.comesToken(r.identifier)){this.pushError("Der Bezeichner einer Spalte wird erwartet. Gefunden wurde: "+this.cct.value);break}if(t.combinedPrimaryKeyColumns.push(this.cct.value),this.nextToken(),this.addCompletionHintHere(!1,!1,n,1),!this.comesToken(r.comma))break;this.nextToken(),this.addCompletionHintHere(!1,!1,n)}this.expect(r.rightBracket,!0)}else this.pushError("( erwartet.")}},{key:"parseUniqueTerm",value:function(e){this.nextToken();var t=e.columnList.map((function(e){return e.identifier})),n=[];if(e.uniqueConstraints.push(n),this.addCompletionHintHere(!1,!1,t),this.comesToken(r.leftBracket)){for(this.addCompletionHintHere(!1,!1,t),this.nextToken();;){if(!this.comesToken(r.identifier)){this.pushError("Der Bezeichner einer Spalte wird erwartet. Gefunden wurde: "+this.cct.value);break}if(n.push(this.cct.value),this.nextToken(),this.addCompletionHintHere(!1,!1,t,1),!this.comesToken(r.comma))break;this.nextToken(),this.addCompletionHintHere(!1,!1,t)}this.expect(r.rightBracket,!0)}else this.pushError("( erwartet.")}},{key:"parseColumnDefinition",value:function(e){var t=this.getCurrentPosition(),n=this.cct.value;this.nextToken();var i={type:r.columnDef,identifier:n,isPrimary:!1,isAutoIncrement:!1,position:t,baseType:null,notNull:!1};return this.parseType(i,e),i}},{key:"addCompletionHintHere",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=this.lastToken.position,s=this.getCurrentPosition();s.column+=1+i,this.module.addCompletionHint(this.getEndOfPosition(a),s,e,t,n,null,r,o)}},{key:"parseType",value:function(e,t){var n=L.baseTypes.map((function(e){return e.toString()}));if(this.addCompletionHintHere(!1,!1,n),this.expect(r.identifier,!1)){var i=this.cct.value,o=L.getBaseType(i);if(null==o&&this.pushError("Erwartet wird ein Datentyp. Gefunden wurde: "+i),e.baseType=o,this.nextToken(),this.tt==r.leftBracket){for(this.nextToken(),e.parameters=[];this.tt==r.integerConstant&&(e.parameters.push(this.cct.value),this.nextToken(),this.tt==r.comma);)if(this.nextToken(),this.tt!=r.integerConstant){this.pushError("Erwartet wird eine ganze Zahl, gefunden wurde: "+this.cct.value);break}null!=o&&e.parameters.length>o.parameterDescriptions.length&&this.pushError("Der Datentyp "+o.toString()+" hat höchstens "+o.parameterDescriptions.length+" Parameter."),this.expect(r.rightBracket,!0)}this.addCompletionHintHere(!1,!1,["primary key","references","not null"]);for(var a=[];[r.keywordOn,r.keywordCharacter,r.keywordComment,r.keywordAutoincrement,r.keywordKey,r.keywordPrimary,r.keywordNot,r.keywordReferences,r.keywordCollate,r.keywordDefault].indexOf(this.tt)>=0;)switch(a.indexOf(this.tt)>=0&&this.pushError("Das Schlüsselwort "+s[this.tt]+" darf bei der Definition einer Spalte nicht öfters als ein Mal vorkommen."),a.push(this.tt),this.tt){case r.keywordAutoincrement:this.nextToken(),e.isAutoIncrement=!0,this.tt==r.equal?(this.nextToken(),this.expect(r.integerConstant)):this.tt==r.comma&&this.ct[1].tt==r.keywordAutoincrement&&this.nextToken();break;case r.keywordPrimary:t&&this.pushError("In einer Tabelle darf es nur einen einzigen primary key geben."),this.nextToken(),this.expect(r.keywordKey,!0)?this.addCompletionHintHere(!1,!1,["autoincrement, \n"]):this.addCompletionHintHere(!1,!1,["key"]),e.isPrimary=!0;break;case r.keywordReferences:var l={column:e.identifier,referencesColumn:"",referencesTable:"",referencesPosition:this.getCurrentPosition()};e.foreignKeyInfo=l,this.parseReferences(l);break;case r.keywordNot:this.nextToken(),this.expect(r.keywordNull,!0)?this.addCompletionHintHere(!1,!1,["references"]):this.addCompletionHintHere(!1,!1,["null"]),e.notNull=!0;break;case r.keywordCollate:this.nextToken(),e.collate=this.cct.value,this.expect(r.identifier,!0);break;case r.keywordCharacter:this.nextToken(),this.expect(r.keywordSet,!0),this.expect(r.identifier,!0);break;case r.keywordDefault:if(this.nextToken(),this.ct[1].tt==r.leftBracket&&this.ct[2].tt==r.rightBracket){this.nextToken(),this.nextToken(),this.nextToken();break}if(e.defaultValue=this.cct.value,"string"==typeof this.cct.value&&(e.defaultValue="'"+e.defaultValue+"'"),this.tt==r.keywordNull){this.nextToken();break}[r.identifier,r.integerConstant,r.floatingPointConstant,r.stringConstant].indexOf(this.tt)>=0&&(L.fromConstantType(this.tt).canCastTo(o)||this.pushError("Die Konstante hinter 'default' passt nicht zum Datentyp der Spalte."),this.nextToken());break;case r.keywordComment:this.nextToken(),this.expect(r.stringConstant,!0);break;case r.keywordOn:for(this.nextToken(),this.expect([r.keywordUpdate],!0);!this.comesToken([r.comma,r.endofSourcecode,r.rightBracket]);)this.nextToken();this.lastToken.tt==r.leftBracket&&this.tt==r.rightBracket&&this.nextToken()}}else this.pushError("Erwartet wird ein Datentyp. Gefunden wurde: "+this.cct.value)}},{key:"parseInsert",value:function(){var e=this.getCurrentPosition();this.nextToken(),this.expect(r.keywordInto,!0);var t={type:r.keywordInsert,position:e,endPosition:this.getCurrentPosition(),valuesPosition:null,columnsPosition:null,symbolTable:null,columnList:[],values:[],table:null};if(this.tt==r.identifier?(t.table={type:r.table,identifier:this.cct.value,alias:null,position:this.getCurrentPosition()},t.columnsPosition={line:t.table.position.line,column:t.table.position.column+t.table.position.length,length:0},this.nextToken()):this.pushError("Hier wird der Bezeichner einer Tabelle erwartet. Gefunden wurde: "+this.cct.value,"error"),this.tt==r.leftBracket){this.nextToken();for(var n=!0;n||this.tt==r.comma;)n||this.nextToken(),n=!1,this.tt==r.identifier?t.columnList.push({type:r.identifier,identifier:this.cct.value+"",position:this.getCurrentPosition()}):this.pushError("Erwartet wird der Bezeichner einer Spalte. Gefunden wurde: "+this.cct.value,"error"),this.nextToken();this.expect(r.rightBracket,!0)}return t.valuesPosition=this.getCurrentPosition(),this.expect(r.keywordValues,!0),this.parseValueLists(t.values),t.endPosition=this.getCurrentPosition(),t}},{key:"parseValueLists",value:function(e){for(var t=[r.keywordNull,r.charConstant,r.stringConstant,r.booleanConstant,r.floatingPointConstant,r.integerConstant],n=!0;n||this.tt==r.comma;){n||this.nextToken(),n=!1;var i=this.getCurrentPosition();if(!this.expect(r.leftBracket,!0))break;for(var o=[],a=!0;a||this.tt==r.comma;)a||this.nextToken(),a=!1,this.tt==r.identifier&&(this.cct.isDoubleQuotedIdentifier?this.tt=r.stringConstant:"date"==(this.cct.value+"").toLocaleLowerCase()&&this.nextToken()),t.indexOf(this.tt)<0?(this.pushError("Erwartet wird eine Konstante oder null. Gefunden wurde: "+this.cct.value,"error"),this.nextToken()):(o.push({constantType:this.tt,position:this.getCurrentPosition(),constant:this.cct.value,type:r.constantNode}),this.nextToken());this.expect(r.rightBracket,!0),0==o.length?this.pushError("Eine Zeile kann nur dann in die Tabelle eingefügt werden, wenn sie mindestens einen Spaltenwert besitzt.","error",i):e.push(o)}}},{key:"parseConstant",value:function(){var e={constantType:this.tt,position:this.getCurrentPosition(),constant:this.cct.value,type:r.constantNode};return this.nextToken(),e}},{key:"parseSelect",value:function(){var e=this.getCurrentPosition();this.nextToken();var t={line:e.line,column:e.column+6,length:1},n={type:r.keywordSelect,position:e,endPosition:this.getCurrentPosition(),symbolTable:null,columnList:[],fromNode:null,whereNode:null,parentStatement:null};n.columnList=this.parseColumnList([r.keywordFrom,r.semicolon,r.endofSourcecode],!0);var i=["distinct","as","*"];n.columnList.findIndex((function(e){return e.type==r.allColumns}))>=0&&i.pop(),this.module.addCompletionHint(t,this.getCurrentPositionPlus(1),!0,!0,i);var o=["join","left","right","inner","outer","natural","on","as",", "];if(this.comesToken(r.keywordFrom,!0)){n.fromStartPosition={line:this.lastToken.position.line,column:this.lastToken.position.column+this.lastToken.position.length,length:0};var a=[];n.fromNode=this.parseTableOrSubQuery(a),o.splice(o.indexOf(this.lastToken.value+""),1);var s=this.getCurrentPositionPlus(2);this.comesToken(r.semicolon)&&(s=this.getCurrentPosition()),this.module.addCompletionHint(n.fromStartPosition,s,!1,!0,o,a),n.fromEndPosition=this.getCurrentPosition()}else i.unshift("from");var l=["like"];if(this.tt==r.keywordWhere){this.getCurrentPosition();var u=this.getCurrentPosition();this.nextToken(),n.whereNode=this.parseTerm(),this.module.addCompletionHint(u,this.getCurrentPositionPlus(4),!0,!0,l)}else o.push("where");var c=[];if(this.tt==r.keywordGroup){var d=this.getCurrentPosition();n.groupByNode=this.parseGroupBy(),this.module.addCompletionHint(d,this.getCurrentPosition(),!0,!0,c)}else l.push("group by");if(this.tt==r.keywordOrder){var h=this.getCurrentPosition();n.orderByNode=this.parseOrderBy(),this.module.addCompletionHint(h,this.getCurrentPosition(),!0,!0,["asc","desc"])}else l.push("order by"),c.push("order by");return this.tt==r.keywordLimit&&(n.limitNode=this.parseLimit()),n.endPosition=this.getCurrentPosition(),n.endPosition.column+=3,n}},{key:"parseLimit",value:function(){var e=this.getCurrentPosition();this.nextToken();var t=this.parseTerm(),n={type:r.keywordLimit,position:e,numberOfRows:t};return this.tt==r.keywordOffset&&(this.nextToken(),n.offset=this.parseTerm()),n}},{key:"parseGroupBy",value:function(){var e=this.getCurrentPosition();this.expect(r.keywordGroup,!0),this.expect(r.keywordBy,!0);var t={type:r.keywordGroup,columnList:[],position:e},n=[r.keywordHaving,r.keywordSelect,r.keywordOrder,r.keywordLimit,r.rightBracket,r.semicolon];return t.columnList=this.parseColumnList(n,!1).map((function(e){return e.term})),this.tt==r.keywordHaving&&(this.nextToken(),t.having=this.parseTerm()),t}},{key:"parseOrderBy",value:function(){this.expect(r.keywordOrder,!0),this.expect(r.keywordBy,!0);var e=[],t=!0;do{t?t=!1:this.expect(r.comma,!0);var n=this.parseTerm(),i={type:r.keywordOrder,position:this.getCurrentPosition(),column:n};[r.keywordAscending,r.keywordDescending].indexOf(this.tt)>=0&&this.nextToken(),this.tt==r.keywordNulls&&(this.nextToken(),this.expect([r.keywordFirst,r.keywordLast],!0)),e.push(i)}while(this.tt==r.comma);return e}},{key:"parseTableOrSubQuery",value:function(e){for(var t=this.parseAtomicTableOrSubQuery(e),n=this.getCurrentPosition();this.parseJoinOperator();){var i=this.parseAtomicTableOrSubQuery(e);t={type:r.keywordJoin,firstOperand:t,secondOperand:i,position:n},this.tt==r.keywordOn&&(t.on=this.parseTerm())}return t}},{key:"parseJoinOperator",value:function(){if(this.tt==r.comma)return this.nextToken(),!0;switch(this.tt==r.keywordNatural&&this.nextToken(),this.tt){case r.keywordLeft:return this.nextToken(),this.tt==r.keywordOuter&&this.nextToken(),this.expect(r.keywordJoin,!0);case r.keywordInner:case r.keywordCross:return this.nextToken(),this.expect(r.keywordJoin,!0);case r.keywordJoin:return this.nextToken(),!0;default:return!1}}},{key:"parseAtomicTableOrSubQuery",value:function(e){if(!this.expect([r.identifier,r.leftBracket],!1))return null;if(this.tt==r.leftBracket){var t;if(this.nextToken(),this.tt==r.keywordSelect){var n=this.getCurrentPosition(),i=this.parseSelect();t={type:r.subquery,alias:null,position:n,query:i}}else t=this.parseTableOrSubQuery(e);return this.expect(r.rightBracket,!0),this.tt==r.keywordAs&&t.type==r.subquery&&(this.nextToken(),this.expect(r.identifier,!1)&&(t.alias=this.cct.value,this.nextToken(),e.push(t.alias))),t}if(this.tt==r.identifier){var o={type:r.table,identifier:this.cct.value,alias:null,position:this.getCurrentPosition()};return e.push(o.identifier),this.nextToken(),this.tt==r.keywordAs&&(this.nextToken(),this.expect(r.identifier,!1)&&(o.alias=this.cct.value,this.nextToken(),e.push(o.alias))),o}}},{key:"parseColumnList",value:function(e,t){for(var n=[];[r.stringConstant,r.integerConstant,r.floatingPointConstant,r.booleanConstant,r.identifier,r.multiplication,r.leftBracket].indexOf(this.tt)>=0;){if(this.tt==r.multiplication)n.push({term:null,alias:null,position:this.getCurrentPosition(),type:r.allColumns}),this.nextToken();else{var i=this.parseTerm();if(null!=i){var o={type:r.column,term:i,position:i.position};n.push(o),this.comesToken(r.keywordAs)&&(this.nextToken(),this.expect(r.identifier,!1)&&(o.alias=""+this.cct.value),this.nextToken())}}if(e.indexOf(this.tt)>=0)break;this.expect(r.comma,!0)}return 0==n.length&&this.pushError("Es fehlt die kommaseparierte Liste der gewünschten Spalten.","error"),n}},{key:"parseTerm",value:function(){return this.parseTermBinary(0)}},{key:"parseTermBinary",value:function(t){var n;n=t<e.operatorPrecedence.length-1?this.parseTermBinary(t+1):this.parseUnary();var i=e.operatorPrecedence[t];if(null==n||i.indexOf(this.tt)<0)return n;for(var o=!0;o||i.indexOf(this.tt)>=0;){var a=this.tt;o=!1;var s=this.getCurrentPosition();this.nextToken();var l=void 0;l=t<e.operatorPrecedence.length-1?this.parseTermBinary(t+1):this.parseUnary(),n={type:r.binaryOp,position:s,operator:a,firstOperand:n,secondOperand:l}}return n}},{key:"parseUnary",value:function(){var e,t=this.getCurrentPosition();switch(this.tt){case r.leftBracket:return this.parseBracket();case r.minus:t=t;var n=this.tt;return this.nextToken(),e=this.parseUnary(),{type:r.unaryOp,position:t,operand:e,operator:n};case r.integerConstant:case r.charConstant:case r.floatingPointConstant:case r.stringConstant:case r.booleanConstant:e={type:r.constantNode,position:this.getCurrentPosition(),constantType:this.tt,constant:this.cct.value};var i=this.tt==r.stringConstant;return this.nextToken(),i?this.parseDotOrArrayChains(e):e;case r.identifier:var o=this.cct.value,a=this.getCurrentPosition();if(this.nextToken(),this.tt==r.leftBracket){var s=this.parseMethodCallParameters(),l=s.rightBracketPosition;e={type:r.callMethod,position:a,rightBracketPosition:l,operands:s.nodes,identifier:o,commaPositions:s.commaPositions}}else if(e={type:r.identifier,identifier:o,position:t},this.tt==r.dot){var u=this.getCurrentPosition();this.nextToken(),this.expect(r.identifier,!1);var c={type:r.identifier,identifier:this.cct.value,position:this.getCurrentPosition()};this.nextToken(),e={type:r.dot,identifierLeft:e,identifierRight:c,position:u}}else[r.isNull,r.isNotNull].indexOf(this.tt)>=0&&(e={type:r.unaryOp,operand:e,operator:this.tt,position:t},this.nextToken());return e;default:return this.pushError("Erwartet wird eine Variable, ein Methodenaufruf oder eine Konstante. Gefunden wurde: "+this.cct.value),null}}},{key:"parseList",value:function(){for(var e={type:r.list,position:this.getCurrentPosition(),elements:[]},t=[r.charConstant,r.stringConstant,r.booleanConstant,r.floatingPointConstant,r.integerConstant];t.indexOf(this.tt)>=0&&(e.elements.push({type:r.constantNode,constant:this.cct.value,constantType:this.tt,position:this.cct.position}),this.nextToken(),this.tt==r.comma);)this.nextToken();return e}},{key:"parseBracket",value:function(){this.getCurrentPosition();var e=this.lastToken;if(this.nextToken(),this.tt==r.keywordSelect){var t=this.parseSelect();return this.expect(r.rightBracket,!0),t}if([r.comma,r.rightBracket].indexOf(this.ct[1].tt)>=0&&[r.keywordIn,r.keywordNotIn].indexOf(e.tt)>=0){var n=this.parseList();return this.expect(r.rightBracket,!0),n}var i=this.parseTerm(),o=this.getCurrentPosition();return this.expect(r.rightBracket,!0),{position:o,type:r.rightBracket,termInsideBrackets:i}}},{key:"parseMethodCallParameters",value:function(){if(this.nextToken(),this.tt==r.rightBracket){var e=this.getCurrentPosition();return this.nextToken(),{rightBracketPosition:e,nodes:[],commaPositions:[]}}for(var t=[],n=[];;){var i=this.pos;if(this.tt==r.multiplication)this.nextToken(),t.push({type:r.allColumns,position:this.getCurrentPosition()});else{var o=this.parseTerm();null!=o&&t.push(o)}if(this.tt!=r.comma)break;n.push(this.getCurrentPosition()),this.nextToken(),this.pos==i&&this.nextToken()}var a=this.getCurrentPosition();return{rightBracketPosition:this.expect(r.rightBracket,!0)?a:null,nodes:t,commaPositions:n}}},{key:"parseDotOrArrayChains",value:function(e){if(null==e)return null;for(;this.comesToken([r.dot,r.leftSquareBracket]);)if(this.tt==r.dot){if(this.nextToken(),this.tt!=r.identifier)return this.pushError("Erwartet wird der Bezeichner eines Attributs oder einer Methode, gefunden wurde: "+this.cct.value),e;var t=this.cct.value,n=this.getCurrentPosition();if(this.nextToken(),this.tt==r.leftBracket){var i=this.parseMethodCallParameters();e={type:r.callMethod,position:n,rightBracketPosition:i.rightBracketPosition,operands:i.nodes,identifier:t,commaPositions:i.commaPositions}}}return e}}])&&ge(t.prototype,n),i&&ge(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ke(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return we(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Te(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xe(e,t,n){return t&&Te(e.prototype,t),n&&Te(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}be.operatorPrecedence=[[r.keywordOr],[r.keywordAnd],[r.lower,r.lowerOrEqual,r.greater,r.greaterOrEqual,r.equal,r.notEqual,r.keywordLike],[r.concatenation,r.plus,r.minus],[r.multiplication,r.division,r.modulo],[r.keywordIn,r.keywordNotIn]];var je=function(){function e(t,n,i,r,o,a,s){Ce(this,e),this.identifier=t,this.type=n,this.table=i,this.isPrimaryKey=r,this.isNullable=o,this.defaultValue=a,this.isAutoIncrement=s}return xe(e,null,[{key:"fromColumnStructure",value:function(t,n){var i=t.completeTypeSQL.match(/^(\w*) *(?:\((.*)\))?.*$/),r=i[1],o=i[2],a=[];null!=o&&(a=o.split(",").map((function(e){return parseInt(e.trim())})));var s=L.getBaseType(r);a.length>0&&null!=s&&(s=new I(s,a));var l=new e(t.name,s,n,t.isPrimaryKey,!t.isPrimaryKey,t.defaultValue,t.isAutoIncrement);return l.notNull=t.notNull,l.fromColumnStructure=t,l}}]),e}(),Se=function(){function e(t){Ce(this,e),this.identifier=t,this.columns=[]}return xe(e,null,[{key:"fromTableStructure",value:function(t){var n=new e(t.name);return n.columns=t.columns.map((function(e){return je.fromColumnStructure(e,n)})),n.size=t.size,n}},{key:"fromTableStructureList",value:function(t){null==t&&(t=[]);var n,i=t.map((function(t){return e.fromTableStructure(t)})),r=new Map,o=ke(i);try{for(o.s();!(n=o.n()).done;){var a,s=ke(n.value.columns);try{for(s.s();!(a=s.n()).done;){var l=a.value;r.set(l.fromColumnStructure,l)}}catch(e){s.e(e)}finally{s.f()}}}catch(e){o.e(e)}finally{o.f()}var u,c=ke(i);try{for(c.s();!(u=c.n()).done;){var d,h=ke(u.value.columns);try{for(h.s();!(d=h.n()).done;){var f=d.value,m=f.fromColumnStructure.references;if(null!=m){var p=r.get(m);f.references=p}}}catch(e){h.e(e)}finally{h.f()}}}catch(e){c.e(e)}finally{c.f()}return i}}]),e}();function Ee(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _e(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function De(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Pe=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.childSymbolTables=[],this.symbols=new Map,this.symbolList=[],this.parent=t,this.positionFrom=n,this.positionTo=i,null!=this.parent&&this.parent.childSymbolTables.push(this)}var t,n,i;return t=e,(n=[{key:"extractDatabaseStructure",value:function(e){var t,n=Ee(Se.fromTableStructureList(null==e?void 0:e.tables));try{for(n.s();!(t=n.n()).done;){var i=t.value;this.storeTableSymbols(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"storeTableSymbols",value:function(e){this.storeSymbol({identifier:e.identifier,posOfDefinition:null,referencedOnPositions:[],table:e});var t,n=Ee(e.columns);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.storeSymbol({identifier:i.identifier,posOfDefinition:null,referencedOnPositions:[],column:i})}}catch(e){n.e(e)}finally{n.f()}}},{key:"storeSymbol",value:function(e){var t=this.symbols.get(e.identifier.toLowerCase());null==t?(t=[e],this.symbols.set(e.identifier.toLowerCase(),t)):t.push(e),this.symbolList.push(e)}},{key:"findTableAtPosition",value:function(e,t){if(!this.containsPosition(e,t))return null;var n,i=null,r=1e7,o=Ee(this.childSymbolTables);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.containsPosition(e,t)){var s=a.findTableAtPosition(e,t);s.positionTo.line-s.positionFrom.line<r&&(i=s,r=s.positionTo.line-s.positionFrom.line)}}}catch(e){o.e(e)}finally{o.f()}return null!=i?i:this}},{key:"containsPosition",value:function(e,t){return!(e<this.positionFrom.line||e>this.positionTo.line||e==this.positionFrom.line&&t<this.positionFrom.column||e==this.positionTo.line&&t>this.positionTo.column+1)}},{key:"findTable",value:function(e){var t=this.findTables(e);return 0==t.length?null:t[0].table}},{key:"findTables",value:function(e){for(var t=this;null!=t;){var n=t.symbols.get(e.toLowerCase());if(null!=n&&(n=n.filter((function(e){return null!=e.table}))).length>0)return n;t=t.parent}return[]}},{key:"findColumn",value:function(e){for(var t=this;null!=t;){var n=t.symbols.get(e.toLowerCase());if(null!=n&&(n=n.filter((function(e){return null!=e.column}))).length>0)return n;t=t.parent}return[]}}])&&De(t.prototype,n),i&&De(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Le(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Oe(e,t,n){return t&&Le(e.prototype,t),n&&Le(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Ae=Oe((function e(t,n){Ie(this,e),this.identifier=t,this.type=L.getBaseType(n)})),Me=Oe((function e(t,n,i,r){Ie(this,e),this.identifier=t,this.isAggregating=n,this.parameters=r,this.acceptsStarParameter=!1,this.returnType=L.getBaseType(i)})),Be=function(){function e(){Ie(this,e),this.methods=[],this.pushOneParameterMethod("max","integer","integer"),this.pushOneParameterMethod("max","float","float"),this.pushOneParameterMethod("min","integer","integer"),this.pushOneParameterMethod("min","float","float"),this.pushOneParameterMethod("avg","integer","integer"),this.pushOneParameterMethod("avg","float","float");var t=new Me("count",!0,"integer",[new Ae("spalte","text")]);t.acceptsStarParameter=!0,this.methods.push(t)}return Oe(e,[{key:"getMethods",value:function(e){return this.methods.filter((function(t){return t.identifier==e.toLowerCase()}))}},{key:"pushOneParameterMethod",value:function(e,t,n){this.methods.push(new Me(e,!0,t,[new Ae("spalte",n)]))}}],[{key:"getInstance",value:function(){return null==this.instance&&(this.instance=new e),this.instance}}]),e}();function Ne(e){return e.replace(/['"]+/g,"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Fe(e){return e<10?"0"+e:""+e}function $e(e){if(null==e||"string"!=typeof e)return!1;if(e.match(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/)){var t=e.split("/"),n=e.split("-"),i=t.length,r=n.length;if(i>1)var o=e.split("/");else if(r>1)o=e.split("-");if(3!=o.length)return!1;var a=parseInt(o[2]),s=parseInt(o[1]),l=parseInt(o[0]);if((1==s||s>2)&&a>[31,28,31,30,31,30,31,31,30,31,30,31][s-1])return!1;if(2==s){var u=!1;return(l%4||!(l%100))&&l%400||(u=!0),!(0==u&&a>=29)&&!(1==u&&a>29)}return!0}return!1}function Re(e){if(null==e||"string"!=typeof e)return!1;if(e.match(/^\d{4}[\-](0[1-9]|1[012])[\-](0[1-9]|[12][0-9]|3[01]) ([01][1-9]|2[0123]):([0-5][0-9]):([0-5][0-9])$/)){var t=e.split(" ")[0];if(10!=t.length)return!1;var n=parseInt(t.substring(8,10)),i=parseInt(t.substring(5,7)),r=parseInt(t.substring(0,4));if((1==i||i>2)&&n>[31,28,31,30,31,30,31,31,30,31,30,31][i-1])return!1;if(2==i){var o=!1;return(r%4||!(r%100))&&r%400||(o=!0),!(0==o&&n>=29)&&!(1==o&&n>29)}return!0}return!1}function Qe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return We(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return We(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ze(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var qe,Ue=function(){function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.symbolTableStack=[],this.databaseTool=t,this.tables=Se.fromTableStructureList(null===(n=t.databaseStructure)||void 0===n?void 0:n.tables)}var t,n,i;return t=e,(n=[{key:"start",value:function(e){this.module=e,this.symbolTableStack=[],this.errorList=[],e.mainSymbolTable=new Pe(null,{column:0,line:0,length:0},{column:0,line:1e5,length:0}),this.symbolTableStack.push(e.mainSymbolTable);var t,n=Qe(this.module.sqlStatements);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=this.errorList.length,a=i.ast;if(null!=a){switch(a.type){case r.keywordSelect:this.resolveSelect(a),this.symbolTableStack.pop();break;case r.keywordInsert:this.resolveInsert(a),this.symbolTableStack.pop();break;case r.keywordCreate:this.resolveCreateTable(a),this.symbolTableStack.pop();break;case r.keywordUpdate:this.resolveUpdate(a),this.symbolTableStack.pop();break;case r.keywordDelete:this.resolveDelete(a),this.symbolTableStack.pop();break;case r.keywordDrop:this.resolveDropTable(a),this.symbolTableStack.pop();break;case r.keywordAlter:this.resolveAlterTable(a),this.symbolTableStack.pop()}i.hasErrors=i.hasErrors||this.errorList.length>o}}}catch(e){n.e(e)}finally{n.f()}e.errors[2]=this.errorList}},{key:"pushError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;this.errorList.push({text:e,position:n,quickFix:i,level:t})}},{key:"getCurrentSymbolTable",value:function(){return this.symbolTableStack[this.symbolTableStack.length-1]}},{key:"pushNewSymbolTable",value:function(e,t){null==t&&(t={line:1e5,column:1,length:1});var n=new Pe(this.getCurrentSymbolTable(),e,t);return this.symbolTableStack.push(n),n}},{key:"resolveSelect",value:function(e){var t=new Se(null);e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition);var n=[];this.resolveTableOrSubQuery(e.fromNode,n),null!=e.fromStartPosition&&new Pe(this.getCurrentSymbolTable(),e.fromStartPosition,e.fromEndPosition).extractDatabaseStructure(this.databaseTool.databaseStructure);var i,o=Qe(e.columnList);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.type==r.allColumns){var s,l=Qe(n);try{for(l.s();!(s=l.n()).done;){var u,c=Qe(s.value.columns);try{for(c.s();!(u=c.n()).done;){var d=u.value,h=new je(d.identifier,d.type,t,!1,!0,d.defaultValue,d.isAutoIncrement);t.columns.push(h)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){l.e(e)}finally{l.f()}}else{this.resolveTerm(a.term);var f=new je(a.alias,a.term.sqlType,t,!1,!0,null,!1);t.columns.push(f),null!=f.identifier&&e.symbolTable.storeSymbol({identifier:f.identifier,posOfDefinition:a.term.position,referencedOnPositions:[],column:f})}}}catch(e){o.e(e)}finally{o.f()}if(null!=e.whereNode){var m=this.resolveTerm(e.whereNode);null!=m&&"boolean"!=m.getBaseTypeName()&&this.pushError("Das Ergebnis des where-Teils einer select-Anweisung muss vom Typ boolean sein.","error",e.whereNode.position)}return t}},{key:"resolveDropTable",value:function(e){e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition),e.symbolTable.extractDatabaseStructure(this.databaseTool.databaseStructure),null!=e.tableIdentifier&&(e.ifExists||null==e.symbolTable.findTable(e.tableIdentifier)&&this.pushError("Die Tabelle "+e.tableIdentifier+" ist nicht bekannt.","error",e.tableIdentifierPosition))}},{key:"resolveDelete",value:function(e){if(e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition),e.symbolTable.extractDatabaseStructure(this.databaseTool.databaseStructure),null!=e.tableIdentifier){var t=e.symbolTable.findTable(e.tableIdentifier);if(null==t&&this.pushError("Die Tabelle "+e.tableIdentifier+" ist nicht bekannt.","error",e.tableIdentifierPosition),null!=e.whereNode){var n=this.pushNewSymbolTable(e.whereNodeBegin,e.whereNodeEnd);null!=t&&n.storeTableSymbols(t),this.resolveTerm(e.whereNode),this.symbolTableStack.pop()}}}},{key:"resolveAlterTable",value:function(e){if(e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition),e.symbolTable.extractDatabaseStructure(this.databaseTool.databaseStructure),null!=e.tableIdentifier){var t=e.symbolTable.findTable(e.tableIdentifier);switch(null==t&&this.pushError("Die Tabelle "+e.tableIdentifier+" ist nicht bekannt.","error",e.tableIdentifierPosition),null!=e.oldColumnName&&null==t.columns.find((function(t){return t.identifier.toLocaleLowerCase()==e.oldColumnName.toLocaleLowerCase()}))&&this.pushError("Die Tabelle "+e.tableIdentifier+" hat keine Spalte mit dem Bezeichner "+e.oldColumnName,"error",e.oldColumnPosition),e.kind){case"dropColumn":break;case"addColumn":var n=e.columnDef;if(null==n)break;if(null!=n.foreignKeyInfo&&null!=n.baseType){var i=n.foreignKeyInfo,r=this.getCurrentSymbolTable().findTables(i.referencesTable);if(1==r.length){var o=r[0].table,a=o.columns.find((function(e){return e.identifier==i.referencesColumn}));null!=a&&null!=a.type&&(a.isPrimaryKey||this.pushError("Die referenzierte Spalte "+i.referencesTable+"."+i.referencesColumn+" ist kein Primärschlüssel.","warning",n.referencesPosition),a.type.canCastTo(n.baseType)||this.pushError("Der Datentyp "+n.baseType.toString()+" der Spalte "+n.identifier+" kann nich in den Datentyp "+a.type.toString()+" der referenzierten Spalte "+o.identifier+"."+a.identifier+" umgewandelt werden.","error",n.referencesPosition))}}}}}},{key:"resolveUpdate",value:function(e){var t=this;if(e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition),e.symbolTable.extractDatabaseStructure(this.databaseTool.databaseStructure),null!=e.tableIdentifier){var n=e.symbolTable.findTable(e.tableIdentifier);null==n&&this.pushError("Die Tabelle "+e.tableIdentifier+" ist nicht bekannt.","error",e.tableIdentifierPosition);for(var i=function(i){var r=e.columnIdentifiers[i],o=e.columnIdentifierPositions[i],a=e.values[i];return null==r?"continue":(null==n.columns.find((function(e){return e.identifier==r}))&&t.pushError(r+" ist kein Bezeichner einer Spalte der Tabelle "+e.tableIdentifier+".","error",o),null==a?"continue":(t.pushNewSymbolTable(e.valuePosBegin[i],e.valuePosEnd[i]).storeTableSymbols(n),t.resolveTerm(a),void t.symbolTableStack.pop()))},r=0;r<e.columnIdentifiers.length;r++)i(r);null!=e.whereNodeBegin&&this.pushNewSymbolTable(e.whereNodeBegin,e.whereNodeEnd).storeTableSymbols(n),null!=e.whereNode&&this.resolveTerm(e.whereNode),this.symbolTableStack.pop()}}},{key:"resolveCreateTable",value:function(e){var t=this;e.symbolTable=this.pushNewSymbolTable(e.position,e.endPosition),e.symbolTable.extractDatabaseStructure(this.databaseTool.databaseStructure);var n={identifier:e.identifier,columns:null,size:0};n.columns=e.columnList.map((function(e){return{identifier:e.identifier,isNullable:!1,isPrimaryKey:e.isPrimary,isAutoIncrement:e.isAutoIncrement,notNull:!1,references:null,table:n,type:e.baseType,defaultValue:e.defaultValue}})),e.symbolTable.storeTableSymbols(n);var i,r=Qe(e.columnList);try{var o=function(){var n=i.value;if(e.columnList.filter((function(e){return e.identifier.toLocaleLowerCase()==n.identifier.toLocaleLowerCase()})).length>1&&t.pushError("Der Spaltenbezeichner "+n.identifier+" darf in einer Tabelle nur ein einziges Mal verwendet werden","error",n.position),null!=n.foreignKeyInfo&&null!=n.baseType){var r=n.foreignKeyInfo,o=t.getCurrentSymbolTable().findTables(r.referencesTable);if(1==o.length){var a=o[0].table,s=a.columns.find((function(e){return e.identifier==r.referencesColumn}));null!=s&&null!=s.type&&(s.isPrimaryKey||t.pushError("Die referenzierte Spalte "+r.referencesTable+"."+r.referencesColumn+" ist kein Primärschlüssel.","warning",n.referencesPosition),s.type.canCastTo(n.baseType)||t.pushError("Der Datentyp "+n.baseType.toString()+" der Spalte "+n.identifier+" kann nich in den Datentyp "+s.type.toString()+" der referenzierten Spalte "+a.identifier+"."+s.identifier+" umgewandelt werden.","error",n.referencesPosition))}}};for(r.s();!(i=r.n()).done;)o()}catch(e){r.e(e)}finally{r.f()}var a,s=Qe(e.foreignKeyInfoList);try{var l=function(){var n=a.value,i=e.columnList.find((function(e){return e.identifier==n.column}));if(null==i)return"continue";var r=t.getCurrentSymbolTable().findTables(n.referencesTable);if(1==r.length){var o=r[0].table,s=o.columns.find((function(e){return e.identifier==n.referencesColumn}));null!=s&&null!=s.type&&(s.isPrimaryKey||t.pushError("Die referenzierte Spalte "+n.referencesTable+"."+n.referencesColumn+" ist kein Primärschlüssel.","warning",n.referencesPosition),s.type.canCastTo(i.baseType)||t.pushError("Der Datentyp "+i.baseType.toString()+" der Spalte "+i.identifier+" kann nich in den Datentyp "+s.type.toString()+" der referenzierten Spalte "+o.identifier+"."+s.identifier+" umgewandelt werden.","error",n.referencesPosition))}};for(s.s();!(a=s.n()).done;)l()}catch(e){s.e(e)}finally{s.f()}}},{key:"resolveTableOrSubQuery",value:function(e,t){if(null!=e)switch(e.type){case r.table:var n=this.tables.filter((function(t){return t.identifier.toLowerCase()==e.identifier.toLowerCase()}));if(0==n.length)this.pushError(e.identifier+" ist nicht der Name einer Tabelle.","error",e.position);else if(n.length>1)this.pushError("Der Bezeichner "+e.identifier+" ist hier nicht eindeutig.","error",e.position);else{var i=n[0];t.push(i),this.storeTableIntoSymbolTable(i,e.position,e.alias)}break;case r.keywordJoin:this.resolveTableOrSubQuery(e.firstOperand,t),this.resolveTableOrSubQuery(e.secondOperand,t);break;case r.subquery:e.table=this.resolveSelect(e.query),t.push(e.table),null!=e.alias&&(e.table.identifier=e.alias,this.storeTableIntoSymbolTable(e.table,e.position))}}},{key:"storeTableIntoSymbolTable",value:function(e,t,n){var i=this.getCurrentSymbolTable();i.storeSymbol({identifier:null==n?e.identifier.toLowerCase():n.toLowerCase(),posOfDefinition:t,table:e,referencedOnPositions:[]});var r,o=Qe(e.columns);try{for(o.s();!(r=o.n()).done;){var a=r.value;i.storeSymbol({identifier:a.identifier.toLowerCase(),posOfDefinition:null,column:a,tableAlias:n,referencedOnPositions:[]})}}catch(e){o.e(e)}finally{o.f()}}},{key:"resolveTerm",value:function(e){if(null==e)return null;switch(e.type){case r.binaryOp:if([r.keywordIn,r.keywordNotIn].indexOf(e.operator)>=0)return this.resolveNotIn(e);var t=this.resolveTerm(e.firstOperand),n=this.resolveTerm(e.secondOperand);if(null!=t&&null!=n){var i=t.getBinaryResultType(e.operator,n);return null==i&&this.pushError("Der Operator "+s[e.operator]+" ist für die Datentypen "+t.toString()+" und "+n.toString()+" nicht definiert.","error",e.position),i}return null;case r.unaryOp:var o=this.resolveTerm(e.operand);if(null!=o){var a=o.getUnaryResultType(e.operator);return null==a&&this.pushError("Der Operator "+s[e.operator]+" ist für einen Operanden des Datentyps "+o.toString()+" nicht definiert.","error",e.position),a}return null;case r.callMethod:return this.resolveMethodCall(e);case r.constantNode:return e.sqlType=L.fromConstantType(e.constantType),e.sqlType;case r.identifier:return this.resolveIdentifier(e);case r.dot:return this.resolveDot(e);case r.keywordSelect:var l=this.resolveSelect(e);return 1!=l.columns.length?(this.pushError("Die Ergebnistabelle einer Unterabfrage an dieser Stelle muss genau eine Spalte besitzen.","error",e.position),null):l.columns[0].type;case r.rightBracket:return e.sqlType=this.resolveTerm(e.termInsideBrackets),e.sqlType;case r.allColumns:this.pushError("Das Zeichen * kann hier nicht verwendet werden.","error",e.position);break;case r.list:this.pushError("Eine Liste wird hier nicht erwartet.","error",e.position)}}},{key:"resolveDot",value:function(e){var t=this.getCurrentSymbolTable().findTables(e.identifierLeft.identifier);if(0==t.length)return this.pushError("Die Tabelle "+e.identifierLeft.identifier+" kann nicht gefunden werden.","error",e.identifierLeft.position),null;if(t.length>1)return this.pushError("Der Tabellenbezeichner "+e.identifierLeft.identifier+" ist nicht eindeutig.","error",e.identifierLeft.position),null;var n=t[0].table.columns.filter((function(t){return t.identifier.toLowerCase()==e.identifierRight.identifier.toLowerCase()}));if(0!=n.length){if(!(n.length>1)){var i=n[0];return e.sqlType=i.type,i.type}this.pushError("Die Tabelle "+e.identifierLeft.identifier+" hat mehrere Spalten mit dem Bezeichner "+e.identifierRight.identifier+".","error",e.identifierRight.position)}else this.pushError("Die Tabelle "+e.identifierLeft.identifier+" hat keine Spalte mit dem Bezeichner "+e.identifierRight.identifier+".","error",e.identifierRight.position)}},{key:"resolveIdentifier",value:function(e){var t=this.getCurrentSymbolTable().findColumn(e.identifier);if(0==t.length)return this.pushError("Der Bezeichner "+e.identifier+" ist an dieser Stelle nicht bekannt.","error",e.position),null;if(t.length>1)return this.pushError("Der Bezeichner "+e.identifier+" ist nicht eindeutig.","error",e.position),null;var n=t[0];return e.sqlType=n.column.type,n.column.type}},{key:"resolveMethodCall",value:function(e){var t=Be.getInstance().getMethods(e.identifier);if(t=t.filter((function(t){return t.parameters.length==e.operands.length})),1==e.operands.length&&e.operands[0].type==r.allColumns)return t=t.filter((function(e){return e.acceptsStarParameter})),e.sqlType=t[0].returnType,e.sqlType;if(0==t.length)return this.pushError("Es gibt keine passende Methode mit dem Bezeichner '"+e.identifier+"'.","error",e.position),null;var n,i=Qe(e.operands);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(null==this.resolveTerm(o))return e.sqlType=t[0].returnType,e.sqlType}}catch(e){i.e(e)}finally{i.f()}var a,s=Qe(t);try{for(s.s();!(a=s.n()).done;){for(var l=a.value,u=!0,c=0;c<l.parameters.length;c++){var d=l.parameters[c];if(!e.operands[c].sqlType.canCastTo(d.type)){u=!1;break}}if(u)return e.sqlType=l.returnType,e.sqlType}}catch(e){s.e(e)}finally{s.f()}return this.pushError("Es gibt keine passende Methode mit dem Bezeichner '"+e.identifier+"'.","error",e.position),null}},{key:"resolveNotIn",value:function(e){if(null==e.firstOperand||null==e.secondOperand)return null;var t=s[e.operator];this.resolveTerm(e.firstOperand);var n=e.firstOperand.sqlType;if(null!=n)if(e.secondOperand.type==r.keywordSelect){var i=e.secondOperand;1!=i.columnList.length&&this.pushError("Wenn rechts vom Operator '"+t+"' eine Unterabfrage steht, muss die Ergebnistabelle dieser Unterabfrage genau eine Spalte haben.","error",i.position),this.resolveSelect(i);var o=i.columnList[0].term.sqlType;o.canCastTo(n)||this.pushError("Der Datentyp der Ergebnisspalte der Unterabfrage ist "+o.toString()+". Dieser kann nicht in den Datentyp "+n.toString()+" umgewandelt werden.","error",i.position)}else if(e.secondOperand.type==r.list){var a,l=Qe(e.secondOperand.elements);try{for(l.s();!(a=l.n()).done;){var u=a.value,c=L.fromConstantType(u.constantType);u.sqlType=c,c.canCastTo(n)||this.pushError("Der Datentyp des Listenelements "+u.constant+" ist "+c.toString()+". Er kann nicht in den Datentype "+n.toString()+" des Operanden auf der linken Seite des Operators '"+t+"' umgewandelt werden.","error",u.position)}}catch(e){l.e(e)}finally{l.f()}}else this.pushError("Der rechte Operand der Operatoren 'in' und 'not in' muss eine Unterabfrage oder eine Liste sein.","error",e.secondOperand.position);return L.getBaseType("boolean")}},{key:"resolveInsert",value:function(e){var t=this,n=null,i=this.pushNewSymbolTable(e.position,e.endPosition);null!=e.table&&(e.table.table=this.tables.find((function(t){return t.identifier.toLowerCase()==e.table.identifier.toLocaleLowerCase()})),null==e.table.table?this.pushError("Die Tabelle "+e.table.identifier+" gibt es nicht.","error",e.table.position):(n=e.table.table,i.storeTableSymbols(n)));var o=e.endPosition;null!=e.valuesPosition&&(o=e.valuesPosition),null!=e.columnsPosition&&(o=e.columnsPosition),this.module.addCompletionHint(e.position,o,!1,!0,["into","values"]),null!=n&&this.module.addCompletionHint(o,null==e.valuesPosition?e.endPosition:e.valuesPosition,!0,!1,["values"]),this.pushNewSymbolTable(e.position,o).extractDatabaseStructure(this.databaseTool.databaseStructure);var a=[];if(0==e.columnList.length)null!=n&&(a=n.columns);else if(null!=n){var s,l=Qe(e.columnList);try{var u=function(){var e=s.value,i=n.columns.find((function(t){return t.identifier.toLowerCase()==e.identifier.toLowerCase()}));null==i?t.pushError("Die Tabelle "+n.identifier+" besitzt keine Spalte mit dem Bezeichner "+e.identifier+".","error",e.position):a.push(i)};for(l.s();!(s=l.n()).done;)u()}catch(e){l.e(e)}finally{l.f()}}if(a.length>0){var c,d=Qe(e.values);try{for(d.s();!(c=d.n()).done;){var h=c.value;if(h.length!=a.length&&h.length>0)this.pushError("Erwartet werden "+a.length+" Elemente, hier stehen aber "+h.length+" Elemente in der Liste.","error",h[0].position);else for(var f=0;f<h.length;f++){var m=h[f],p=a[f];m.sqlType=L.fromConstantType(m.constantType);var v=p.type.toString().toLocaleLowerCase();if(m.constantType==r.keywordNull)p.isNullable&&!p.notNull||this.pushError("Die Spalte "+p.identifier+" ist nicht nullable, daher kann null hier nicht eingefügt werden.","error",m.position);else if(m.sqlType.canCastTo(p.type)){if("date"==v){if(!$e(m.constant)){var y="'".concat(m.constant,"' ist kein date-Wert.<br><b>Tipp: </b>Datumswerte haben die Form 'yyyy-mm-dd', also z.B. '2022-06-15'.");this.pushError(y,"error",m.position)}}else if(("datetime"==v||"timestamp"==v)&&!Re(m.constant)){var g="'".concat(m.constant,"' ist kein ").concat(v,"-Wert.<br><b>Tipp: </b>Timestamps haben die Form 'yyyy-mm-dd hh:min:ss', also z.B. '2022-06-15 07:56:22'.");this.pushError(g,"error",m.position)}}else{var b="Der Wert "+m.constant+" vom Datentyp "+m.sqlType.toString()+" kann nicht in den Datentyp "+p.type.toString()+" der Spalte "+p.identifier+" umgewandelt werden.";"date"==v&&(b+="<br><b>Tipp: </b>Datumswerte haben die Form 'yyyy-mm-dd', also z.B. '2022-06-15'."),"datetime"!=v&&"timestamp"!=v||(b+="<br><b>Tipp: </b>Timestamps haben die Form 'yyyy-mm-dd hh:min:ss', also z.B. '2022-06-15 07:56:22'."),this.pushError(b,"error",m.position)}}}}catch(e){d.e(e)}finally{d.f()}}this.symbolTableStack.pop()}}])&&ze(t.prototype,n),i&&ze(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function He(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ke(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ve(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(e){e[e.compiling=0]="compiling",e[e.error=1]="error",e[e.compiledButNothingToRun=2]="compiledButNothingToRun",e[e.readyToRun=3]="readyToRun"}(qe||(qe={}));var Ge=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.compilerStatus=qe.compiledButNothingToRun}var t,n,i;return t=e,(n=[{key:"compile",value:function(e){this.compilerStatus=qe.compiling;var t,n=performance.now(),i=new m,r=He(e.getModules(!1));try{for(r.s();!(t=r.n()).done;){var o=t.value;o.file.dirty=!1,o.clear();var a=i.lex(o.getProgramTextFromMonacoModel());o.errors[0]=a.errors,o.tokenList=a.tokens,o.bracketError=a.bracketError,o.file.name==this.main.getCurrentlyEditedModule().file.name&&null!=this.main.getBottomDiv()&&this.main.getBottomDiv().errorManager.showParenthesisWarning(a.bracketError)}}catch(e){r.e(e)}finally{r.f()}this.main.getSemicolonAngel().startRegistering();var s,l=new be,u=He(e.getModules(!1));try{for(u.s();!(s=u.n()).done;){var c=s.value;l.parse(c)}}catch(e){u.e(e)}finally{u.f()}var d,h=this.main.getDatabaseTool(),f=new Ue(h),p=He(e.getModules(!1));try{for(p.s();!(d=p.n()).done;){var v=d.value;f.start(v)}}catch(e){p.e(e)}finally{p.f()}var y=performance.now()-n,g="Compiled in "+(y=Math.round(100*y)/100)+" ms.";return this.main.getCurrentWorkspace().compilerMessage=g,this.main.getSemicolonAngel().healSemicolons(),this.compilerStatus=qe.readyToRun,null}}])&&Ve(t.prototype,n),i&&Ve(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Je(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ye(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ze(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function et(e,t,n){return t&&Ze(e.prototype,t),n&&Ze(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var tt=function(){function e(t,n){if(Xe(this,e),this.main=n,this.oldErrorDecorations=[],this.errors=[[],[],[],[]],this.identifierPositions={},this.methodCallPositions={},this.completionHints=new Map,null!=t&&null!=this.main){this.file=t;var i=t.name,r=e.uriMap[i];null==r?r=0:r++,e.uriMap[i]=r,r>0&&(i+=" ("+r+")"),this.uri=monaco.Uri.from({path:i,scheme:"inmemory"}),this.model=monaco.editor.createModel(t.text,"vscSQL",this.uri),this.model.updateOptions({tabSize:3}),this.lastSavedVersionId=this.model.getAlternativeVersionId();var o=this;this.model.onDidChangeContent((function(){var e=o.model.getAlternativeVersionId();if(e!=o.lastSavedVersionId&&(o.file.dirty=!0,o.file.saved=!1,o.lastSavedVersionId=e),!o.main.isEmbedded()){var t=n;t.workspacesOwnerId!=t.user.id?(null==o.file.text_before_revision||o.file.student_edited_after_revision)&&(o.file.student_edited_after_revision=!1,o.file.text_before_revision=o.file.text,o.file.saved=!1,t.networkManager.sendUpdates(null,!1),t.bottomDiv.homeworkManager.showHomeWorkRevisionButton(),t.projectExplorer.renderHomeworkButton(o.file)):o.file.student_edited_after_revision=!0}}))}}return et(e,[{key:"addCompletionHint",value:function(e,t,n,i,r,o){for(var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",l={fromColumn:e.column,fromLine:e.line,toColumn:t.column,toLine:t.line,hintColumns:"boolean"!=typeof n||n,hintColumnsOfTable:"string"==typeof n?n:null,hintTables:i,hintKeywords:r,dontHint:o,praefix:a,suffix:s},u=l.fromLine;u<=l.toLine;u++){var c=this.completionHints.get(u);null==c&&(c=[],this.completionHints.set(u,c)),c.push(l)}}},{key:"getSQLSTatementsAtSelection",value:function(e){var t=this,n={line:e.startLineNumber,column:e.startColumn},i={line:e.endLineNumber,column:e.endColumn};return null==this.sqlStatements?[]:this.sqlStatements.filter((function(e){return!(t.compare(e.to,n)<0||t.compare(e.from,i)>0)}))}},{key:"compare",value:function(e,t){return e.line>t.line?1:e.line<t.line?-1:e.column>t.column?1:e.column<t.column?-1:0}},{key:"getSQLStatementAtPosition",value:function(e){return this.sqlStatements.find((function(t){return!(t.from.line>e.lineNumber)&&(!(t.from.line==e.lineNumber&&t.from.column>e.column)&&(!(t.to.line<e.lineNumber)&&!(t.to.line==e.lineNumber&&t.to.column<e.column)))}))}},{key:"getCompletionHint",value:function(e,t){var n=this.completionHints.get(e);if(null==n||0==n.length)return null;var i=1e3*e+t;if(0!=(n=n.filter((function(e){return i>=1e3*e.fromLine+e.fromColumn&&i<=1e3*e.toLine+e.toColumn}))).length){for(var r=n[0],o=1e3*(r.toLine-r.fromLine)+(r.toColumn-r.fromColumn),a=1;a<n.length;a++){var s=n[a],l=1e3*(s.toLine-s.fromLine)+(s.toColumn-s.fromColumn);l<o&&(r=s,o=l)}return r}}},{key:"getFileData",value:function(e){var t=this.file;return{id:t.id,name:t.name,text:t.text,text_before_revision:t.text_before_revision,submitted_date:t.submitted_date,student_edited_after_revision:t.student_edited_after_revision,version:t.version,workspace_id:e.id,forceUpdate:!1,file_type:11}}},{key:"findSymbolTableAtPosition",value:function(e,t){return null==this.mainSymbolTable?null:((e>this.mainSymbolTable.positionTo.line||e==this.mainSymbolTable.positionTo.line&&t>this.mainSymbolTable.positionTo.column)&&(e=this.mainSymbolTable.positionTo.line,t=this.mainSymbolTable.positionTo.column-1),this.mainSymbolTable.findTableAtPosition(e,t))}},{key:"getErrorCount",value:function(){var e,t=0,n=Je(this.errors);try{for(n.s();!(e=n.n()).done;){e.value.forEach((function(e){return t+="error"==e.level?1:0}))}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"getProgramTextFromMonacoModel",value:function(){return this.model.getValue(monaco.editor.EndOfLinePreference.LF,!1)}},{key:"addIdentifierPosition",value:function(e,t){var n=this.identifierPositions[e.line];null==n&&(n=[],this.identifierPositions[e.line]=n),n.push({position:e,element:t})}},{key:"getElementAtPosition",value:function(e,t){var n=this.identifierPositions[e];if(null==n)return null;var i,r=null,o=Je(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;t>=a.position.column&&t<a.position.column+a.position.length&&a.position.length>0&&null==r&&(r=a)}}catch(e){o.e(e)}finally{o.f()}return null==r?null:r.element}},{key:"copy",value:function(){var t=new e(this.file,this.main);return t.model=this.model,t.mainSymbolTable=this.mainSymbolTable,this.mainSymbolTable=null,this.file.dirty=!0,t}},{key:"clear",value:function(){this.identifierPositions={},null!=this.file&&this.file.dirty&&(this.tokenList=null,this.errors[0]=[],this.errors[1]=[]),this.errors[2]=[],this.errors[3]=[],this.mainSymbolTable=new Pe(null,{line:1,column:1,length:1},{line:1e5,column:1,length:0}),this.methodCallPositions={}}},{key:"hasErrors",value:function(){var e,t=Je(this.errors);try{for(t.s();!(e=t.n()).done;){if(e.value.find((function(e){return"error"==e.level})))return!0}}catch(e){t.e(e)}finally{t.f()}return!1}},{key:"getSortedAndFilteredErrors",value:function(){var e,t=[],n=Je(this.errors);try{for(n.s();!(e=n.n()).done;){var i=e.value;t=t.concat(i)}}catch(e){n.e(e)}finally{n.f()}t.sort((function(e,t){return e.position.line>t.position.line?1:t.position.line>e.position.line?-1:e.position.column>=t.position.column?1:-1}));for(var r=0;r<t.length-1;r++){var o=t[r],a=t[r+1];o.position.line==a.position.line&&o.position.column+10>a.position.column&&(1==this.errorLevelCompare(o.level,a.level)?t.splice(r+1,1):t.splice(r,1),r--)}return t}},{key:"errorLevelCompare",value:function(e,t){return"error"==e?1:"error"==t?2:"warning"==e?1:"warning"==t?2:1}}],[{key:"restoreFromData",value:function(t,n){return new e({name:t.name,text:t.text,text_before_revision:t.text_before_revision,submitted_date:t.submitted_date,student_edited_after_revision:!1,dirty:!0,saved:!0,version:t.version,id:t.id},n)}}]),e}();tt.maxUriNumber=0,tt.uriMap={};var nt=function(){function e(t){Xe(this,e),this.main=t,this.modules=[],this.moduleMap=new Map,this.dirty=!1}return et(e,[{key:"findModuleById",value:function(e){var t,n=Je(this.modules);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.file.id==e)return i}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"copy",value:function(){var t,n=new e(this.main),i=Je(this.modules);try{for(i.s();!(t=i.n()).done;){var r=t.value;n.putModule(r.copy())}}catch(e){i.e(e)}finally{i.f()}return n}},{key:"findModuleByFile",value:function(e){var t,n=Je(this.modules);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.file==e)return i}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"hasErrors",value:function(){var e,t=Je(this.modules);try{for(t.s();!(e=t.n()).done;){if(e.value.hasErrors())return!0}}catch(e){t.e(e)}finally{t.f()}return!1}},{key:"getFirstModule",value:function(){if(this.modules.length>0){var e,t=Je(this.modules);try{for(t.s();!(e=t.n()).done;){return e.value}}catch(e){t.e(e)}finally{t.f()}}return null}},{key:"isDirty",value:function(){if(this.dirty)return this.dirty=!1,!0;var e,t=!1,n=Je(this.modules);try{for(n.s();!(e=n.n()).done;){if(e.value.file.dirty){t=!0;break}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"getModules",value:function(e,t){var n,i=[],r=Je(this.modules);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.file.name!=t&&i.push(o)}}catch(e){r.e(e)}finally{r.f()}return i}},{key:"putModule",value:function(e){this.modules.push(e),this.moduleMap[e.file.name]=e}},{key:"removeModuleWithFile",value:function(e){var t,n=Je(this.modules);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.file==e){this.removeModule(i);break}}}catch(e){n.e(e)}finally{n.f()}}},{key:"removeModule",value:function(e){this.modules.indexOf(e)<0||(this.modules.splice(this.modules.indexOf(e),1),this.moduleMap[e.file.name]=void 0,this.dirty=!0)}},{key:"getModule",value:function(e){return this.moduleMap[e]}}]),e}();function it(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ot(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var at=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$mainElement=t,this.main=n,this.actions={},this.keyEntries={},this.buttons={}}var t,n,i;return t=e,(n=[{key:"init",value:function(){var e=this.$mainElement;null==e&&(e=jQuery(document));var t=this;e.on("keydown",(function(e){null!=e&&t.executeKeyDownEvent(e)}))}},{key:"trigger",value:function(e){var t=this.actions[e];null!=t&&t.action(e,null,"")}},{key:"registerAction",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4?arguments[4]:void 0,o={action:n,identifier:e,keys:t,text:i,active:!0};this.actions[e]=o;var a,s=it(t);try{for(s.s();!(a=s.n()).done;){var l=a.value;null==this.keyEntries[l.toLowerCase()]&&(this.keyEntries[l.toLowerCase()]=[]),this.keyEntries[l.toLowerCase()].push(o)}}catch(e){s.e(e)}finally{s.f()}if(null!=r){null==this.buttons[e]&&(this.buttons[e]=[]),this.buttons[e].push(r);var u=i;t.length>0&&(u+=" ["+t.join(", ")+"]"),r.attr("title",u),r.on("mousedown",(function(){o.active&&n(e,null,"mousedown")}))}}},{key:"isActive",value:function(e){var t=this.actions[e];return null!=t&&t.active}},{key:"setActive",value:function(e,t){var n=this.actions[e];null!=n&&(n.active=t);var i=this.buttons[e];if(null!=i){var r,o=it(i);try{for(o.s();!(r=o.n()).done;){var a=r.value;t?a.addClass("jo_active"):a.removeClass("jo_active")}}catch(e){o.e(e)}finally{o.f()}}}},{key:"executeKeyDownEvent",value:function(e){if("input"!=document.activeElement.tagName.toLowerCase()&&!(e.keyCode<=18&&e.keyCode>=16)){var t="";e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),null!=e.key&&(t+=e.key.toLowerCase());var n=this.keyEntries[t];if(null!=n){var i,r=it(n);try{for(r.s();!(i=r.n()).done;){var o=i.value;if(o.active){e.stopPropagation(),e.preventDefault(),o.action(o.identifier,null,t);break}}}catch(e){r.e(e)}finally{r.f()}}}}}])&&ot(t.prototype,n),i&&ot(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function st(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ut(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=window.PointerEvent?"pointer":"mouse";null==t&&(t=e);var o=jQuery('<input type="text" class="jo_inplaceeditor" spellcheck="false">');o.css({width:t.css("width"),height:t.css("height"),color:t.css("color"),position:t.css("position"),"background-color":t.css("background-color"),"font-size":t.css("font-size"),"font-weight":t.css("font-weight"),"box-sizing":"border-box"}),o.val(e.text()),o.on(r+"down",(function(e){e.stopPropagation()})),null!=i&&o[0].setSelectionRange(i.start,i.end),t.after(o),t.hide(),setTimeout((function(){o.focus()}),300),o.on("keydown.me",(function(e){if("Enter"!=e.key&&"Escape"!=e.key);else{o.off("keydown.me"),o.off("focusout.me"),o.remove(),t.show();var i=Ne(o.val());n(i)}})),o.on("focusout.me",(function(e){o.off("keydown.me"),o.off("focusout.me"),o.remove(),t.show();var i=Ne(o.val());n(i)}))}function ct(e,t,n){var i,r=window.PointerEvent?"pointer":"mouse",o=jQuery('<div class="jo_contextmenu"></div>'),a=null,s=null,l=st(e);try{var u=function(){var e=i.value,t=e.caption;null!=e.link&&(t='<a href="'.concat(e.link,'" target="_blank" class="jo_menulink">').concat(e.caption,"</a>"));var n=jQuery("<div>"+t+(null!=e.subMenu?'<span style="float: right"> &nbsp; &nbsp; &gt;</span>':"")+"</div>");if(null!=e.color&&n.css("color",e.color),null==e.link)n.on(r+"up.contextmenu",(function(t){t.stopPropagation(),jQuery(".jo_contextmenu").remove(),jQuery(document).off(r+"up.contextmenu"),jQuery(document).off(r+"down.contextmenu"),jQuery(document).off("keydown.contextmenu"),e.callback()})),n.on(r+"down.contextmenu",(function(e){e.stopPropagation()}));else{var l=n.find("a");l.on(r+"up",(function(e){e.stopPropagation(),setTimeout((function(){n.hide()}),500)})),l.on(r+"down",(function(e){e.stopPropagation()}))}n.on(r+"move.contextmenu",(function(){e!=s&&null!=a&&(a.remove(),s=null,a=null),null!=e.subMenu&&(a=ct(e.subMenu,n.offset().left+n.width(),n.offset().top))})),o.append(n)};for(l.s();!(i=l.n()).done;)u()}catch(e){l.e(e)}finally{l.f()}jQuery(document).on(r+"down.contextmenu",(function(e){jQuery(document).off(r+"down.contextmenu"),jQuery(document).off("keydown.contextmenu"),jQuery(".jo_contextmenu").remove()})),jQuery(document).on("keydown.contextmenu",(function(e){"Escape"==e.key&&(jQuery(document).off(r+"up.contextmenu"),jQuery(document).off("keydown.contextmenu"),jQuery(".jo_contextmenu").remove())}));var c=t>.8*window.innerWidth?"right":"left",d=t>.8*window.innerWidth?window.innerWidth-t:t,h=n>.8*window.innerHeight?"bottom":"top",f=n>.8*window.innerHeight?window.innerHeight-n:n,m={};return m[c]=d+"px",m[h]=f+"px",o.css(m),jQuery("body").append(o),o.show(),o}function dt(e){var t=e.find(".jo_tabheadings>div").not(".jo_noHeading"),n=e.find(".jo_tabs>div"),i=window.PointerEvent?"pointer":"mouse";t.on(i+"down",(function(i){var r=jQuery(i.target);t.removeClass("jo_active"),r.addClass("jo_active");var o=e.find("."+r.data("target"));n.removeClass("jo_active"),n.trigger("myhide"),o.addClass("jo_active"),o.trigger("myshow")}))}function ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3?arguments[3]:void 0,r="";null!=e&&""!=e&&(r+=' id="'.concat(e,'"')),null!=t&&""!=t&&(r+=' class="'.concat(t,'"'));var o=jQuery("<div".concat(r,"></div>"));return null!=i&&o.css(i),null!=n&&""!=n&&o.text(n),o}var ft=!1;function mt(e,t,n,i){var r="rgba("+n[0]+", "+n[1]+", "+n[2]+", ",o=1,a=o/(i/20);!function n(){e.css(t,r+o+")"),(o-=a)<0?e.css(t,""):setTimeout(n,20)}()}function pt(e){navigator.clipboard?navigator.clipboard.writeText(e).then((function(){}),(function(e){console.error("Async: Could not copy text: ",e)})):function(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")}catch(e){console.error("Fallback: Oops, unable to copy",e)}document.body.removeChild(t)}(e)}function vt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var yt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerPerformanceEntry",value:function(t,n){var i=e.performanceData.find((function(e){return e.url==t}));null==i&&(i={count:0,sumTime:0,url:t},e.performanceData.push(i)),i.count++;var r=Math.round(performance.now()-n);i.sumTime+=r,e.performanceDataCount++}},{key:"sendDataToServer",value:function(){if(performance.now()-e.lastTimeSent>18e4){var t={data:e.performanceData};e.performanceData=[],e.performanceDataCount=0,e.lastTimeSent=performance.now(),gt("collectPerformanceData",t,(function(){}))}}}],(n=null)&&vt(t.prototype,n),i&&vt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function gt(e,t,n,i){bt(!0);var r=performance.now();$.ajax({type:"POST",async:!0,data:JSON.stringify(t),contentType:"application/json",url:"servlet/"+e,success:function(t){if(yt.registerPerformanceEntry(e,r),bt(!1),null!=t.success&&0==t.success||"string"==typeof t&&""==t){var o="Fehler bei der Bearbeitung der Anfrage";null!=t.message&&(o=t.message),i&&i(o)}else n(t)},error:function(e,t){if(bt(!1),i){var n="Server nicht erreichbar.";return 0!=e.status&&(n=""+e.status),void i(t+": "+n)}}})}function bt(e){e?jQuery(".jo_network-busy").css("visibility","visible"):jQuery(".jo_network-busy").css("visibility","hidden")}function kt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}yt.performanceData=[],yt.performanceDataCount=0,yt.lastTimeSent=performance.now();var wt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"fromDatabaseData",value:function(t,n){var i=new e;return i.id=t.id,i.name=t.name,i.statements=t.statements,i.published_to=t.published_to,i.version=n,i.description=t.description,i.templateDump=null,i.based_on_template_id=t.based_on_template_id,i.owner_id=t.owner_id,i}}],(n=null)&&kt(t.prototype,n),i&&kt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ct(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Tt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"fetchTemplateFromCache",value:function(e,t){if(null!=e){var n=this;this.cacheAvailable()||t(null),this.getCache((function(i){i.match(n.databaseIdToCacheIdentifier(e)).then((function(e){e.arrayBuffer().then((function(e){return t(new Uint8Array(e))}))})).catch((function(){return t(null)}))}))}else t(null)}},{key:"saveTemplateToCache",value:function(e,t){if(this.cacheAvailable()){var n=this;this.getCache((function(i){i.put(n.databaseIdToCacheIdentifier(e),new Response(t))}))}}},{key:"cacheAvailable",value:function(){return"caches"in self}},{key:"getCache",value:function(e){caches.open("my-cache").then(e)}},{key:"databaseIdToCacheIdentifier",value:function(e){return"/onlineIdeTemplateDb"+e}}])&&Ct(t.prototype,n),i&&Ct(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.networkManager=n,this.unsentMessages=[],this.connect()}var t,n,i;return t=e,(n=[{key:"connect",value:function(){var e=this;this.state="connecting",gt("getWebSocketToken",{},(function(t){var n=(window.location.protocol.startsWith("https")?"wss://":"ws://")+window.location.host+"/servlet/subscriptionwebsocket";e.connection=new WebSocket(n),e.connection.onerror=function(t){e.onError(t)},e.connection.onclose=function(t){e.onClose(t)},e.connection.onmessage=function(t){e.onMessage(t)},e.connection.onopen=function(n){var i={command:1,token:t.token};e.state="connected",e.sendIntern(JSON.stringify(i))},setTimeout((function(){"subscribed"!=e.state&&(e.networkManager.forcedUpdateEvery=1,e.networkManager.counterTillForcedUpdate=1)}),7e3)}))}},{key:"disconnect",value:function(){this.state="connected",this.sendIntern(JSON.stringify({command:2}))}},{key:"sendIntern",value:function(e){if("disconnected"!=this.state)try{this.connection.send(e)}catch(e){console.log(e)}}},{key:"onClose",value:function(e){this.state="disconnected"}},{key:"onMessage",value:function(e){var t=JSON.parse(e.data);if(null!=t.command)switch(t.command){case 1:this.state="subscribed";break;case 2:this.networkManager.sendUpdates((function(){}),!0);break;case 3:this.state="disconnected"}}},{key:"onError",value:function(e){console.log("Fehler beim Notifier-Websocket")}}])&&xt(t.prototype,n),i&&xt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function St(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Et(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Dt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.$updateTimerDiv=n,this.ownUpdateFrequencyInSeconds=20,this.teacherUpdateFrequencyInSeconds=5,this.updateFrequencyInSeconds=20,this.forcedUpdateEvery=4,this.counterTillForcedUpdate=2,this.secondsTillNextUpdate=this.updateFrequencyInSeconds,this.errorHappened=!1}var t,n,i;return t=e,(n=[{key:"initializeTimer",value:function(){var e=this,t=this;this.$updateTimerDiv.find("svg").attr("width",t.updateFrequencyInSeconds),null!=this.interval&&clearInterval(this.interval),this.interval=setInterval((function(){if(null!=t.main.user){if(t.secondsTillNextUpdate--,t.secondsTillNextUpdate<0){t.secondsTillNextUpdate=t.updateFrequencyInSeconds,e.counterTillForcedUpdate--;var n=0==e.counterTillForcedUpdate;n&&(e.counterTillForcedUpdate=e.forcedUpdateEvery),t.sendUpdates((function(){}),n)}var i=e.$updateTimerDiv.find(".jo_updateTimerRect");i.attr("width",t.secondsTillNextUpdate+"px"),t.errorHappened?(i.css("fill","#c00000"),e.$updateTimerDiv.attr("title","Fehler beim letzten Speichervorgang -> Werd's wieder versuchen")):(i.css("fill","#008000"),e.$updateTimerDiv.attr("title",t.secondsTillNextUpdate+" Sekunden bis zum nächsten Speichern"))}}),1e3)}},{key:"initializeNotifierClient",value:function(){this.notifierClient=new jt(this.main,this)}},{key:"sendUpdates",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=this.main.user){this.main.projectExplorer.writeEditorTextToFile(),this.main.user.settings;var i,r=[],o=[],a=St(this.main.workspaceList);try{for(a.s();!(i=a.n()).done;){var s=i.value;s.saved||(r.push(s.getWorkspaceData(!1)),s.saved=!0);var l,u=St(s.moduleStore.getModules(!1));try{for(u.s();!(l=u.n()).done;){var c=l.value;c.file.saved||(c.file.text=c.getProgramTextFromMonacoModel(),o.push(c.getFileData(s)),c.file.saved=!0)}}catch(e){u.e(e)}finally{u.f()}}}catch(e){a.e(e)}finally{a.f()}var d={workspacesWithoutFiles:r,files:o,owner_id:this.main.workspacesOwnerId,userId:this.main.user.id,language:1,currentWorkspaceId:null===(t=this.main.getCurrentWorkspace())||void 0===t?void 0:t.id,getModifiedWorkspaces:!1},h=this;if(r.length>0||o.length>0||n)gt("sendUpdates",d,(function(t){h.errorHappened=!t.success,h.errorHappened||(h.updateWorkspaces(d,t),null==e)||e()}),(function(){h.errorHappened=!0}));else if(null!=e)return void e()}}},{key:"sendCreateWorkspace",value:function(e,t,n){if(this.main.user.is_testuser)return e.id=Math.round(1e7*Math.random()),void n(null);gt("createOrDeleteFileOrWorkspace",{type:"create",entity:"workspace",data:e,owner_id:t,userId:this.main.user.id},(function(t){e.id=t.id,n(null)}),n)}},{key:"getDatabaseSettings",value:function(e,t){gt("getDatabaseSettings",{workspaceId:e},(function(e){t(e)}),(function(e){alert(e)}))}},{key:"setNewSecret",value:function(e,t,n){gt("setNewSecret",{workspaceId:e,secretKind:t},(function(e){n(e.secret)}),(function(e){alert(e)}))}},{key:"setNameAndPublishedTo",value:function(e,t,n,i,r){gt("setPublishedTo",{workspaceId:e,databaseName:t,publishedTo:n,description:i},(function(e){r()}),(function(e){alert(e)}))}},{key:"sendCreateFile",value:function(e,t,n,i){gt("createOrDeleteFileOrWorkspace",{type:"create",entity:"file",data:e.getFileData(t),owner_id:n,userId:this.main.user.id},(function(t){e.file.id=t.id,i(null)}),i)}},{key:"sendDuplicateWorkspace",value:function(e,t){gt("duplicateWorkspace",{workspace_id:e.id,language:1},(function(e){t(e.message,e.workspace)}),t)}},{key:"sendDistributeWorkspace",value:function(e,t,n,i){this.sendUpdates((function(){gt("distributeWorkspace",{workspace_id:e.id,class_id:null==t?void 0:t.id,student_ids:n,language:1},(function(e){i(e.message)}),i)}),!1)}},{key:"sendDeleteWorkspaceOrFile",value:function(e,t,n){gt("createOrDeleteFileOrWorkspace",{type:"delete",entity:e,id:t,userId:this.main.user.id},(function(e){e.success?n(null):n("Netzwerkfehler!")}),n)}},{key:"sendUpdateUserSettings",value:function(e){var t;gt("updateUserSettings",{settings:this.main.user.settings,userId:this.main.user.id,current_workspace_id:null===(t=this.main.getCurrentWorkspace())||void 0===t?void 0:t.id},(function(t){t.success?e(null):e("Netzwerkfehler!")}),e)}},{key:"getNewStatements",value:function(e,t){gt("getNewStatements",{workspaceId:e.id,version_before:e.database.version},(function(e){e.success&&t(e.newStatements,e.firstNewStatementIndex)}))}},{key:"AddDatabaseStatements",value:function(e,t,n){gt("addDatabaseStatements",{workspaceId:e.id,version_before:e.database.version,statements:t},(function(e){e.success&&n(e.statements_before,e.new_version)}))}},{key:"fetchDatabase",value:function(e,t){var n=this,i=new Tt;gt("getDatabase",{workspaceId:e.id},(function(r){r.success?(e.database=wt.fromDatabaseData(r.database,r.version),i.fetchTemplateFromCache(e.database.based_on_template_id,(function(r){if(null!=r)return e.database.templateDump=pako.inflate(r),void t(null);null!=e.database.based_on_template_id?n.fetchTemplate(e.id,(function(n){return null!=n?(i.saveTemplateToCache(e.database.based_on_template_id,n),e.database.templateDump=pako.inflate(n),void t(null)):void t("Konnte das Template nicht laden.")})):t(null)}))):t("Netzwerkfehler!")}))}},{key:"fetchTemplate",value:function(e,t){var n={workspaceId:e};$.ajax({type:"POST",async:!0,data:JSON.stringify(n),contentType:"application/json",url:"servlet/getTemplate",xhrFields:{responseType:"arraybuffer"},success:function(e){t(new Uint8Array(e))},error:function(e,n){alert("Konnte das Template nicht laden."),t(null)}})}},{key:"fetchTemplateList",value:function(e){gt("getTemplateList",{user_id:this.main.user.id},(function(t){t.success?e(t.templateList):e([])}),(function(t){alert(t),e([])}))}},{key:"updateWorkspaces",value:function(e,t){var n=this,i=new Map,r=[];e.files.forEach((function(e){return r.push(e.id)})),t.workspaces.workspaces.forEach((function(e){return i.set(e.id,e)}));var o,a=[],s=St(t.workspaces.workspaces);try{var l=function(){var e=o.value;0==n.main.workspaceList.filter((function(t){return t.id==e.id})).length&&(a.push(e.name),n.createNewWorkspaceFromWorkspaceData(e))};for(s.s();!(o=s.n()).done;)l()}catch(e){s.e(e)}finally{s.f()}var u,c=St(this.main.workspaceList);try{for(c.s();!(u=c.n()).done;){var d=u.value,h=i.get(d.id);null!=h&&function(){var e=new Map;h.files.forEach((function(t){return e.set(t.id,t)}));var t,i=new Map,o=St(d.moduleStore.getModules(!1));try{for(o.s();!(t=o.n()).done;){var a=t.value,s=a.file.id;i.set(s,a);var l=e.get(s);null==l?(n.main.projectExplorer.fileListPanel.removeElement(a),n.main.currentWorkspace.moduleStore.removeModule(a)):l.version>a.file.version&&((r.indexOf(s)<0||l.forceUpdate)&&(a.file.text=l.text,a.model.setValue(l.text),a.file.saved=!0,a.lastSavedVersionId=a.model.getAlternativeVersionId()),a.file.version=l.version)}}catch(e){o.e(e)}finally{o.f()}var u,c=St(h.files);try{for(c.s();!(u=c.n()).done;){var f=u.value;null==i.get(f.id)&&n.createFile(d,f)}}catch(e){c.e(e)}finally{c.f()}}()}}catch(e){c.e(e)}finally{c.f()}if(a.length>0){var f=a.length>1?"Folgende Workspaces hat Deine Lehrkraft Dir gesendet: ":"Folgenden Workspace hat Deine Lehrkraft Dir gesendet: ";f+=a.join(", "),alert(f)}this.main.projectExplorer.workspaceListPanel.sortElements(),this.main.projectExplorer.fileListPanel.sortElements()}},{key:"createNewWorkspaceFromWorkspaceData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.main.createNewWorkspace(e.name,e.owner_id);n.id=e.id,n.sql_history="",n.path=e.path,n.isFolder=e.isFolder,this.main.workspaceList.push(n);var i=e.path.split("/");1==i.length&&""==i[0]&&(i=[]);var r={name:e.name,externalElement:n,iconClass:"workspace",isFolder:e.isFolder,path:i};this.main.projectExplorer.workspaceListPanel.addElement(r,!0),n.panelElement=r;var o,a=St(e.files);try{for(a.s();!(o=a.n()).done;){var s=o.value;this.createFile(n,s)}}catch(e){a.e(e)}finally{a.f()}t&&(this.main.projectExplorer.workspaceListPanel.sortElements(),this.main.projectExplorer.fileListPanel.sortElements())}},{key:"createFile",value:function(e,t){var n=null;e==this.main.currentWorkspace&&(n={name:t.name,externalElement:null},this.main.projectExplorer.fileListPanel.addElement(n,!0));var i={id:t.id,name:t.name,dirty:!1,saved:!0,text:t.text,version:t.version,identical_to_repository_version:!0,workspace_id:e.id,panelElement:n},r=this.main.projectExplorer.getNewModule(i);null!=n&&(n.externalElement=r),e.moduleStore.putModule(r)}},{key:"rollback",value:function(e){var t=this.main.currentWorkspace;gt("rollback",{workspaceId:t.id,version:t.database.version},(function(n){n.success?e(null,t.database.version>n.new_version):(alert(n.message),e(n.message,!1))}),(function(t){alert(t),e(t,!1)}))}}])&&_t(t.prototype,n),i&&_t(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Pt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Lt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"uploadCurrentDatabase",value:function(e,t,n,i){var r=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};if(t.waitOverlay.show("Bitte warten, lade Vorlage auf den Server hoch ..."),e>=0){var a=t.getDatabaseTool();a.export((function(n){n=pako.deflate(n),r.uploadIntern(n,e,i,t,o)}),(function(e){alert("Fehler beim Exportieren der Datenbank: "+e),t.waitOverlay.hide()}))}else this.uploadIntern(n,-1,i,t,o)}},{key:"uploadIntern",value:function(e,t,n,i,r){return $.ajax({type:"POST",async:!0,contentType:"application/octet-stream",data:e,processData:!1,headers:{"x-workspaceid":""+t,"x-reason":n},url:"servlet/uploadTemplate",success:function(e){i.waitOverlay.hide(),r(e)},error:function(e,t){alert("message"),i.waitOverlay.hide()}}),e}}])&&Pt(t.prototype,n),i&&Pt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ot(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var It=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.workspace=n,this.init()}var t,n,i;return t=e,(n=[{key:"init",value:function(){var e=this;this.$dialog=jQuery("#dialog"),jQuery("#main").css("visibility","hidden"),this.$dialog.append(jQuery('<div class="jo_ds_heading">Datenbank-Einstellungen</div>\n            <div style="width: 100%; margin-left: 10px">\n                <div class="jo_ds_settings" style="margin-left: 0px">\n                <div class="jo_ds_settings_caption">Name der Datenbank:</div><div><input class="dialog-input jo_databasename" value="Neue Datenbank"></input></div>\n                </div>\n\n                <div class="jo_ds_settings_caption" style="margin-top: 20px">\n                Zugriffscodes für andere Benutzer:\n                </div>\n                                \n                <div>\n                    <table class="jo_ds_secret_table">\n                    <tr>\n                        <td>Nur Lesen:</td><td class="jo_ds_secret jo_ds_secret_read"></td><td id="copySecretTdread"></td><td><button class="jo_small_button jo_button_code_read">Neuen Code generieren</button></td>\n                    <tr>\n                        <td>Lesen und schreiben:</td><td class="jo_ds_secret jo_ds_secret_write"></td><td id="copySecretTdwrite"></td><td><button class="jo_small_button jo_button_code_write">Neuen Code generieren</button></td>\n                    </tr>\n                    <tr>\n                        <td>Lesen, schreiben und Struktur verändern:</td><td class="jo_ds_secret jo_ds_secret_ddl"></td><td id="copySecretTdddl"></td><td><button class="jo_small_button jo_button_code_ddl">Neuen Code generieren</button></td>\n                    </tr>\n                    </table>\n                </div>\n\n                <div class="jo_ds_settings_caption" style="margin-top: 20px">\n                Beschreibung:\n                </div>\n                <div>\n                <textarea class="jo_ds_settings_description" maxlength="5000"></textarea>\n                </div>\n\n                <div class="jo_ds_settings_caption" style="margin-top: 20px">\n                Datenbank freigeben als Vorlage für andere Benutzer:\n                </div>\n\n                <fieldset id="jo_ds_publishedTo">\n                    <input type="radio" id="b0" name="publishedFilter" value="0" checked="checked"><label for="b0">Keine Freigabe</label>\n                    <input type="radio" id="b1" name="publishedFilter" value="1"><label for="b1">Freigabe für meine Klasse(n)</label>\n                    <input type="radio" id="b2" name="publishedFilter" value="2" style="visibility: none"><label id="lb2" for="b2" style="visibility: none">Freigabe für meine Schule</label>\n                    <input type="radio" id="b3" name="publishedFilter" value="3" style="visibility: none"><label id="lb3" for="b3" style="visibility: none">Freigabe für alle Schulen</label>\n                </fieldset>\n\n                <div>\n                    <input type="checkbox" id="jo_upload_db" name="jo_upload_db">\n                    <label for="jo_upload_db">Aktuellen Zustand der Datenbank als Vorlage hochladen</label>\n                </div>\n            </div>\n\n\n             <div class="dialog-buttonRow jo_ds_buttonRow">\n                <button id="jo_ds_cancel_button">Abbrechen</button>\n                <button id="jo_ds_save_button">Speichern</button>\n             </div>\n            '));var t=this;this.$dialog.css("visibility","visible"),jQuery("#jo_ds_cancel_button").on("click",(function(){e.showMainWindow()})),jQuery("#jo_ds_save_button").on("click",(function(){e.saveNameAndPublishedTo()})),this.setValues(),["read","write","ddl"].forEach((function(e){jQuery(".jo_button_code_"+e).on("pointerdown",(function(){t.main.networkManager.setNewSecret(t.workspace.id,e,(function(t){jQuery(".jo_ds_secret_"+e).text(t)}))}));var n=jQuery('<button class="jo_small_button jo_copy_secret_button jo_active">Kopieren</button>');jQuery("#copySecretTd"+e).append(n),n.on("pointerdown",(function(){pt(jQuery(".jo_ds_secret_"+e).text())}))})),jQuery("#jo_ds_publishedTo>input").on("change",(function(e){$("#jo_upload_db").prop("checked",!jQuery("#b0")[0].checked)}))}},{key:"saveNameAndPublishedTo",value:function(){var e=this,t=0;jQuery("#jo_ds_publishedTo").find("input").each((function(e,n){var i=jQuery(n);n.checked&&(t=Number.parseInt(i.attr("value")))})),this.main.networkManager.setNameAndPublishedTo(this.workspace.id,jQuery(".jo_databasename").val(),t,jQuery(".jo_ds_settings_description").val(),(function(){$("#jo_upload_db").prop("checked")&&(new Lt).uploadCurrentDatabase(e.workspace.id,e.main,null,"publishDatabaseAsTemplate"),e.showMainWindow()}))}},{key:"setValues",value:function(){var e=this;jQuery(".jo_databasename").val(this.workspace.name),this.main.networkManager.getDatabaseSettings(this.workspace.id,(function(t){["read","write","ddl"].forEach((function(e){jQuery(".jo_ds_secret_"+e).text(t.secrets[e])})),e.main.user.is_admin&&(jQuery("#b3").css("visibility","visible"),jQuery("#lb3").css("visibility","visible")),e.main.user.is_schooladmin&&(jQuery("#b2").css("visibility","visible"),jQuery("#lb2").css("visibility","visible")),jQuery("#b"+t.publishedTo).prop("checked",!0),jQuery("#jo_upload_db").prop("checked",0!=t.publishedTo),jQuery(".jo_ds_settings_description").val(e.workspace.database.description)}))}},{key:"showMainWindow",value:function(){jQuery("#main").css("visibility","visible"),this.$dialog.css("visibility","hidden"),this.$dialog.empty()}}])&&Ot(t.prototype,n),i&&Ot(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function At(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Mt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Bt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Nt=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=n,this.saved=!0,this.name=t,this.owner_id=i,this.moduleStore=new nt(n),this.sql_history=""}var t,n,i;return t=e,i=[{key:"restoreFromData",value:function(t,n){var i=new e(t.name,n,t.owner_id);i.id=t.id,i.path=t.path,i.isFolder=t.isFolder,i.owner_id=t.owner_id,i.sql_history=t.sql_history,i.permissions=t.permissions,i.databaseId=t.database_id;var r,o=At(t.files);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=tt.restoreFromData(a,n);i.moduleStore.putModule(s),a.id==t.currentFileId&&(i.currentlyOpenModule=s)}}catch(e){o.e(e)}finally{o.f()}return i}}],(n=[{key:"getWorkspaceData",value:function(e){var t={name:this.name,id:this.id,owner_id:this.owner_id,currentFileId:null==this.currentlyOpenModule?null:this.currentlyOpenModule.file.id,files:[],sql_history:this.sql_history,path:"",isFolder:!1,permissions:this.permissions,database_id:this.databaseId};if(e){var n,i=At(this.moduleStore.getModules(!1));try{for(i.s();!(n=i.n()).done;){var r=n.value;t.files.push(r.getFileData(this))}}catch(e){i.e(e)}finally{i.f()}}return t}},{key:"renderSettingsButton",value:function(e){var t,n=null===(t=null==e?void 0:e.$htmlFirstLine)||void 0===t?void 0:t.find(".jo_additionalButtonSettings");if(null!=n){var i=jQuery('<div class="jo_settingsButton img_settings jo_button jo_active" title="Datenbank-Einstellungen..."></div>');n.append(i);var r=this;i.on("mousedown",(function(e){return e.stopPropagation()})),i.on("click",(function(e){e.stopPropagation(),new It(r.main,r)}))}}},{key:"hasErrors",value:function(){return this.moduleStore.hasErrors()}},{key:"getModuleByMonacoModel",value:function(e){var t,n=At(this.moduleStore.getModules(!1));try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.model==e)return i}}catch(e){n.e(e)}finally{n.f()}return null}}])&&Bt(t.prototype,n),i&&Bt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ft(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return $t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $t(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function $t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Rt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Qt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.triggerCharacters=[".","abcdefghijklmnopqrstuvwxyzäöüß_ABCDEFGHIJKLMNOPQRSTUVWXYZÄÖÜ"," ",",","("],this.keywordCompletionItems=new Map,this.first=!0,this.keywordToSnippetMap={"(":"(\n\t$0\n)",varchar:"varchar($1) $0",decimal:"decimal($1, $2) $0"},this.setupKeywordCompletionItems()}var t,n,i;return t=e,(n=[{key:"provideCompletionItems",value:function(e,t,n,i){var r=this,o=this.main.getCurrentWorkspace().getModuleByMonacoModel(e);return null==o||null==o.mainSymbolTable?null:new Promise((function(a,s){var l=r,u=function(){o.file.dirty?setTimeout((function(){u()}),100):a(l.provideCompletionItemsIntern(e,t,n,i))};u()}))}},{key:"provideCompletionItemsIntern",value:function(e,t,n,i){var r=this;setTimeout((function(){var e=r.main.getMonacoEditor()._contentWidgets["editor.widget.suggestWidget"].widget;r.first&&(e.toggleDetails(),r.first=!1)}),500);var o=this.main.getCurrentWorkspace().getModuleByMonacoModel(e);if(null==o||null==o.mainSymbolTable)return null;if(this.isStringLiteral(o,t))return null;var a=e.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:t.lineNumber,endColumn:t.column}),s=e.getValueInRange({startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:t.lineNumber+5,endColumn:1}),l=o.mainSymbolTable.findTableAtPosition(t.lineNumber,t.column),u=o.getCompletionHint(t.lineNumber,t.column);null==u&&(u={fromColumn:0,toColumn:0,fromLine:0,toLine:0,hintColumns:!1,hintTables:!1,hintKeywords:[]});var c=[];this.addKeywordCompletionItems(u,c);var d=a.match(/.*\s([\wöäüÖÄÜß]*)(\.)([\wöäüÖÄÜß]*)$/),h=s.match(/^([\wöäüÖÄÜß]*)/),f="";null!=h&&h.length>0&&(f=h[0]),null==d?this.addIdentifierCompletionItems(u,l,c):this.addDotCompletionItems(t,d,f,l,c);var m,p=e.getWordUntilPosition(t),v={startColumn:p.startColumn,startLineNumber:t.lineNumber,endColumn:p.endColumn,endLineNumber:t.lineNumber},y={startColumn:t.column,startLineNumber:t.lineNumber,endColumn:t.column,endLineNumber:t.lineNumber},g=Ft(c);try{for(g.s();!(m=g.n()).done;){var b=m.value;null==b.range&&(b.insertText.startsWith(",")?b.range=y:b.range=v)}}catch(e){g.e(e)}finally{g.f()}return null!=u.dontHint&&(c=c.filter((function(e){return u.dontHint.indexOf(e.insertText)<0}))),{suggestions:c}}},{key:"addDotCompletionItems",value:function(e,t,n,i,r){var o,a=t[3],s=t[1],l=(e.column,a.length,{startLineNumber:e.lineNumber,startColumn:e.column-a.length,endLineNumber:e.lineNumber,endColumn:e.column+n.length}),u=Ft(i.symbolList);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(null!=c.table){var d=c.table.identifier;if(null!=c.tableAlias&&(d=c.tableAlias),d.toLowerCase()==s){var h,f=Ft(c.table.columns);try{for(f.s();!(h=f.n()).done;){var m=h.value;r.push({label:m.identifier,detail:"Spalte "+m.identifier+" der Tabelle "+c.table.identifier,filterText:m.identifier,insertText:m.identifier,insertTextRules:monaco.languages.CompletionItemInsertTextRule.KeepWhitespace,kind:monaco.languages.CompletionItemKind.Field,range:l})}}catch(e){f.e(e)}finally{f.f()}}}}}catch(e){u.e(e)}finally{u.f()}}},{key:"addIdentifierCompletionItems",value:function(e,t,n){var i,r,o=null==e.praefix?"":e.praefix,a=null==e.suffix?"":e.suffix;if(e.hintTables||e.hintColumns){for(var s={},l=t,u={},c=[];null!=l;){var d,h=Ft(l.symbolList);try{for(h.s();!(d=h.n()).done;){var f=d.value;if(null!=f.column){var m=f.column.identifier;null==u[m]?(u[m]=[f],c.push(m)):u[m].push(f)}else if(null!=f.table&&e.hintTables&&!s[f.identifier]){var p=o+f.identifier+a;n.push({label:f.identifier,detail:"Tabelle "+f.table.identifier,filterText:f.identifier,insertText:p,insertTextRules:p.indexOf("$")>=0?monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet:monaco.languages.CompletionItemInsertTextRule.KeepWhitespace,kind:p.indexOf("$")>=0?monaco.languages.CompletionItemKind.Snippet:monaco.languages.CompletionItemKind.Class,range:void 0,sortText:"aa"+f.identifier}),s[f.identifier]=!0}}}catch(e){h.e(e)}finally{h.f()}l=l.parent}if(e.hintColumns){var v,y=Ft(c);try{for(y.s();!(v=y.n()).done;){var g,b=u[v.value],k=b.length>1&&null==e.hintColumnsOfTable,w=Ft(b);try{for(w.s();!(g=w.n()).done;){var C=g.value,T=C.identifier;if(k&&C.identifier==C.column.identifier.toLowerCase()&&(T=(null==C.tableAlias?C.column.table.identifier:C.tableAlias)+"."+T),null==e.hintColumnsOfTable||(null===(r=null===(i=C.column)||void 0===i?void 0:i.table)||void 0===r?void 0:r.identifier)==e.hintColumnsOfTable){var x=o+T+a;n.push({label:T,detail:"Die Spalte "+C.column.identifier+" der Tabelle "+C.column.table.identifier,filterText:T,insertText:x,insertTextRules:x.indexOf("$")>=0?monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet:monaco.languages.CompletionItemInsertTextRule.KeepWhitespace,kind:x.indexOf("$")>=0?monaco.languages.CompletionItemKind.Snippet:monaco.languages.CompletionItemKind.Field,range:void 0})}}}catch(e){w.e(e)}finally{w.f()}}}catch(e){y.e(e)}finally{y.f()}}}}},{key:"addKeywordCompletionItems",value:function(e,t){var n,i=null==e.praefix?"":e.praefix,r=null==e.suffix?"":e.suffix,o=Ft(e.hintKeywords);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=i+a+r,l=this.keywordToSnippetMap[a],u=this.keywordCompletionItems.get(a);if(null!=u)t.push(u);else if(null!=l){var c=l.replace("$0","").replace("$1","").replace("$2","").replace(/ /g,"").replace(/\n/g,"").replace(/\t/g,"");t.push({label:c,detail:"",filterText:a,insertText:l,insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,kind:monaco.languages.CompletionItemKind.Snippet,range:void 0})}else t.push({label:a,detail:"",filterText:a,insertText:a,insertTextRules:s.indexOf("$")>=0?monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet:monaco.languages.CompletionItemInsertTextRule.KeepWhitespace,kind:s.indexOf("$")>=0?monaco.languages.CompletionItemKind.Snippet:monaco.languages.CompletionItemKind.Keyword,range:void 0,sortText:"from"==a?"*":void 0})}}catch(e){o.e(e)}finally{o.f()}}},{key:"isStringLiteral",value:function(e,t){var n=e.tokenList;if(null==n||0==n.length)return!1;for(var i,o=0,a=n.length-1,s=1e3;;){if(i==(i=Math.round((a+o)/2)))return!1;if(0==--s)return!1;var l=n[i],u=l.position;if(u.line<t.lineNumber||u.line==t.lineNumber&&u.column+u.length<t.column)o=i;else{if(!(u.line>t.lineNumber||u.line==t.lineNumber&&u.column>t.column))return l.tt==r.stringConstant;a=i}}}},{key:"setupKeywordCompletionItems",value:function(){this.keywordCompletionItems.set("delete from",{label:"delete from <Tabelle> where <Bedingung>",detail:"Anweisung zum Löschen von Datensätzen",filterText:"delete from",insertText:"delete from ",command:{id:"editor.action.triggerSuggest",title:"123",arguments:[]},insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,kind:monaco.languages.CompletionItemKind.Snippet,range:void 0}),this.keywordCompletionItems.set("drop table",{label:"drop table <Tabelle>",detail:"Anweisung zum Löschen einer Tabelle",filterText:"drop table",insertText:"drop table ",command:{id:"editor.action.triggerSuggest",title:"123",arguments:[]},kind:monaco.languages.CompletionItemKind.Snippet,range:void 0}),this.keywordCompletionItems.set("alter",{label:"alter table <Tabelle> <rename to, rename column, add column, drop column>",detail:"Anweisung zum Ändern des Schemas (alter table <Tabelle> <rename to, rename column, add column, drop column>)",filterText:"alter",insertText:"alter table ",command:{id:"editor.action.triggerSuggest",title:"123",arguments:[]},kind:monaco.languages.CompletionItemKind.Snippet,range:void 0}),this.keywordCompletionItems.set("select",{label:"select <Spalten> from <Tabellen> where <Bedingung>",detail:"Select-Anweisung",filterText:"select",insertText:"select * from $1\nwhere $0\n",command:{id:"editor.action.triggerSuggest",title:"123",arguments:[]},insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,kind:monaco.languages.CompletionItemKind.Snippet,range:void 0}),this.keywordCompletionItems.set("create table",{label:"create table <Tabellenbezeichner> (<Spaltendefinitionen>)",detail:"Create table-Anweisung (Erstellt eine neue Tabelle)",filterText:"create",insertText:"create table $1 (\n\t$0\n);",command:{id:"editor.action.triggerSuggest",title:"123",arguments:[]},insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,kind:monaco.languages.CompletionItemKind.Snippet,range:void 0})}}])&&Rt(t.prototype,n),i&&Rt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Wt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function qt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ut=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.signatureHelpTriggerCharacters=["(",",",";","<",">","="],this.signatureHelpRetriggerCharacters=[]}var t,n,i;return t=e,(n=[{key:"provideSignatureHelp",value:function(e,t,n,i){var r=this,o=this;return new Promise((function(a,s){setTimeout((function(){r.main.compileIfDirty(),a(o.provideSignatureHelpLater(e,t,n,i))}),300)}))}},{key:"provideSignatureHelpLater",value:function(e,t,n,i){this.main.getMonacoEditor().getModel();var r=this.main.getCurrentWorkspace().getModuleByMonacoModel(e);if(null==r)return null;var o=r.methodCallPositions[t.lineNumber];if(null==o)return null;for(var a=null,s=-1,l=o.length-1;l>=0;l--){var u=o[l];u.identifierPosition.column+u.identifierPosition.length<t.column&&u.identifierPosition.column>s&&(null==u.rightBracketPosition||t.lineNumber<=u.rightBracketPosition.line&&t.column<=u.rightBracketPosition.column||t.lineNumber<u.rightBracketPosition.line)&&(a=u,s=u.identifierPosition.column)}return null==a?null:this.getSignatureHelp(a,t)}},{key:"getSignatureHelp",value:function(e,t){var n,i=0,r=Wt(e.commaPositions);try{for(r.s();!(n=r.n()).done;){var o=n.value;(o.line<t.lineNumber||o.line==t.lineNumber&&o.column<t.column)&&i++}}catch(e){r.e(e)}finally{r.f()}return Promise.resolve({value:{activeParameter:i,activeSignature:0,signatures:[]},dispose:function(){}})}}])&&qt(t.prototype,n),i&&qt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ht(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Vt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Gt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editor=t}var t,n,i;return t=e,(n=[{key:"provideHover",value:function(t,n,i){var r,o=this.editor.editor.getSelection();if(null==o||o.startLineNumber==o.endLineNumber&&o.startColumn==o.endColumn||!(o.startLineNumber<n.lineNumber||o.startLineNumber==n.lineNumber&&o.startColumn<=n.column)||!(o.endLineNumber>n.lineNumber||o.endLineNumber==n.lineNumber&&o.endColumn>=n.column)){var a=null===(r=this.editor.main.getCurrentWorkspace())||void 0===r?void 0:r.getModuleByMonacoModel(t);if(null==a)return null;var s,l=Ht(a.errors);try{for(l.s();!(s=l.n()).done;){var u,c=Ht(s.value);try{for(c.s();!(u=c.n()).done;){var d=u.value;if(d.position.line==n.lineNumber&&d.position.column<=n.column&&d.position.column+d.position.length>=n.column)return null}}catch(e){c.e(e)}finally{c.f()}}}catch(e){l.e(e)}finally{l.f()}if(null!=a.getElementAtPosition(n.lineNumber,n.column));else{var h=this.getWordUnderCursor(t,n),f=e.keywordDescriptions[h];if(null!=f)return{range:null,contents:[{value:f}]}}}}},{key:"getWordUnderCursor",value:function(e,t){for(var n=e.getValueLengthInRange({startColumn:0,startLineNumber:0,endLineNumber:t.lineNumber,endColumn:t.column}),i=e.getValue(),r="",o=n;o<i.length&&this.isInsideIdentifierOrArrayDescriptor(i.charAt(o));)o++;for(var a=n;a>0&&this.isInsideIdentifierOrArrayDescriptor(i.charAt(a-1));)a--;if(o-a>1)r=i.substring(a,o);else{for(o=n;o<i.length&&this.isInsideOperator(i.charAt(o));)o++;for(a=n;a>0&&this.isInsideOperator(i.charAt(a-1));)a--;o-a>0&&(r=i.substring(a,o))}return r}},{key:"widenDeclaration",value:function(e,t,n){for(var i=e.getValueLengthInRange({startColumn:0,startLineNumber:0,endLineNumber:t.lineNumber,endColumn:t.column}),r=e.getValue(),o=i;o<r.length&&this.isInsideIdentifierOrArrayDescriptor(r.charAt(o));)o++;for(var a=i;a>0&&this.isInsideIdentifierChain(r.charAt(a-1));)a--;return null==(null==n?void 0:n.length)||n.length,o-a>length?r.substring(a,o):n}},{key:"isInsideIdentifierChain",value:function(e){return e.toLocaleLowerCase().match(/[a-z0-9äöüß_\[\]\.]/i)}},{key:"isInsideOperator",value:function(e){return e.toLocaleLowerCase().match(/[!%<>=\+\-\*\/]/i)}},{key:"isInsideIdentifierOrArrayDescriptor",value:function(e){return e.toLocaleLowerCase().match(/[a-z0-9äöüß\[\]]/i)}}])&&Vt(t.prototype,n),i&&Vt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Jt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Gt.keywordDescriptions={print:"Die Anweisung ```print``` gibt eine Zeichenkette aus.",new:'Das Schlüsselwort ```new``` bewirkt die Instanzierung ("Erschaffung") eines neuen Objektes einer Klasse.',println:"Die Anweisung ```println``` gibt eine Zeichenkette gefolgt von einem Zeilenumbruch aus.",while:"```\nwhile (Bedingung) {Anweisungen}\n```  \nbewirkt die Wiederholung der Anweisungen solange ```Bedingung == true``` ist.",for:"```\nfor(Startanweisung;Solange-Bedingung;Nach_jeder_Wiederholung){Anweisungen}\n```  \nführt zunächst die Startanweisung aus und wiederholt dann die Anweisungen solange ```Bedingung == true``` ist. Am Ende jeder wiederholung wird Nach_jeder_Wiederholung ausgeführt.",if:"```\nif(Bedingung){Anweisungen_1} else {Anweisungen_2}\n```  \nwertet die Bedingung aus und führt Anweisungen_1 nur dann aus, wenn die Bedingung ```true``` ergibt, Anweisungen_2 nur dann, wenn die Bedingung ```false``` ergibt.  \nDer ```else```-Teil kann auch weggelassen werden.",else:"```\nif(Bedingung){Anweisungen_1} else {Anweisungen_2}\n```  \nwertet die Bedingung aus und führt Anweisungen_1 nur dann aus, wenn die Bedingung ```true``` ergibt, Anweisungen_2 nur dann, wenn die Bedingung ```false``` ergibt.",switch:"```\nswitch(Selektor){ case Wert_1: Anweisungen_1; break; case Wert_2: Anweisungen_2; break; default: Default-Anweisungen } \n```  \nwertet den Selektor-Term aus und führt abhängig vom Termwert Anweisungen_1, Anweisungen_2, ... aus. Entspricht der Termwert keinem der Werte Wert_1, Wert_2, ..., so werden die Default-Anweisungen ausgeführt.","%":"```\na % b\n```  \n (sprich: 'a modulo b') berechnet den **Rest** der ganzzahligen Division a/b.","==":"```\na == b\n```  \nergibt genau dann ```true```, wenn ```a``` und ```b``` gleich sind.  \nSind a und b **Objekte**, so ergibt ```a == b``` nur dann ```true```, wenn ```a``` und ```b``` auf das **identische** Objekt zeigen.  \n```==``` nennt man **Vergleichsoperator**.","<=":"```\na <= b\n```  \nergibt genau dann ```true```, wenn der Wert von ```a``` kleiner oder gleich dem Wert von ```b``` ist.",">=":"```\na <= b\n```  \nergibt genau dann ```true```, wenn der Wert von ```a``` größer oder gleich dem Wert von ```b``` ist.","!=":"```\na != b\n```  \nergibt genau dann ```true```, wenn ```a``` und ```b``` **un**gleich sind.  \nSind ```a``` und ```b``` **Objekte**, so ergibt ```a != b``` dann ```true```, wenn ```a``` und ```b``` **nicht** auf das **identische** Objekt zeigen.  \n```!=``` nennt man **Ungleich-Operator**.","+=":"```\na += b\n(Kurzschreibweise für a = a + b)\n```  \nbewirkt, dass der Wert von ```a``` um den Wert von ```b``` **erhöht** wird. Das Ergebnis wird in die Variable ```a``` geschrieben.","-=":"```\na -= b\n(Kurzschreibweise für a = a - b)\n```  \nbewirkt, dass der Wert von ```a``` um den Wert von ```b``` **erniedrigt** wird. Das Ergebnis wird in die Variable ```a``` geschrieben.","*=":"```\na *= b\n(Kurzschreibweise für a = a * b)\n```  \nbewirkt, dass der Wert von ```a``` mit dem Wert von ```b``` **multipliziert** wird. Das Ergebnis wird in die Variable ```a``` geschrieben.","/=":"```\na /= b\n(Kurzschreibweise für a = a / b)\n```  \nbewirkt, dass der Wert von ```a``` durch den Wert von ```b``` **dividiert** wird. Das Ergebnis wird in die Variable ```a``` geschrieben.","++":"```\na++\n(Kurzschreibweise für a = a + 1)\n```  \nbewirkt, dass der Wert von ```a``` um eins erhöht wird.","--":"```\na--\n(Kurzschreibweise für a = a - 1)\n```  \nbewirkt, dass der Wert von ```a``` um eins eniedrigt wird.","=":"```\na = Term\n```  \nberechnet den Wert des Terms und weist ihn der Variablen ```a``` zu.  \n**Vorsicht:**  \nVerwechsle ```=```(**Zuweisungsoperator**) nicht mit ```==```(**Vergleichsoperator**)!","!":"```\n!a\n```  \nergibt genau dann ```true```, wenn ```a``` ```false``` ergibt.  \n```!``` spricht man '**nicht**'.",public:"```\npublic\n```  \nAttribute und Methoden, die als ```public``` deklariert werden, sind überall (auch außerhalb der Klasse) sichtbar.",private:"```\nprivate\n```  \nAttribute und Methoden, die als ```private``` deklariert werden, sind nur innerhalb von Methoden derselben Klasse sichtbar.",protected:"```\nprotected\n```  \nAttribute und Methoden, die als ```protected``` deklariert werden, sind nur innerhalb von Methoden derselben Klasse oder innerhalb von Methoden von Kindklassen sichtbar.",return:"```\nreturn Term\n```  \nbewirkt, dass die Methode verlassen wird und der Wert des Terms an die aufrufende Stelle zurückgegeben wird.",break:"```\nbreak;\n```  \ninnerhalb einer Schleife bewirkt, dass die Schleife sofort verlassen und mit den Anweisungen nach der Schleife fortgefahren wird.  \n```break``` innerhalb einer ```switch```-Anweisung bewirkt, dass der Block der ```switch```-Anweisung verlassen wird.",class:"```\nclass\n```  \nMit dem Schlüsselwort ```class``` werden Klassen definiert.",extends:"```\nextends\n```  \n```class A extends B { ... }``` bedeutet, dass die Klasse A Unterklasse der Klasse B ist.",implements:"```\nimplements\n```  \n```class A implements B { ... }``` bedeutet, dass die Klasse A das Interface B implementiert, d.h., dass sie alle Methoden besitzen muss, die in B definiert sind.",this:"```\nthis\n```  \nInnerhalb einer Methodendefinition bezeichnet das Schlüsselwor ```this``` immer dasjenige Objekt, für das die Methode gerade ausgeführt wird."};var Yt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t}var t,n,i;return t=e,(n=[{key:"provideCodeActions",value:function(e,t,n,i){return{actions:n.markers.map((function(t){var n=t.relatedInformation;return null==n?null:{title:n.title,diagnostics:[t],kind:"quickfix",edit:{edits:n.editsProvider(e.uri)},isPreferred:!0}})),dispose:function(){}}}}])&&Jt(t.prototype,n),i&&Jt(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Xt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function en(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var tn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t}var t,n,i;return t=e,(n=[{key:"provideReferences",value:function(e,t,n,i){var r=this.main.getCurrentWorkspace().getModuleByMonacoModel(e);if(null==r)return null;var o=r.getElementAtPosition(t.lineNumber,t.column);if(null!=o){var a=o.usagePositions,s=[];return a.forEach((function(e,t){if(null!=e){var n,i=Xt(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;s.push({uri:t.uri,range:{startColumn:r.column,startLineNumber:r.line,endLineNumber:r.line,endColumn:r.column+r.length}})}}catch(e){i.e(e)}finally{i.f()}}})),s}}}])&&en(t.prototype,n),i&&en(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function nn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var rn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"openHelper",value:function(t,n,i){var r=jQuery(".jo_arrow_box");r.removeClass(["jo_arrow_box_left","jo_arrow_box_right","jo_arrow_box_top","jo_arrow_box_bottom"]),r.addClass("jo_arrow_box_"+i),r.css({left:"",right:"",top:"",bottom:""});var o=n.offset(),a=jQuery("body");switch(i){case"bottom":r.css({left:o.left+n.width()/2-34,bottom:a.height()-o.top+34});break;case"top":r.css({left:o.left+n.width()/2-34,top:o.top+n.height()+26});break;case"left":r.css({left:o.left+n.width()+34,top:o.top+n.height()/2-34});break;case"right":r.css({right:a.width()-o.left,top:o.top+n.height()/2-34})}r.find("span").html(t);var s=r.find(".jo_button");s.on("click",(function(t){t.stopPropagation(),s.off("click"),e.close()})),r.fadeIn(800)}},{key:"close",value:function(){jQuery(".jo_arrow_box").fadeOut(800)}},{key:"showHelper",value:function(t,n,i){var r;if(n instanceof Ii){var o=(r=n).user.settings.helperHistory,a=t+"Done";if(null!=o&&(null==o[a]||!o[a])){o[a]=!0,r.networkManager.sendUpdateUserSettings((function(){}));var s="",l="left";switch(t){case"newDatabaseHelper":s="Es gibt noch keine Datenbank. <br> Nutzen Sie den Button\n                        <span class='img_add-database-dark jo_inline-image'></span> um eine Datenbank anzulegen.\n                        ",l="left";break;case"newSQLFileHelper":s="Es gibt noch keine Datei mit SQL-Anweisungen. <br> Nutzen Sie den Button \n                            <span class='img_add-file-dark jo_inline-image'></span> um eine neue Datei anzulegen.\n                            ",l="left";break;case"homeButtonHelper":s="Mit dem Home-Button <span class='img_home-dark jo_inline-image'></span> können Sie wieder zu Ihren eigenen Workspaces wechseln.",l="top",i=jQuery(".img_home-dark");break;case"playButtonHelper":s="Mit dem \"Start-Button\"\n                        (<span class='img_start-dark jo_inline-image'></span>) \n                        oder der Tastenkombination &lt;Strg&gt;&nbsp;+&nbsp&lt;Enter&gt; \n                        wird die Anweisung ausgeführt, in der der Cursor gerade steht. \n                        <br> Wollen Sie mehrere Anweisungen hintereinander ausführen, so markieren \n                        Sie alle Anweisungen und klicken Sie dann auf <span class='img_start-dark jo_inline-image'></span>\n                        oder drücken Sie  &lt;Strg&gt;&nbsp;+&nbsp&lt;Enter&gt;. ",l="top";break;case"consoleHelper":s="\n                        Hier können Sie Anweisungen oder Terme eingeben, die nach Bestätigung mit der Enter-Taste ausgeführt/ausgewertet werden. Das Ergebnis sehen Sie im Bereich über der Eingabezeile. <br>\n                        Falls das Programm gerade pausiert (z.B. bei Ausführung in Einzelschritten) können Sie auch auf die Variablen des aktuellen Sichtbarkeitsbereiches zugreifen.\n                    ",l="bottom"}""!=s&&null!=i&&i.length>0&&e.openHelper(s,i,l)}}}}],(n=null)&&nn(t.prototype,n),i&&nn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function on(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return an(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return an(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function an(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function sn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ln=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.showMinimap=n,this.isEmbedded=i,this.cw=null,this.dontPushNextCursorMove=0,this.lastTime=0,this.elementDecoration=[]}var t,n,i;return t=e,(n=[{key:"initGUI",value:function(e){var t=this;!function(){monaco.languages.register({id:"vscSQL",extensions:[".sql"]});var e={onEnterRules:[{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:monaco.languages.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:monaco.languages.IndentAction.None,appendText:" * "}},{beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:monaco.languages.IndentAction.None,appendText:"* "}},{beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/,action:{indentAction:monaco.languages.IndentAction.None,removeText:1}},{beforeText:/^(\t|(\ \ ))*\ \*[^/]*\*\/\s*$/,action:{indentAction:monaco.languages.IndentAction.None,removeText:1}}],comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]};monaco.languages.setLanguageConfiguration("vscSQL",e),monaco.languages.setMonarchTokensProvider("vscSQL",{defaultToken:"",tokenPostfix:".sql",ignoreCase:!0,brackets:[{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"}],escapes:/\\(?:[abfnrtv\\"'])/,keywords:["ABORT","ACTION","ADD","AFTER","ALL","ALTER","ANALYZE","AND","AS","ASC","ATTACH","AUTOINCREMENT","BEFORE","BEGIN","BETWEEN","BY","CASCADE","CASE","CAST","CHECK","COLLATE","COLUMN","COMMIT","CONFLICT","CONSTRAINT","CREATE","CROSS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATABASE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DETACH","DISTINCT","DROP","EACH","ELSE","END","ESCAPE","EXCEPT","EXCLUSIVE","EXISTS","EXPLAIN","FAIL","FOR","FOREIGN","FROM","FULL","GLOB","GROUP","HAVING","IF","IGNORE","IMMEDIATE","IN","INDEX","INDEXED","INITIALLY","INNER","INSERT","INSTEAD","INTERSECT","INTO","IS","ISNULL","JOIN","KEY","LEFT","LIKE","LIMIT","MATCH","NATURAL","NO","NOT","NOTNULL","NULL","OF","OFFSET","ON","OR","ORDER","OUTER","PLAN","PRAGMA","PRIMARY","QUERY","RAISE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELEASE","RENAME","REPLACE","RESTRICT","RIGHT","ROLLBACK","ROW","SAVEPOINT","SELECT","SET","TABLE","TEMP","TEMPORARY","THEN","TO","TRANSACTION","TRIGGER","UNION","UNIQUE","UPDATE","USING","VACUUM","VALUES","VIEW","VIRTUAL","WHEN","WHERE","WITH","WITHOUT","ENGINE","CHARSET"],operators:["AND","BETWEEN","IN","LIKE","NOT","OR","IS","NULL","INTERSECT","UNION","INNER","JOIN","LEFT","OUTER","RIGHT"],builtinFunctions:["abs","changes","char","coalesce","count","glob","hex","ifnull","iif","instr","last_insert_rowid","length","like","likelihood","likely","lower","ltrim","max","min","nullif","quote","random","randomblob","replace","round","rtrim","sign","soundex","sqlite_version","substr","substring","total_changes","trim","typeof","unicode","unlikely","upper","zeroblob"],builtinVariables:[],pseudoColumns:[],tokenizer:{root:[{include:"@comments"},{include:"@whitespace"},{include:"@pseudoColumns"},{include:"@numbers"},{include:"@strings"},{include:"@complexIdentifiers"},{include:"@scopes"},[/[;,.]/,"delimiter"],[/[()]/,"@brackets"],[/[a-z_$äöü][\w$äöüßÄÖÜ]*(?=\()/,{cases:{"@builtinFunctions":"functions","@keywords":"keyword","@default":"identifier"}}],[/[\w@#$]+/,{cases:{"@keywords":"keyword","@operators":"operator","@builtinVariables":"predefined","@default":"identifier"}}],[/[<>=!%&+\-*/|~^]/,"operator"]],whitespace:[[/\s+/,"white"]],comments:[[/--+.*/,"comment"],[/\/\*/,{token:"comment.quote",next:"@comment"}]],comment:[[/[^*/]+/,"comment"],[/\*\//,{token:"comment.quote",next:"@pop"}],[/./,"comment"]],pseudoColumns:[[/[$][A-Za-z_][\w@#$]*/,{cases:{"@pseudoColumns":"predefined","@default":"identifier"}}]],numbers:[[/0[xX][0-9a-fA-F]*/,"number"],[/[$][+-]*\d*(\.\d*)?/,"number"],[/((\d+(\.\d*)?)|(\.\d+))([eE][\-+]?\d+)?/,"number"]],strings:[[/'/,{token:"string",next:"@string"}]],string:[[/[^\\']+/,"string"],[/\\./,"string.escape.invalid"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],complexIdentifiers:[[/"/,{token:"identifier.quote",next:"@quotedIdentifier"}]],quotedIdentifier:[[/[^"]+/,"identifier"],[/""/,"identifier"],[/"/,{token:"identifier.quote",next:"@pop"}]],scopes:[]}})}(),monaco.editor.defineTheme("myCustomThemeDark",{base:"vs-dark",inherit:!0,rules:[{token:"functions",foreground:"dcdcaa",fontStyle:"italic"},{token:"string.sql",foreground:"3DC9B0"},{token:"number",foreground:"7bef3f"},{token:"type",foreground:"499cd6"},{token:"identifier",foreground:"effefe"},{token:"statement",foreground:"9cdcfe",fontStyle:"bold"},{token:"keyword",foreground:"619ceb",fontStyle:"bold"},{token:"table",foreground:"ff0000",fontStyle:"bold"},{token:"delimiter",foreground:"e8eb38"}],colors:{"editor.background":"#1e1e1e",jo_highlightStatementGreen:"#004000",jo_highlightStatementYellow:"#404000",jo_highlightStatementRed:"#402020"}}),monaco.editor.defineTheme("myCustomThemeLight",{base:"vs",inherit:!0,rules:[{token:"functions",foreground:"694E16",fontStyle:"italic bold"},{token:"string.sql",foreground:"a03030"},{token:"number",foreground:"404040"},{token:"type",foreground:"0000ff",fontStyle:"bold"},{token:"identifier",foreground:"8000e0"},{token:"statement",foreground:"001080",fontStyle:"bold"},{token:"keyword",foreground:"00a000",fontStyle:"bold"},{token:"comment",foreground:"808080",fontStyle:"italic"}],colors:{"editor.background":"#FFFFFF","editor.foreground":"#000000","editor.inactiveSelectionBackground":"#E5EBF1","editorIndentGuide.background":"#D3D3D3","editorIndentGuide.activeBackground":"#939393","editor.selectionHighlightBackground":"#ADD6FF80","editorSuggestWidget.background":"#F3F3F3","activityBarBadge.background":"#007ACC","sideBarTitle.foreground":"#6F6F6F","list.hoverBackground":"#E8E8E8","input.placeholderForeground":"#767676","searchEditor.textInputBorder":"#CECECE","settings.textInputBorder":"#CECECE","settings.numberInputBorder":"#CECECE","statusBarItem.remoteForeground":"#FFF","statusBarItem.remoteBackground":"#16825D",jo_highlightStatementGreen:"#004000",jo_highlightStatementYellow:"#404000",jo_highlightStatementRed:"#400000"}}),this.editor=monaco.editor.create(e[0],{language:"vscSQL",lightbulb:{enabled:!0},lineDecorationsWidth:0,peekWidgetDefaultFocus:"tree",fixedOverflowWidgets:!0,quickSuggestions:!0,quickSuggestionsDelay:10,fontSize:14,fontFamily:"Consolas, Roboto Mono",fontWeight:"500",roundedSelection:!0,selectOnLineNumbers:!1,automaticLayout:!0,scrollBeyondLastLine:!1,occurrencesHighlight:!1,autoIndent:"full",dragAndDrop:!0,formatOnType:!0,formatOnPaste:!0,suggestFontSize:16,suggestLineHeight:22,suggest:{localityBonus:!0,insertMode:"replace"},parameterHints:{enabled:!0,cycle:!0},mouseWheelZoom:this.isEmbedded,minimap:{enabled:this.showMinimap},scrollbar:{vertical:"auto",horizontal:"auto"},theme:"myCustomThemeDark"});var n=this,i=function(e){!0===e.ctrlKey&&(n.changeEditorFontSize(Math.sign(e.deltaY),!0),e.preventDefault())};return this.editor.onDidChangeConfiguration((function(e){e.hasChanged(monaco.editor.EditorOption.fontInfo)&&t.isEmbedded&&t.main.getBottomDiv().errorManager.registerLightbulbOnClickFunctions()})),this.editor.onDidChangeCursorPosition((function(e){n.onDidChangeCursorPosition(e.position)})),this.editor.onDidChangeModel((function(n){var r=e.find(".monaco-editor")[0];if(r.removeEventListener("wheel",i),r.addEventListener("wheel",i,{passive:!1}),null!=t.main.getCurrentWorkspace()){var o=t.main.getCurrentWorkspace().getModuleByMonacoModel(t.editor.getModel());t.main instanceof Ii&&null!=o&&t.main.projectExplorer.setActiveAfterExternalModelSet(o)}})),monaco.languages.registerHoverProvider("vscSQL",new Gt(this)),monaco.languages.registerCompletionItemProvider("vscSQL",new Qt(this.main)),monaco.languages.registerCodeActionProvider("vscSQL",new Yt(this.main)),monaco.languages.registerReferenceProvider("vscSQL",new tn(this.main)),monaco.languages.registerSignatureHelpProvider("vscSQL",new Ut(this.main)),this.editor.onMouseDown((function(e){var t=e.target.detail;e.target.type!==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN&&e.target.type!==monaco.editor.MouseTargetType.GUTTER_LINE_NUMBERS||t.isAfterLines||n.onMarginMouseDown(e.target.position.lineNumber)})),setTimeout((function(){monaco.editor.remeasureFonts()}),2e3),this.addActions(),this.editor.onDidType((function(e){n.onDidType(e)})),this.editor}},{key:"onDidType",value:function(e){var t=this,n=function(e,n,i,r){var o=new monaco.Range(e.lineNumber,e.column,e.lineNumber,e.column);t.editor.executeEdits("new-bullets",[{range:o,text:n}]),t.editor.setPosition({lineNumber:i,column:r})};if("\n"===e){var i=this.editor.getModel(),r=this.editor.getPosition(),o=i.getLineContent(r.lineNumber-1);if(0===o.trim().indexOf("/*")&&!o.trimRight().endsWith("*/")&&!(r.lineNumber<i.getLineCount()?i.getLineContent(r.lineNumber+1):"").trim().startsWith("*")){var a=o.substr(0,o.length-o.trimLeft().length);0===o.trim().indexOf("/**")?n(r,"\n"+a+" */",r.lineNumber,r.column+3+a.length):n(r," * \n"+a+" */",r.lineNumber,r.column+3+a.length)}}}},{key:"setFontSize",value:function(e){var t=(new Date).getTime();if(!(t-this.lastTime<150)){this.lastTime=t;var n=this.editor.getOptions().get(monaco.editor.EditorOption.fontSize);if(this.main instanceof Ii&&this.main.viewModeController.saveFontSize(e),e!=n){this.editor.updateOptions({fontSize:e});var i=this.editor.getOptions().get(monaco.editor.EditorOption.fontSize)/e;this.editor.updateOptions({fontSize:e/i})}jQuery(".jo_editorFontSize").css("font-size",e+"px"),jQuery(".jo_editorFontSize").css("line-height",e+2+"px"),document.documentElement.style.setProperty("--breakpoint-size",e+"px"),document.documentElement.style.setProperty("--breakpoint-radius",e/2+"px"),this.main.getBottomDiv().errorManager.registerLightbulbOnClickFunctions()}}},{key:"changeEditorFontSize",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.editor.getOptions().get(monaco.editor.EditorOption.fontSize);t&&(e*=n<10?1:n<20?2:4);var i=n+e;i>=6&&i<=80&&this.setFontSize(i)}},{key:"addActions",value:function(){var e=this;this.editor.addAction({id:"Find bracket",label:"Finde korrespondierende Klammer",keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_K],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){return e.getAction("editor.action.jumpToBracket").run(),null}}),this.editor.addAction({id:"Execute statement",label:"SQL-Anweisung ausführen",keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.Enter],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1,run:function(t){return e.main.getActionManager().trigger("execute"),null}})}},{key:"onMarginMouseDown",value:function(e){}},{key:"onDidChangeCursorPosition",value:function(e){null==e&&(e=this.editor.getPosition());var t=this.getCurrentlyEditedModule();if(null!=t){var n=t.getElementAtPosition(e.lineNumber,e.column),i=[];if(null!=n){var r=n.usagePositions.get(t);if(null!=r){var o,a=on(r);try{for(a.s();!(o=a.n()).done;){var s=o.value;i.push({range:{startColumn:s.column,startLineNumber:s.line,endColumn:s.column+s.length,endLineNumber:s.line},options:{className:"jo_revealSyntaxElement",isWholeLine:!1,overviewRuler:{color:{id:"editorIndentGuide.background"},darkColor:{id:"editorIndentGuide.activeBackground"},position:monaco.editor.OverviewRulerLane.Left}}})}}catch(e){a.e(e)}finally{a.f()}}}var l,u=!1,c=on(t.getSQLSTatementsAtSelection(this.editor.getSelection()));try{for(c.s();!(l=c.n()).done;){var d=l.value,h="jo_highlightStatementGreen";null!=d&&(d.hasErrors?(h="jo_highlightStatementRed",d.acceptedBySQLite&&(h="jo_highlightStatementYellow",u=!0)):u=!0,i.push({range:{startColumn:d.from.column,startLineNumber:d.from.line,endColumn:d.to.column,endLineNumber:d.to.line},options:{className:h,isWholeLine:!1,overviewRuler:{color:{id:h},darkColor:{id:h},position:monaco.editor.OverviewRulerLane.Left},minimap:{color:{id:h},position:monaco.editor.MinimapPosition.Inline},zIndex:-100}}))}}catch(e){c.e(e)}finally{c.f()}this.main.getActionManager().setActive("execute",u),u&&!this.main.isEmbedded()&&rn.showHelper("playButtonHelper",this.main,jQuery("div.img_start-dark")),this.elementDecoration=this.editor.deltaDecorations(this.elementDecoration,i)}else this.elementDecoration=this.editor.deltaDecorations(this.elementDecoration,[])}},{key:"getCurrentlyEditedModule",value:function(){return this.main.getCurrentlyEditedModule()}}])&&sn(t.prototype,n),i&&sn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function un(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var cn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initsql=initSqlJs({locateFile:function(e,t){return"https://embed.learn-sql.de/include/lib/sql.js/sql-wasm.wasm"}})}var t,n,i;return t=e,(n=[{key:"postMessageToClient",value:function(e){this.onmessage({data:e})}},{key:"postMessage",value:function(e){var t=this,n=this;null==n.db?n.initsql.then((function(t){n.SQL=t,n.db=createDb(t,void 0),n.worker(e)})).catch((function(e){return console.log(e),n.postMessageToClient({id:t.data.id,error:e.message})})):n.worker(e)}},{key:"terminate",value:function(){}},{key:"worker",value:function(e){var t,n,i=e.config?e.config:{};try{switch(e&&e.action){case"open":return t=e.buffer,this.db=createDb(this.SQL,t&&new Uint8Array(t)),this.postMessageToClient({id:e.id,ready:!0});case"exec":if(null===this.db&&(this.db=createDb(this.SQL,void 0)),!e.sql)throw"exec: Missing query string";return this.postMessageToClient({id:e.id,results:this.db.exec(e.sql,e.params,i)});case"each":return null===this.db&&(this.db=createDb(this.SQL,void 0)),this.db.each(e.sql,e.params,(function(t){return this.postMessage({id:e.id,row:t,finished:!1})}),(function(){return this.postMessage({id:e.id,finished:!0})}),i);case"export":t=this.db.export(),n={id:e.id,results:[{buffer:t}]};try{return this.postMessageToClient(n)}catch(e){return this.postMessageToClient(n)}case"close":return this.db&&this.db.close(),this.postMessageToClient({id:e.id});default:throw new Error("Invalid action : "+(e&&e.action))}}catch(t){return this.postMessageToClient({id:e.id,error:t.message})}}}])&&un(t.prototype,n),i&&un(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function dn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return hn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function fn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var mn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.databaseDirectoryEntries=null,this.queryId=0,this.querySuccessCallbacksMap=new Map,this.queryErrorCallbackMap=new Map}var t,n,i;return t=e,i=[{key:"getDumpType",value:function(e){for(var t=[83,81,76,105,116,101],n=!0,i=0;i<t.length;i++)if(t[i]!=e[i]){n=!1;break}return n?"binaryUncompressed":120==e[0]?"binaryCompressed":"other"}}],(n=[{key:"initializeWorker",value:function(e,t,n,i){var r=this;this.main.getWaitOverlay().show("Bitte warten, die Datenbank wird initialisiert..."),null!=this.worker&&this.worker.terminate(),performance.now();var o="js/sqljs-worker/sqljsWorker.js";this.main.isEmbedded()&&(o=window.javaOnlineDir+o),window.jo_doc?this.worker=new cn:this.worker=new Worker(o);var a=this,s=[];this.worker.onmessage=function(){a.worker.onmessage=function(e){var t=e.data.id;if(null==e.data.error){var n=a.querySuccessCallbacksMap.get(t);null!=n&&n(e.data.results)}else{var i=a.queryErrorCallbackMap.get(t);null!=i&&i(e.data.error)}r.queryErrorCallbackMap.delete(t),r.querySuccessCallbacksMap.delete(t)},null==t&&(t=[]);var e=(t=t.slice()).length;!function o(){if(t.length>0){r.main.getWaitOverlay().setProgress("".concat(Math.round(100*(1-t.length/e))+" %"));var l=t.shift();a.executeQuery(l,(function(e){o()}),(function(e){s.push("Error while setting up database: "+e+", query: "+l),console.log({error:"Error while setting up database: "+e,query:l}),console.log(),o()}))}else null!=n&&n(s),a.retrieveDatabaseStructure((function(){i&&i(),r.main.getWaitOverlay().hide()}))}()},this.worker.onerror=function(e){s.push("Worker error: "+e.error),console.log("Worker error: "+e.error)},this.worker.postMessage({id:a.queryId++,action:"open",buffer:e})}},{key:"executeQuery",value:function(e,t,n){var i=this.queryId++;this.querySuccessCallbacksMap.set(i,t),this.queryErrorCallbackMap.set(i,n),this.worker.postMessage({id:i,action:"exec",sql:e,params:{}})}},{key:"export",value:function(e,t){var n=this.queryId++;this.querySuccessCallbacksMap.set(n,(function(t){e(t[0].buffer)})),this.queryErrorCallbackMap.set(n,t),this.worker.postMessage({id:n,action:"export",params:{}})}},{key:"getDirectoryEntries",value:function(e){null!=this.databaseDirectoryEntries?e(this.databaseDirectoryEntries):jQuery.getJSON("assets/databases/directory.json",(function(t){e(t)}))}},{key:"retrieveDatabaseStructure",value:function(e){var t=this,n=this;this.executeQuery("SELECT name, sql FROM sqlite_master WHERE type='table';",(function(i){var r,o,a="";null===(o=null===(r=i[0])||void 0===r?void 0:r.values)||void 0===o||o.forEach((function(e){return a+="PRAGMA table_info(".concat(e[0],");\nPRAGMA foreign_key_list(").concat(e[0],");\nselect count(*) from ").concat(e[0],";\n\n")})),""!=a?t.executeQuery(a,(function(t){n.databaseStructure=n.parseDatabaseStructure(i,t),e(n.databaseStructure)}),(function(e){console.log(e)})):(n.databaseStructure={tables:[]},e(n.databaseStructure))}),(function(e){console.log(e)}))}},{key:"parseDatabaseStructure",value:function(e,t){var n=this;this.databaseStructure={tables:[]};for(var i=new Map,r=0,o=function(o){var a=e[0].values[o][0],s=e[0].values[o][1],l={name:a,size:0,completeSQL:s,columns:[]};i.set(a,l),n.databaseStructure.tables.push(l);var u=t[r].values,c=null;t.length>r+1&&"id"==t[r+1].columns[0]&&(c=t[r+1].values,r++),r++;var d=t[r].values[0][0];r++,l.size=d,u.forEach((function(e){e[0];var t=e[1],n=e[2],i=1==e[3],r=e[4],o=0!=e[5],a={name:t,isPrimaryKey:o,isAutoIncrement:o&&s.toLowerCase().indexOf("autoincrement")>=0,completeTypeSQL:n,table:l,typeLengths:[],defaultValue:r,notNull:i};if(null!=c){var u=c.find((function(e){return e[3].toLocaleLowerCase()==t.toLocaleLowerCase()}));null!=u&&(a.referencesRawData=u)}l.columns.push(a)}))},a=0;a<e[0].values.length;a++)o(a);var s,l=dn(this.databaseStructure.tables);try{for(l.s();!(s=l.n()).done;){var u,c=dn(s.value.columns);try{var d=function(){var e=u.value;if(null!=e.referencesRawData){var t=i.get(e.referencesRawData[2]);if(null==t)return"continue";var n=t.columns.find((function(t){return t.name.toLocaleLowerCase()==e.referencesRawData[4].toLocaleLowerCase()}));e.references=n}};for(c.s();!(u=c.n()).done;)d()}catch(e){c.e(e)}finally{c.f()}}}catch(e){l.e(e)}finally{l.f()}return this.databaseStructure}}])&&fn(t.prototype,n),i&&fn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function pn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function yn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var gn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.MaxRowsPerInsert=300}var t,n,i;return t=e,(n=[{key:"clean",value:function(e){switch(e.ast.type){case r.keywordCreate:return e.sqlCleaned=this.cleanCreateTableStatement(e.ast),e.sqlCleaned;case r.keywordInsert:return e.sqlCleaned=this.cleanInsertStatement(e.ast),e.sqlCleaned;default:return e.sql}}},{key:"cleanInsertStatement",value:function(e){var t=this,n="insert into ".concat(e.table.identifier);null!=e.columnList&&e.columnList.length>0&&(n+="(".concat(e.columnList.map((function(e){return e.identifier})).join(", "),")")),n+="\nvalues\n";var i="",r=[];if(null!=e.values&&e.values.length>0){var o,a=pn(e.values);try{for(a.s();!(o=a.n()).done;){var s=o.value;r.push("\n(".concat(s.map((function(e){return t.cleanValue(e)})).join(", "),")"))}}catch(e){a.e(e)}finally{a.f()}}for(;r.length>0;)i+=n,i+=r.splice(0,Math.max(this.MaxRowsPerInsert,r.length)).join(",\n"),i+=";\n";return i}},{key:"cleanValue",value:function(e){if(e.constantType==r.stringConstant){var t=e.constant;return t=t.replace(/'/g,"''"),"'".concat(t,"'")}return e.constant}},{key:"cleanCreateTableStatement",value:function(e){var t=this,n="create table ".concat(e.ifNotExists?" if not exists":""," ").concat(e.identifier,"(\n   ");n+=e.columnList.map((function(e){return t.cleanColumnDef(e)})).join(",\n   "),null!=e.foreignKeyInfoList&&e.foreignKeyInfoList.length>0&&(n+=",\n   "+e.foreignKeyInfoList.map((function(e){return t.cleanForeignKeyInfo(e)})).join(",\n   "));var i,r=e.combinedPrimaryKeyColumns.slice().map((function(e){return e.toLocaleLowerCase()})),o=pn(e.columnList);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=a.identifier.toLocaleLowerCase();a.isAutoIncrement&&r.indexOf(s)>=0&&r.splice(r.indexOf(s),1)}}catch(e){o.e(e)}finally{o.f()}return r.length>0&&(n+=",\n   primary key(".concat(r.join(", "),")")),e.uniqueConstraints.length>0&&(n+=",\n   "+e.uniqueConstraints.map((function(e){return"unique("+e.join(", ")+")"})).join(",\n   ")),n+="\n);"}},{key:"cleanForeignKeyInfo",value:function(e){var t="foreign key (".concat(e.column,") references ").concat(e.referencesTable,"(").concat(e.referencesColumn,")");return e.onDelete&&(t+=" on delete "+e.onDelete),e.onUpdate&&(t+=" on update "+e.onUpdate),t}},{key:"cleanColumnDef",value:function(e){var t=e.baseType.toString();"int"==t&&e.isAutoIncrement&&(t="integer");var n="".concat(e.identifier," ").concat(t);if(null!=e.parameters&&e.parameters.length>0&&(n+="(".concat(e.parameters.join(", "),")")),e.notNull&&(n+=" not null"),null!=e.defaultValue&&(n+=" default "+e.defaultValue),(e.isPrimary||e.isAutoIncrement)&&(n+=" primary key"),e.isAutoIncrement&&(n+=" autoincrement"),null!=e.foreignKeyInfo){var i=e.foreignKeyInfo,r=i.referencesColumn;i.referencesTable&&(r=i.referencesTable+"("+r+")"),n+=" references "+r}if(null!=e.collate){var o=e.collate.toLocaleLowerCase();["binary","nocase","rtrim"].indexOf(o)>=0&&(n+=" collate "+o)}var a=e.parameters?e.parameters:[0,0],s=e.baseType.checkFunction(e.identifier,a);return""!=s&&(n+=" "+s),n}}])&&yn(t.prototype,n),i&&yn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function bn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return kn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function kn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function wn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Cn=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},Tn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t}var t,n,i;return t=e,(n=[{key:"loadFromUrl",value:function(e){return Cn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e){t.next=2;break}return t.abrupt("return");case 2:if(n=null,!e.endsWith(".zip")){t.next=9;break}return t.next=6,this.unzipURL(e);case 6:n=t.sent,t.next=14;break;case 9:return t.next=11,fetch(e);case 11:return t.next=13,t.sent.text();case 13:n=t.sent;case 14:return t.abrupt("return",this.importFromText(n));case 15:case"end":return t.stop()}}),t,this)})))}},{key:"loadFromFile",value:function(e){return Cn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e){t.next=2;break}return t.abrupt("return");case 2:if(!e.name.endsWith(".zip")){t.next=9;break}return t.next=5,this.unzipFile(e);case 5:return n=t.sent,t.abrupt("return",this.importFromText(n));case 9:return t.abrupt("return",new Promise((function(t,n){var r=new FileReader;r.onload=function(e){var n=e.target.result;t(i.importFromText(n))},r.readAsText(e)})));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"unzipURL",value:function(e){return Cn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new zip.ZipReader(new zip.HttpReader(e)),t.abrupt("return",this.unzipIntern(n));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"unzipFile",value:function(e){return Cn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new zip.ZipReader(new zip.BlobReader(e)),t.abrupt("return",this.unzipIntern(n));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"unzipIntern",value:function(e){return Cn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getEntries();case 2:if(n=(n=t.sent).filter((function(e){return e.filename.endsWith(".sql")})),i=null,!n.length){t.next=9;break}return t.next=8,n[0].getData(new zip.TextWriter,{onprogress:function(e,t){}});case 8:i=t.sent;case 9:return t.next=11,e.close();case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}}),t)})))}},{key:"importFromText",value:function(e){return Cn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,o,a,s,l,u,c,d,h,f,p,v,y,g,b,k,w,C,T;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e){t.next=2;break}return t.abrupt("return",null);case 2:n=new m,i=n.lex(e),o=new be,(a=new tt({dirty:!1,name:"",saved:!0,student_edited_after_revision:!1,submitted_date:null,text:e,text_before_revision:null,version:0},this.main)).tokenList=i.tokens,o.parse(a),this.createTableNodes=a.sqlStatements.filter((function(e){return e.ast.type==r.keywordCreate})).map((function(e){return e.ast})),this.insertNodes=a.sqlStatements.filter((function(e){return e.ast.type==r.keywordInsert})).map((function(e){return e.ast})),this.tableModifyingNodes=a.sqlStatements.filter((function(e){return e.ast.type==r.keywordAlter&&"omittedKind"==e.ast.kind})).map((function(e){return e.ast})),s=bn(this.tableModifyingNodes),t.prev=12,s.s();case 14:if((l=s.n()).done){t.next=26;break}if(u=l.value,null!=(c=this.findCreateTableNode(u.tableIdentifier))){t.next=19;break}return t.abrupt("continue",24);case 19:if(null!=u.primaryKeys&&(c.combinedPrimaryKeyColumns=u.primaryKeys,c.columnList.forEach((function(e){return e.isPrimary=!1}))),null!=u.autoIncrementColumn&&null!=(d=this.findCreateTableColumnNode(c,u.autoIncrementColumn))&&(d.isPrimary=!0),null!=u.modifyColumnInfo){h=bn(u.modifyColumnInfo);try{for(h.s();!(f=h.n()).done;)p=f.value,v=this.findCreateTableColumnNode(c,p.identifier),y=c.columnList.indexOf(v),c.columnList.splice(y,1,p)}catch(e){h.e(e)}finally{h.f()}}if(null!=u.foreignKeys){g=bn(u.foreignKeys);try{for(g.s();!(b=g.n()).done;)k=b.value,c.foreignKeyInfoList.push(k)}catch(e){g.e(e)}finally{g.f()}}if(null!=u.indices){w=bn(u.indices);try{for(w.s();!(C=w.n()).done;)T=C.value,a.sqlStatements.push({acceptedBySQLite:!0,from:null,to:null,hasErrors:!1,ast:{type:r.keywordIndex,columnIdentifier:T.column,indexIdentifier:T.index_name,tableIdentifier:u.tableIdentifier,unique:T.unique,position:null,endPosition:null,symbolTable:null},sql:"create ".concat(T.unique?"unique ":""," index ").concat(T.index_name," on ").concat(u.tableIdentifier,"(").concat(T.column,");")})}catch(e){w.e(e)}finally{w.f()}}case 24:t.next=14;break;case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(12),s.e(t.t0);case 31:return t.prev=31,s.f(),t.finish(31);case 34:return t.abrupt("return",this.makeDatabase(a.sqlStatements));case 35:case"end":return t.stop()}}),t,this,[[12,28,31,34]])})))}},{key:"findCreateTableNode",value:function(e){return e=e.toLocaleLowerCase(),this.createTableNodes.find((function(t){return t.identifier.toLocaleLowerCase()==e}))}},{key:"findCreateTableColumnNode",value:function(e,t){return t=t.toLocaleLowerCase(),e.columnList.find((function(e){return e.identifier.toLocaleLowerCase()==t}))}},{key:"makeDatabase",value:function(e){return Cn(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new gn,(i=e.filter((function(e){return e.ast.type!=r.omittedeStatement})).map((function(e){return n.clean(e)}))).unshift("PRAGMA foreign_keys = OFF;"),i.push("PRAGMA foreign_keys = ON;"),o=new mn(this.main),a=new Promise((function(e,t){o.initializeWorker(null,i,(function(){o.export((function(t){e({binDump:t})}),(function(e){t(e)}))}))})),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t,this)})))}}])&&wn(t.prototype,n),i&&wn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jn=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},Sn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"loadFromFile",value:function(e,t){return jn(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=e){n.next=3;break}return n.abrupt("return");case 3:if(t.getWaitOverlay().show("Lese Datei ein..."),!e.name.endsWith(".sql")&&!e.name.endsWith(".zip")){n.next=12;break}return n.next=7,new Tn(t).loadFromFile(e);case 7:return i=n.sent,t.getWaitOverlay().hide(),n.abrupt("return",i);case 12:return r=new FileReader,n.abrupt("return",new Promise((function(n,i){r.onload=function(e){var i=e.target.result,r=new Uint8Array(i);"binaryCompressed"==mn.getDumpType(r)&&(r=pako.inflate(r)),t.getWaitOverlay().hide(),n({binDump:r})},r.readAsArrayBuffer(e)})));case 14:case"end":return n.stop()}}),n,this)})))}},{key:"saveToFile",value:function(e){e.export((function(e){var t=prompt("Bitte geben Sie den Dateinamen ein","datenbank.sqLite");null!=t?(t.endsWith(".sqLite")||(t+=".sqLite"),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n?e:new Blob([JSON.stringify(e)],{type:"text/plain"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,t);else{var r=document.createEvent("MouseEvents"),o=document.createElement("a");o.download=t,o.href=window.URL.createObjectURL(i),o.dataset.downloadurl=["text/plain",o.download,o.href].join(":"),r.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(r),o.remove()}}(new Blob([e.buffer]),t,!0)):alert("Der Dateiname ist leer, daher wird nichts gespeichert.")}),(function(){}))}}])&&xn(t.prototype,n),i&&xn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function En(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _n=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},Dn=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.owner_id=n,this.path=i,this.init()}var t,n,i;return t=e,(n=[{key:"init",value:function(){var e=this;this.$dialog=jQuery("#dialog"),jQuery("#main").css("visibility","hidden"),this.$dialog.append(jQuery('<div class="jo_ds_heading">Neue Datenbank anlegen</div>\n\n            <div class="jo_ds_settings">\n               <div class="jo_ds_settings_caption">Name der Datenbank:</div><div><input class="dialog-input jo_databasename" value="Neue Datenbank"></input></div>\n            </div>\n\n             <div class="jo_tabheadings jo_cdtabheading">\n             <div class="jo_tabheading" data-target="jo_createEmptyDatabaseTab">Leere Datenbank</div>\n             <div class="jo_tabheading jo_active" data-target="jo_createDatabaseFromTemplateTab">Von Vorlage kopieren</div>\n             <div class="jo_tabheading" data-target="jo_createDatabaseUseExistingTab">Bestehende Datenbank mitnutzen</div>\n             <div class="jo_tabheading" data-target="jo_createDatabaseUseDumpFile">Import aus Dumpfile (SQLite- oder MySQL-Format)</div>\n             </div>\n             <div class="jo_tabs" style="width: 100%; margin-top: 10px">\n                 <div class="jo_createEmptyDatabaseTab">\n                    <div class="jo_createDatabaseDescription">\n                        Erstellt wird eine leere Datenbank.\n                    </div>\n                 </div>\n                 <div class="jo_createDatabaseFromTemplateTab jo_active">\n                    <div class="jo_ds_settings">\n                       <div class="jo_ds_settings_caption">Vorlage suchen:</div><div><input class="dialog-input jo_templatename"></input></div>\n                    </div>\n                    <div class="jo_scrollable jo_templatelist"></div>\n                 </div>\n                <div class="jo_createDatabaseUseExistingTab">\n                    <div class="jo_createDatabaseDescription">Wenn Du die Datenbank einer anderen Nutzerin/eines anderen Nutzers mitnutzen möchtest, brauchst Du einen Zugriffscode von ihr/ihm. Er ist unter Datenbank->Einstellungen zu finden.            \n                    </div>\n                    <div class="jo_ds_settings">\n                       <div class="jo_ds_settings_caption">Zugriffscode:</div><div><input class="dialog-input jo_databasecodeinput"></input></div>\n                    </div>\n                 </div>\n                <div class="jo_createDatabaseUseDumpFile">\n                    <div class="jo_createDatabaseDescription">Wähle hier die Datei mit dem Datenbank-Dump aus (Endung .sqLite (SQLite-Datenbankdatei) oder .zip (gepackter MySql-Dump) oder .sql (MySql-Dump)):</div>\n                    <input type="file" class="jo_dumpfile" name="dumpfile" style="padding: 10px"/>\n                    <div class="jo_databaseimport_dropzone" style="width: 70vw; margin-left: 10px">Alternativ: Datei in dieses Feld ziehen</div>\n                    <div class="jo_databaseimport_ok"></div>\n                 </div>\n             </div>\n\n             <div class="dialog-buttonRow jo_ds_buttonRow">\n                <button id="jo_ds_cancel_button">Abbrechen</button>\n                <button id="jo_ds_create_database_button">Datenbank anlegen</button>\n             </div>\n            ')),dt(this.$dialog);var t=jQuery(".jo_templatelist");this.main.networkManager.fetchTemplateList((function(e){e.forEach((function(e){var n=jQuery('<div class="jo_templateListEntry"></div>');n.append(jQuery('<div class="jo_tle_firstline">'.concat(e.name,' <span class="jo_tle_ownername"> (von ').concat(e.ownerName,")</span></div>"))),n.append(jQuery('<div class="jo_tle_secondline">'.concat(e.description,"</div>"))),n.data("templateId",e.id),n.data("name",e.name),t.append(n),e.$tle=n,n.on("pointerdown",(function(){t.find(".jo_templateListEntry").removeClass("jo_active"),n.addClass("jo_active")}))}));var n=jQuery(".jo_templatename");n.on("input",(function(){var i=n.val();t.find(".jo_templateListEntry").hide(),e.forEach((function(e){(e.name+e.ownerName+(e.description?e.description:"")).indexOf(i)>=0&&e.$tle.show()}))}))}));var n=jQuery(".jo_databaseimport_dropzone");n.on("dragover",(function(e){e.stopPropagation(),e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="copy"})),n.on("drop",(function(t){t.stopPropagation(),t.preventDefault();var n=t.originalEvent.dataTransfer.files;e.importFile(n)}));var i=jQuery(".jo_dumpfile");i.on("change",(function(t){var n=t.originalEvent.target.files;e.importFile(n).then((function(){i.val(null)}))})),this.$dialog.css("visibility","visible"),jQuery("#jo_ds_cancel_button").on("click",(function(){e.showMainWindow()})),jQuery("#jo_ds_create_database_button").on("click",(function(){var t="emptyDatabase";jQuery(".jo_createDatabaseFromTemplateTab").hasClass("jo_active")&&(t="fromTemplate"),jQuery(".jo_createDatabaseUseExistingTab").hasClass("jo_active")&&(t="useExistingDatabase"),jQuery(".jo_createDatabaseUseDumpFile").hasClass("jo_active")&&(t="useDumpFile");var n={id:null,isFolder:!1,name:jQuery(".dialog-input.jo_databasename").val(),path:e.path.join("/")};switch(t){case"emptyDatabase":e.createWorkspace(n);break;case"fromTemplate":var i=jQuery(".jo_templateListEntry.jo_active");if(1!=i.length)return void alert("Bitte wählen Sie genau eine Vorlage aus.");n.template_database_id=i.data("templateId"),"Neue Datenbank"==n.name&&(n.name=i.data("name")),e.createWorkspace(n);break;case"useExistingDatabase":var r=jQuery(".jo_databasecodeinput").val(),o=r.indexOf("T");if(-1==o)return void alert("Der Zugriffscode muss das Zeichen T enthalten.");n.otherDatabaseId=Number.parseInt(r.substring(0,o)),n.secret=r.substring(o+1),e.createWorkspace(n);break;case"useDumpFile":if(null==e.database)return void alert("Bitte laden Sie zuerst den Binärdump einer Datenbank hoch.");(new Lt).uploadCurrentDatabase(-1,e.main,e.database.binDump,"uploadBaseTemplateForWorkspace",(function(t){n.template_id=t.newTemplateId,e.createWorkspace(n)}))}}))}},{key:"createWorkspace",value:function(e){var t=this;this.main.networkManager.sendCreateWorkspace(e,this.owner_id,(function(n){if(null==n){var i=t.main.createNewWorkspace(e.name,t.owner_id);i.path=e.path,i.id=e.id,i.sql_history="";var r=t.main.projectExplorer;t.main.workspaceList.push(i);var o={name:e.name,externalElement:i,iconClass:"workspace",isFolder:!1,path:t.path};r.workspaceListPanel.addElement(o,!0),i.renderSettingsButton(o),r.workspaceListPanel.sortElements(),r.fileListPanel.sortElements(),r.setWorkspaceActive(i),t.showMainWindow()}else alert(n)}))}},{key:"importFile",value:function(e){return _n(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,r,o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,i=new Sn,t.next=4,i.loadFromFile(e[0],this.main);case 4:r=t.sent,o=!1,"binaryCompressed"==mn.getDumpType(r.binDump)?(a=pako.inflate(r.binDump),"binaryUncompressed"==mn.getDumpType(a)&&(o=!0)):"binaryUncompressed"==mn.getDumpType(r.binDump)&&(r.binDump=pako.deflate(r.binDump),o=!0),o?(n.database=r,jQuery(".jo_databaseimport_ok").html("Die Datenbankdatei wurde erfolgreich von Datei eingelesen. Sie können die Datenbank jetzt durch Klick auf den Button unten erstellen.")):alert("In der Datei befindet sich kein Binärdump einer Datenbank.");case 9:case"end":return t.stop()}}),t,this)})))}},{key:"showMainWindow",value:function(){jQuery("#main").css("visibility","visible"),this.$dialog.css("visibility","hidden"),this.$dialog.empty()}}])&&En(t.prototype,n),i&&En(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Pn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ln(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ln(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ln(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function On(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var In=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.currentSubmenu={},this.openSubmenusOnMousemove=!1}var t,n,i;return t=e,(n=[{key:"initGUI",value:function(e){var t=this,n=this,i=this.main.getMonacoEditor(),r={items:[{identifier:"Datei",subMenu:{items:[{identifier:"Speichern und Beenden",action:function(){jQuery("#buttonLogout").trigger("click")}}]}},{identifier:"Bearbeiten",subMenu:{items:[{identifier:"Rückgängig (Strg + z)",action:function(){i.trigger(".","undo",{})}},{identifier:"Wiederholen (Strg + y)",action:function(){i.trigger(".","redo",{})}},{identifier:"-"},{identifier:"Kopieren (Strg + c)",action:function(){i.getAction("editor.action.clipboardCopyAction").run()}},{identifier:"Ausschneiden (Strg + x)",action:function(){i.getAction("editor.action.clipboardCutAction").run()}},{identifier:"Nach oben kopieren (Alt + Shift + Pfeil rauf)",action:function(){i.getAction("editor.action.copyLinesUpAction").run()}},{identifier:"Nach unten kopieren (Alt + Shift + Pfeil runter)",action:function(){i.getAction("editor.action.copyLinesDownAction").run()}},{identifier:"Nach oben verschieben (Alt + Pfeil rauf)",action:function(){i.getAction("editor.action.moveLinesUpAction").run()}},{identifier:"Nach unten verschieben (Alt + Pfeil runter)",action:function(){i.getAction("editor.action.moveLinesDownAction").run()}},{identifier:"-"},{identifier:"Suchen... (Strg + f)",action:function(){i.getAction("actions.find").run()}},{identifier:"Ersetzen... (Strg + h)",action:function(){i.getAction("editor.action.startFindReplaceAction").run()}},{identifier:"-"},{identifier:"Aus-/Einkommentieren (Strg + #)",action:function(){i.getAction("editor.action.commentLine").run()}},{identifier:"Dokument formatieren (Alt + Shift + f)",action:function(){i.getAction("editor.action.formatDocument").run()}},{identifier:"-"},{identifier:"Finde zugehörige Klammer (Strg + k)",action:function(){i.getAction("editor.action.jumpToBracket").run()}},{identifier:"-"},{identifier:"Alles zusammenfalten",action:function(){i.getAction("editor.foldAll").run()}},{identifier:"Alles auffalten",action:function(){i.getAction("editor.unfoldAll").run()}},{identifier:"-"},{identifier:"Vorschlag auslösen (Strg + Leertaste)",action:function(){i.focus(),setTimeout((function(){i.getAction("editor.action.triggerSuggest").run()}),200)}},{identifier:"Parameterhilfe (Strg + Shift + Leertaste)",action:function(){i.getAction("editor.action.triggerParameterHints").run()}},{identifier:"Gehe zur Definition (Strg + Click)",action:function(){i.focus(),setTimeout((function(){i.getAction("editor.action.revealDefinition").run()}),200)}}]}},{identifier:"Ansicht",subMenu:{items:[{identifier:"Theme",subMenu:{items:[{identifier:"Dark",action:function(){n.switchTheme("dark")}},{identifier:"Light",action:function(){n.switchTheme("light")}}]}},{identifier:"-"},{identifier:"Hoher Kontrast im Editor ein/aus",action:function(){i.getAction("editor.action.toggleHighContrast").run()}},{identifier:"-"},{identifier:"Zoom out (Strg + Mausrad)",action:function(){t.main.editor.changeEditorFontSize(-4)}},{identifier:"Zoom normal",action:function(){t.main.editor.setFontSize(14)}},{identifier:"Zoom in (Strg + Mausrad)",action:function(){t.main.editor.changeEditorFontSize(4)}}]}},{identifier:"Datenbank",subMenu:{items:[{identifier:"Neue Datenbank anlegen...",action:function(){var e=n.main.user.id;null!=n.main.workspacesOwnerId&&(e=n.main.workspacesOwnerId),new Dn(n.main,e,[])}},{identifier:"Einstellungen...",action:function(){new It(t.main,t.main.currentWorkspace)}},{identifier:"Export als Binärdump (.sqLite-File)...",action:function(){(new Sn).saveToFile(t.main.getDatabaseTool())}}]}}]};jQuery("#mainmenu").empty(),this.initMenu(r,0)}},{key:"switchTheme",value:function(e){this.main.viewModeController.setTheme(e)}},{key:"initMenu",value:function(e,t){e.level=t,0==t?e.$element=jQuery("#mainmenu"):(e.$element=jQuery('<div class="jo_submenu"></div>'),jQuery("body").append(e.$element)),e.$element.data("model",e);var n,i=Pn(e.items);try{for(i.s();!(n=i.n()).done;){var r=n.value;if("-"==r.identifier)r.$element=jQuery('<div class="jo_menuitemdivider"></div>');else{if(r.$element=jQuery("<div>"+r.identifier+"</div>"),null!=r.link){var o=jQuery('<a href="'+r.link+'" target="_blank" class="jo_menulink"></a>');o.on("mousedown",(function(t){t.stopPropagation(),setTimeout((function(){e.$element.hide()}),500)})),o.append(r.$element),r.$element=o}null!=r.subMenu&&this.initMenu(r.subMenu,t+1),this.initMenuitemCallbacks(e,r),0==t&&r.$element.addClass("jo_mainmenuitem")}e.$element.append(r.$element),r.$element.data("model",r)}}catch(e){i.e(e)}finally{i.f()}var a=this;jQuery(document).on("mousedown",(function(){for(var e=0;e<5;e++)null!=a.currentSubmenu[e]&&(a.currentSubmenu[e].hide(),a.currentSubmenu[e]=null);a.openSubmenusOnMousemove=!1}))}},{key:"initMenuitemCallbacks",value:function(e,t){var n=this;null!=t.action&&t.$element.on("mousedown",(function(e){t.action(t.identifier)})),null!=t.subMenu?(t.$element.on("mousedown",(function(e){n.opensubmenu(t),n.openSubmenusOnMousemove=!0,e.stopPropagation()})),t.$element.on("mousemove.mainmenu",(function(){n.openSubmenusOnMousemove?n.opensubmenu(t):null!=n.currentSubmenu[e.level+1]&&(n.currentSubmenu[e.level+1].hide(),n.currentSubmenu[e.level+1]=null)}))):t.$element.on("mousemove.mainmenu",(function(){null!=n.currentSubmenu[e.level+1]&&(n.currentSubmenu[e.level+1].hide(),n.currentSubmenu[e.level+1]=null)}))}},{key:"opensubmenu",value:function(e){var t,n,i=e.subMenu;1==i.level?(t=e.$element.position().left,n=30):(t=e.$element.offset().left+e.$element.width(),n=e.$element.offset().top),i.$element.css({top:n+"px",left:t+"px"}),null!=this.currentSubmenu[i.level]&&this.currentSubmenu[i.level].hide(),i.$element.show(),this.currentSubmenu[i.level]=i.$element}}])&&On(t.prototype,n),i&&On(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function An(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Mn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Mn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Bn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fn(e,t,n){return t&&Nn(e.prototype,t),n&&Nn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var $n=function(){function e(t,n,i,r,o,a,s,l,u,c,d){var h=this;Bn(this,e),this.accordion=t,this.caption=n,this.flexWeight=i,this.newButtonClass=r,this.buttonNewTitle=o,this.defaultIconClass=a,this.withDeleteButton=s,this.withFolders=l,this.kind=u,this.enableDrag=c,this.acceptDropKinds=d,this.elements=[],this.dontSortElements=!1,t.addPanel(this);var f=window.PointerEvent?"pointer":"mouse";if(l){var m=this;this.$newFolderAction=jQuery('<div class="img_add-folder-dark jo_button jo_active" style="margin-right: 4px" title="Neuen Ordner auf oberster Ebene anlegen">'),this.$newFolderAction.on(f+"down",(function(e){e.stopPropagation(),e.preventDefault();h.addFolder("Neuer Ordner",[],(function(e){h.newFolderCallback(e,(function(){h.sortElements(),e.$htmlFirstLine[0].scrollIntoView(),mt(e.$htmlFirstLine.find(".jo_filename"),"background-color",[0,255,0],2e3)}))}))})),this.addAction(this.$newFolderAction);var p=jQuery('<div class="img_collapse-all-dark jo_button jo_active" style="margin-right: 4px" title="Alle Ordner zusammenfalten">');p.on(f+"down",(function(e){e.stopPropagation(),e.preventDefault(),m.collapseAll()})),this.addAction(p)}}return Fn(e,[{key:"collapseAll",value:function(){var e,t=An(this.elements);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.isFolder&&n.$htmlFirstLine.hasClass("jo_expanded")&&(n.$htmlFirstLine.removeClass("jo_expanded"),n.$htmlFirstLine.addClass("jo_collapsed")),n.path.length>0&&n.$htmlFirstLine.slideUp(200)}}catch(e){t.e(e)}finally{t.f()}}},{key:"remove",value:function(){this.$captionElement.remove(),this.$listElement.remove()}},{key:"setFixed",value:function(e){this.fixed=e,this.fixed?(this.grow(),this.$captionElement.addClass("jo_fixed")):this.$captionElement.removeClass("jo_fixed")}},{key:"enableNewButton",value:function(e){null!=this.$buttonNew&&(e?this.$buttonNew.show():this.$buttonNew.hide())}},{key:"getCurrentlySelectedPath",value:function(){var e=[],t=this.getSelectedElement();return null!=t&&(e=t.path.slice(0),t.isFolder&&e.push(t.name)),e}},{key:"compareWithPath",value:function(e,t,n,i,r,o){(t=t.slice()).push(e),e="",(r=r.slice()).push(i),i="";for(var a=0;a<t.length&&a<r.length;){var s=t[a].localeCompare(r[a]);if(0!=s)return s;a++}return t.length<r.length?-1:t.length>r.length?1:e.localeCompare(i)}},{key:"getElementIndex",value:function(e,t,n){for(var i=0;i<this.elements.length;i++){var r=this.elements[i];if(this.compareWithPath(e,t,n,r.name,r.path,r.isFolder)<0)return i}return this.elements.length}},{key:"insertElement",value:function(e){var t=this.getElementIndex(e.name,e.path,e.isFolder);this.elements.splice(t,0,e);var n=this.$listElement.find(".jo_file");if(0==t)this.$listElement.prepend(e.$htmlFirstLine);else if(t==n.length)this.$listElement.append(e.$htmlFirstLine);else{var i=n.get(t);jQuery(i).before(e.$htmlFirstLine)}}},{key:"addFolder",value:function(e,t,n){var i={name:e,isFolder:!0,path:t},r=this.renderElement(i,!0);this.insertElement(i),r[0].scrollIntoView(),this.renameElement(i,(function(){n(i)}))}},{key:"renderOuterHtmlElements",value:function(t){var n=this,i=this;if(this.$captionElement=jQuery('<div class="jo_leftpanelcaption jo_expanded">\n        <div class="jo_captiontext">'+this.caption+'</div><div class="jo_actions"></div></div>'),null!=this.newButtonClass){this.$buttonNew=jQuery('<div class="jo_button jo_active '+this.newButtonClass+'" title="'+this.buttonNewTitle+'">'),this.$captionElement.find(".jo_actions").append(this.$buttonNew);var r=window.PointerEvent?"pointer":"mouse";this.$buttonNew.on(r+"down",(function(e){rn.close(),e.stopPropagation();var t=i.getCurrentlySelectedPath(),r={name:"Neu",isFolder:!1,path:t},o=n.getElementIndex("",t,!1);n.elements.splice(o,0,r);var a=n.renderElement(r,!0);if(0==o)n.$listElement.prepend(a);else{var s=n.$listElement.find(".jo_file").get(o-1);jQuery(s).after(a)}a[0].scrollIntoView(),i.renameElement(r,(function(){i.newFilesElementCallback(r,(function(e){r.externalElement=e,null!=r.$htmlSecondLine&&r.$htmlSecondLine.insertAfter(a),null!=i.selectCallback&&i.select(r.externalElement)}))}))}))}var o=jQuery('<div id="filelistouter" class="jo_projectexplorerdiv jo_scrollable" data-grow="'+this.flexWeight+'" style="flex-grow: '+this.flexWeight+'"></div>');this.$listElement=jQuery('<div class="jo_filelist"></div>'),o.append(this.$listElement),t.append(this.$captionElement),t.append(o);var a=this.$captionElement,s=this.$listElement.parent(),l=window.PointerEvent?"pointer":"mouse";a.on(l+"down",(function(e){if(0==e.button&&!n.fixed){var t=s.data("grow");a.hasClass("jo_expanded")?i.accordion.parts.length>1&&s.animate({"flex-grow":.001},1e3,(function(){a.toggleClass("jo_expanded")})):(a.toggleClass("jo_expanded"),s.animate({"flex-grow":t},1e3))}})),a.on("dragover",(function(t){e.currentlyDraggedElementKind==i.kind&&(a.addClass("jo_file_dragover"),t.preventDefault())})),a.on("dragleave",(function(e){a.removeClass("jo_file_dragover")})),a.on("drop",(function(t){if(e.currentlyDraggedElementKind==i.kind){t.preventDefault(),a.removeClass("jo_file_dragover");var n=e.currentlyDraggedElement;null!=n&&i.moveElement(n,null)}}))}},{key:"grow",value:function(){var e=this.$listElement.parent(),t=e.data("grow");e.css("flex-grow",t),this.$captionElement.addClass("jo_expanded")}},{key:"addElement",value:function(e,t){e.$htmlFirstLine=this.renderElement(e,t),this.insertElement(e)}},{key:"sortElements",value:function(){var e=this;this.dontSortElements||(this.elements.sort((function(t,n){var i=t.sortName?t.sortName:t.name,r=n.sortName?n.sortName:n.name;return e.compareWithPath(i,t.path,t.isFolder,r,n.path,n.isFolder)})),this.elements.forEach((function(t){e.$listElement.append(t.$htmlFirstLine)})))}},{key:"setTextAfterFilename",value:function(e,t,n){if(null!=e){var i=e.$htmlFirstLine.find(".jo_textAfterName");i.addClass(n),i.html(t)}}},{key:"addAction",value:function(e){this.$captionElement.find(".jo_actions").prepend(e)}},{key:"renderElement",value:function(t,n){var i=this,r=window.PointerEvent?"pointer":"mouse",o=this,a="";null==t.iconClass&&(t.iconClass=this.defaultIconClass),t.isFolder&&(t.iconClass="folder",a=n?" jo_expanded":" jo_collapsed");var s="";null==t.path&&(t.path=[]);for(var l=0;l<t.path.length;l++)s+='<div class="jo_folderline"></div>';if(t.$htmlFirstLine=jQuery('<div class="jo_file jo_'.concat(t.iconClass," ").concat(a,'">\n        <div class="jo_folderlines">').concat(s,'</div>\n           <div class="jo_fileimage"></div>\n           <div class="jo_filename">').concat(Ne(t.name),'</div>\n           <div class="jo_textAfterName"></div>\n           <div class="jo_additionalButtonSettings"></div>\n           ').concat(this.withDeleteButton?'<div class="jo_delete img_delete jo_button jo_active"></div>':"","\n           ").concat(ft?"":'<div class="jo_settings_button img_ellipsis-dark jo_button jo_active"></div>',"\n           </div>")),!n&&t.path.length>0&&t.$htmlFirstLine.hide(),null!=this.addElementActionCallback){var u=this.addElementActionCallback(t);t.$htmlFirstLine.append(u)}if(this.withFolders&&t.isFolder&&(t.$htmlFirstLine.on("dragover",(function(n){e.currentlyDraggedElementKind==o.kind&&(t.$htmlFirstLine.addClass("jo_file_dragover"),n.preventDefault())})),t.$htmlFirstLine.on("dragleave",(function(e){t.$htmlFirstLine.removeClass("jo_file_dragover")})),t.$htmlFirstLine.on("drop",(function(n){if(e.currentlyDraggedElementKind==o.kind){n.preventDefault(),t.$htmlFirstLine.removeClass("jo_file_dragover");var i=e.currentlyDraggedElement;e.currentlyDraggedElement=null,null!=i&&o.moveElement(i,t)}}))),this.withFolders||this.enableDrag){var c=t.$htmlFirstLine.find(".jo_filename");c.attr("draggable","true"),c.on("dragstart",(function(n){e.currentlyDraggedElement=t,e.currentlyDraggedElementKind=o.kind,n.originalEvent.dataTransfer.effectAllowed=t.isFolder?"move":"copyMove"}))}null!=this.acceptDropKinds&&this.acceptDropKinds.length>0&&(t.isFolder||(t.$htmlFirstLine.on("dragover",(function(n){i.acceptDropKinds.indexOf(e.currentlyDraggedElementKind)>=0&&(t.$htmlFirstLine.addClass("jo_file_dragover"),n.ctrlKey?n.originalEvent.dataTransfer.dropEffect="copy":n.originalEvent.dataTransfer.dropEffect="move",n.preventDefault())})),t.$htmlFirstLine.on("dragleave",(function(e){t.$htmlFirstLine.removeClass("jo_file_dragover")})),t.$htmlFirstLine.on("drop",(function(n){if(i.acceptDropKinds.indexOf(e.currentlyDraggedElementKind)>=0){n.preventDefault(),t.$htmlFirstLine.removeClass("jo_file_dragover");var r=e.currentlyDraggedElement;e.currentlyDraggedElement=null,null!=r&&null!=o.dropElementCallback&&o.dropElementCallback(t,r,n.ctrlKey?"copy":"move")}})))),t.$htmlFirstLine.on(r+"up",(function(e){if(0==e.button&&null!=o.selectCallback){o.selectCallback(t.externalElement);var n,r=An(o.elements);try{for(r.s();!(n=r.n()).done;){var a=n.value;a!=t&&a.$htmlFirstLine.hasClass("jo_active")&&a.$htmlFirstLine.removeClass("jo_active")}}catch(e){r.e(e)}finally{r.f()}if(t.$htmlFirstLine.addClass("jo_active"),t.isFolder){t.$htmlFirstLine.hasClass("jo_expanded")?(t.$htmlFirstLine.removeClass("jo_expanded"),t.$htmlFirstLine.addClass("jo_collapsed")):(t.$htmlFirstLine.addClass("jo_expanded"),t.$htmlFirstLine.removeClass("jo_collapsed"));var s,l={},u=An(i.elements);try{for(u.s();!(s=u.n()).done;){var c=s.value;if(c.isFolder){var d=c.path.join("/");""!=d&&(d+="/"),l[d+=c.name]=c.$htmlFirstLine.hasClass("jo_collapsed"),l[c.path.join("/")]&&(l[d]=!0)}}}catch(e){u.e(e)}finally{u.f()}l[""]=!1;var h,f=An(i.elements);try{for(f.s();!(h=f.n()).done;){var m=h.value;l[m.path.join("/")]?m.$htmlFirstLine.slideUp(200):m.$htmlFirstLine.slideDown(200)}}catch(e){f.e(e)}finally{f.f()}}}}));var d,h=function(e){var n=[];null!=o.renameCallback&&n.push({caption:"Umbenennen",callback:function(){o.renameElement(t)}});window.PointerEvent;if(t.isFolder&&(n=n.concat([{caption:"Neuen Unterordner anlegen (unterhalb '"+t.name+"')...",callback:function(){o.select(t.externalElement);var e=o.getCurrentlySelectedPath();o.addFolder("Neuer Ordner",e,(function(e){o.newFolderCallback(e,(function(){o.sortElements(),e.$htmlFirstLine[0].scrollIntoView(),mt(e.$htmlFirstLine.find(".jo_filename"),"background-color",[0,255,0],2e3)}))}))}},{caption:"Neue Datenbank...",callback:function(){o.select(t.externalElement),o.newDatabaseElementCallback(t.path.concat(t.name))}}])),null!=o.contextMenuProvider&&!t.isFolder){var i,r=An(o.contextMenuProvider(t));try{var a=function(){var e=i.value;n.push({caption:e.caption,callback:function(){e.callback(t)},color:e.color,subMenu:null==e.subMenu?null:e.subMenu.map((function(e){return{caption:e.caption,callback:function(){e.callback(t)},color:e.color}}))})};for(r.s();!(i=r.n()).done;)a()}catch(e){r.e(e)}finally{r.f()}}n.length>0&&(e.preventDefault(),e.stopPropagation(),ct(n,e.pageX,e.pageY))};return t.$htmlFirstLine[0].addEventListener("contextmenu",h,!1),ft||t.$htmlFirstLine.on("pointerup",(function(){return clearTimeout(d),!1})).on("pointerdown",(function(e){return d=window.setTimeout((function(){h(e)}),500),!1})),ft||(t.$htmlFirstLine.find(".jo_settings_button").on("pointerdown",(function(e){h(e)})),t.$htmlFirstLine.find(".jo_settings_button").on("mousedown click",(function(e){e.preventDefault(),e.stopPropagation()}))),o.withDeleteButton&&t.$htmlFirstLine.find(".jo_delete").on(r+"up",(function(e){e.preventDefault(),ct([{caption:"Abbrechen",callback:function(){}},{caption:"Ich bin mir sicher: löschen!",color:"#ff6060",callback:function(){t.isFolder&&o.getChildElements(t).length>0?alert("Dieser Ordner kann nicht gelöscht werden, da er nicht leer ist."):o.deleteCallback(t.externalElement,(function(){t.$htmlFirstLine.remove(),null!=t.$htmlSecondLine&&t.$htmlSecondLine.remove(),o.elements.splice(o.elements.indexOf(t),1),null!=o.selectCallback&&(o.elements.length>0?o.select(o.elements[0].externalElement):o.select(null))}))}}],e.pageX+2,e.pageY+2),e.stopPropagation()})),t.$htmlFirstLine}},{key:"moveElement",value:function(e,t){var n=null==t?[]:t.path.slice(0).concat([t.name]);if(e.isFolder){var i=[e],r=e.path.concat([e.name]).join("/");if(0==n.join("/").indexOf(r))return;var o=e.path.length;e.path=n.slice(0);var a,s=An(this.elements);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.path.join("/").startsWith(r)&&(l.path.splice(0,o),l.path=n.concat(l.path),i.push(l))}}catch(e){s.e(e)}finally{s.f()}for(var u=0,c=i;u<c.length;u++){var d=c[u];d.$htmlFirstLine.remove(),this.elements.splice(this.elements.indexOf(d),1)}for(var h=0,f=i;h<f.length;h++){var m=f[h];this.renderElement(m,!0),this.insertElement(m)}this.moveCallback(i)}else e.path=n,e.$htmlFirstLine.remove(),this.elements.splice(this.elements.indexOf(e),1),this.renderElement(e,!0),this.insertElement(e),this.select(e.externalElement),e.$htmlFirstLine[0].scrollIntoView(),this.moveCallback(e)}},{key:"getChildElements",value:function(e){var t=e.path.slice(0).concat(e.name).join("/");return this.elements.filter((function(e){return e.path.join("/").startsWith(t)}))}},{key:"renameElement",value:function(e,t){var n=this,i=this,r=e.$htmlFirstLine.find(".jo_filename"),o=e.name.indexOf("."),a=null==o?null:{start:0,end:o};this.dontSortElements=!0,ut(r,r,(function(o){null!=e.externalElement&&(o=i.renameCallback(e.externalElement,o)),e.name=o,r.html(e.name),null!=t&&t(),i.sortElements(),r[0].scrollIntoView(),n.dontSortElements=!1}),a)}},{key:"select",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e){var i,r=An(this.elements);try{for(r.s();!(i=r.n()).done;){var o=i.value;o.$htmlFirstLine.hasClass("jo_active")&&o.$htmlFirstLine.removeClass("jo_active")}}catch(e){r.e(e)}finally{r.f()}}else{var a=this.findElement(e);if(null!=a){var s,l=An(this.elements);try{for(l.s();!(s=l.n()).done;){var u=s.value;u.$htmlFirstLine.hasClass("jo_active")&&u.$htmlFirstLine.removeClass("jo_active")}}catch(e){l.e(e)}finally{l.f()}if(a.$htmlFirstLine.addClass("jo_active"),n){var c,d=a.path.join("/"),h=An(this.elements);try{for(h.s();!(c=h.n()).done;){var f=c.value,m=f.path.slice(0);d.startsWith(m.join("/"))&&(f.isFolder&&(m.push(f.name),d.startsWith(m.join("/"))&&(f.$htmlFirstLine.removeClass("jo_collapsed"),f.$htmlFirstLine.addClass("jo_expanded"))),f.$htmlFirstLine.show())}}catch(e){h.e(e)}finally{h.f()}a.$htmlFirstLine[0].scrollIntoView()}}}t&&null!=this.selectCallback&&this.selectCallback(e)}},{key:"getPathString",value:function(e){var t=e.path.join("/");return e.isFolder&&(""!=t&&(t+="/"),t+=e.name),t}},{key:"setElementClass",value:function(e,t){var n;null!=e&&(null===(n=e.$htmlFirstLine)||void 0===n||n.removeClass("jo_"+e.iconClass).addClass("jo_"+t),e.iconClass=t)}},{key:"findElement",value:function(e){var t,n=An(this.elements);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.externalElement==e)return i}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"removeElement",value:function(e){var t,n=An(this.elements);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.externalElement==e)return i.$htmlFirstLine.remove(),null!=i.$htmlSecondLine&&i.$htmlSecondLine.remove(),this.elements.splice(this.elements.indexOf(i),1),void(null!=this.selectCallback&&(this.elements.length>0?this.select(this.elements[0].externalElement):this.select(null)))}}catch(e){n.e(e)}finally{n.f()}}},{key:"clear",value:function(){this.$listElement.empty(),this.elements=[]}},{key:"setCaption",value:function(e){this.$captionElement.find(".jo_captiontext").html(e)}},{key:"getSelectedElement",value:function(){var e,t=An(this.elements);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.$htmlFirstLine.hasClass("jo_active"))return n}}catch(e){t.e(e)}finally{t.f()}return null}}]),e}(),Rn=function(){function e(t,n){Bn(this,e),this.main=t,this.parts=[],this.$html=n,n.addClass("jo_leftpanelinner")}return Fn(e,[{key:"addPanel",value:function(e){e.renderOuterHtmlElements(this.$html),this.parts.push(e)}}]),e}();function Qn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Wn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function zn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var qn=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.classes=t,this.workspace=n,this.main=i,this.studentCount=0,this.init()}var t,n,i;return t=e,(n=[{key:"init",value:function(){this.$dialog=jQuery("#dialog"),jQuery("#main").css("visibility","hidden"),this.$dialog.append(jQuery('<div class="jo_ds_heading">Austeilen eines Workspace an einzelne Schüler/innen</div>\n             <div class="jo_ds_settings">\n                <div class="jo_ds_settings_caption">Workspace:</div><div class="jo_ds_workspacename">'.concat(this.workspace.name,'</div>\n                <div class="jo_ds_settings_caption">Liste filtern:</div><div class="jo_ds_filterdiv"><input class="dialog-input"></input></div>\n             </div>\n             <div class="jo_ds_student_list jo_scrollable">\n             </div>\n             <div class="jo_ds_selected_message"></div>\n             <div class="dialog-buttonRow jo_ds_buttonRow">\n                <button id="jo_ds_cancel_button">Abbrechen</button>\n                <button id="jo_ds_distribute_button">Austeilen</button>\n             </div>\n            ')));var e,t=jQuery(".jo_ds_student_list"),n=this,i=Qn(this.classes);try{for(i.s();!(e=i.n()).done;){var r,o=e.value,a=Qn(o.students);try{var s=function(){var e=r.value,i=jQuery('<div class="jo_ds_student_line">'),a=jQuery('<div class="jo_ds_student_class">'.concat(o.name,"</div>")),s=jQuery('<div class="jo_ds_student_name">'.concat(e.rufname," ").concat(e.familienname,"</div>"));i.append(a,s),t.append(i),i.on("mousedown",(function(){i.toggleClass("jo_active"),n.studentCount+=i.hasClass("jo_active")?1:-1,jQuery(".jo_ds_selected_message").text("".concat(n.studentCount," Schüler/inn/en selektiert"))})),i.data("student",e),i.data("klass",o)};for(a.s();!(r=a.n()).done;)s()}catch(e){a.e(e)}finally{a.f()}}}catch(e){i.e(e)}finally{i.f()}jQuery(".jo_ds_filterdiv>input").on("input",(function(){var e=jQuery(".jo_ds_filterdiv>input").val();null==e||""==e?$(".jo_ds_student_line").show():$(".jo_ds_student_line").each((function(t,n){var i=jQuery(n),r=i.data("klass"),o=i.data("student");(r.name+" "+o.rufname+" "+o.familienname).indexOf(e)>=0?i.show():i.hide()}))})),this.$dialogMain=this.$dialog.find(".dialog-main"),this.$dialog.css("visibility","visible"),jQuery("#jo_ds_cancel_button").on("click",(function(){n.close()})),jQuery("#jo_ds_distribute_button").on("click",(function(){n.distributeWorkspace()}))}},{key:"distributeWorkspace",value:function(){var e=this,t=[];$(".jo_ds_student_line").each((function(e,n){var i=jQuery(n);if(i.hasClass("jo_active")){var r=i.data("student");t.push(r.id)}})),this.close(),this.main.networkManager.sendDistributeWorkspace(this.workspace,null,t,(function(n){if(null==n){var i=e.main.networkManager,r=i.updateFrequencyInSeconds*i.forcedUpdateEvery;alert("Der Workspace ".concat(e.workspace.name," wurde an ").concat(t.length," Schüler/innen ausgeteilt. Er wird in maximal ").concat(r," s bei jedem Schüler ankommen."))}else alert(n)}))}},{key:"close",value:function(){this.$dialog.css("visibility","hidden"),this.$dialog.empty(),jQuery("#main").css("visibility","visible")}}])&&zn(t.prototype,n),i&&zn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Un(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Hn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Kn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Vn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.$projectexplorerDiv=n,this.programPointerModule=null,this.programPointerDecoration=[],this.lastOpenModule=null}var t,n,i;return t=e,(n=[{key:"initGUI",value:function(){this.accordion=new Rn(this.main,this.$projectexplorerDiv),this.initFilelistPanel(),this.initWorkspacelistPanel()}},{key:"initFilelistPanel",value:function(){var e=this;this.fileListPanel=new $n(this.accordion,"Kein Workspace gewählt","1","img_add-file-dark","Neue Datei...","java",!0,!1,"file",!0,[]),this.fileListPanel.newFilesElementCallback=function(t,n){if(null==e.main.currentWorkspace)return alert("Bitte wählen Sie zuerst einen Workspace aus."),null;var i={name:t.name,dirty:!1,saved:!0,text:"",text_before_revision:null,submitted_date:null,student_edited_after_revision:!1,version:1,panelElement:t},r=new tt(i,e.main);e.main.currentWorkspace.moduleStore.putModule(r),e.setModuleActive(r),e.main.networkManager.sendCreateFile(r,e.main.currentWorkspace,e.main.workspacesOwnerId,(function(e){null==e?n(r):alert("Der Server ist nicht erreichbar!")}))},this.fileListPanel.renameCallback=function(t,n){n=n.substr(0,80);var i=t.file;return i.name=n,i.saved=!1,e.main.networkManager.sendUpdates(),n},this.fileListPanel.deleteCallback=function(t,n){e.main.networkManager.sendDeleteWorkspaceOrFile("file",t.file.id,(function(i){null==i?(e.main.currentWorkspace.moduleStore.removeModule(t),n()):alert("Der Server ist nicht erreichbar!")}))},this.fileListPanel.contextMenuProvider=function(t){return e.main.user.is_teacher||e.main.user.is_admin||e.main.user.is_schooladmin||t.externalElement.file,[]},this.fileListPanel.selectCallback=function(t){e.setModuleActive(t)}}},{key:"renderHomeworkButton",value:function(e){var t,n,i=null===(n=null===(t=null==e?void 0:e.panelElement)||void 0===t?void 0:t.$htmlFirstLine)||void 0===n?void 0:n.find(".jo_additionalButtonHomework");if(null!=i){i.find(".jo_homeworkButton").remove();var r=null,o="";if(null!=e.submitted_date&&(r="img_homework",o="Wurde als Hausaufgabe abgegeben: "+e.submitted_date,e.text_before_revision&&(r="img_homework-corrected",o="Korrektur liegt vor.")),null!=r){var a=jQuery('<div class="jo_homeworkButton '.concat(r,'" title="').concat(o,'"></div>'));i.prepend(a),r.indexOf("jo_active")>=0&&(a.on("mousedown",(function(e){return e.stopPropagation()})),a.on("click",(function(e){e.stopPropagation()})))}}}},{key:"initWorkspacelistPanel",value:function(){var e=this,t=this;this.workspaceListPanel=new $n(this.accordion,"Datenbanken","3",null,"Neue Datenbank...","workspace",!0,!0,"workspace",!1,["file"]);var n=jQuery('<div class="img_add-database-dark jo_button jo_active" style="margin-right: 4px" title="Neue Datenbank auf oberster Ordnerebene anlegen">'),i=window.PointerEvent?"pointer":"mouse";n.on(i+"down",(function(n){n.stopPropagation();var i=t.main.user.id;null!=t.main.workspacesOwnerId&&(i=t.main.workspacesOwnerId),new Dn(t.main,i,e.workspaceListPanel.getCurrentlySelectedPath())})),this.workspaceListPanel.addAction(n),null!=this.workspaceListPanel.$buttonNew&&this.workspaceListPanel.$buttonNew.hide(),this.workspaceListPanel.newDatabaseElementCallback=function(e){var n=t.main.user.id;null!=t.main.workspacesOwnerId&&(n=t.main.workspacesOwnerId),new Dn(t.main,n,e)},this.workspaceListPanel.renameCallback=function(e,n){return n=n.substr(0,80),e.name=n,e.saved=!1,t.main.networkManager.sendUpdates(),n},this.workspaceListPanel.deleteCallback=function(e,n){t.main.networkManager.sendDeleteWorkspaceOrFile("workspace",e.id,(function(i){null==i?(t.main.removeWorkspace(e),t.fileListPanel.enableNewButton(t.main.workspaceList.length>0),t.fileListPanel.clear(),t.main.databaseExplorer.clear(),t.main.getResultsetPresenter().clear(),n()):alert("Der Server ist nicht erreichbar!")}))},this.workspaceListPanel.selectCallback=function(n){n.isFolder||n!=e.main.currentWorkspace&&t.main.networkManager.sendUpdates((function(){t.setWorkspaceActive(n)}))},this.workspaceListPanel.newFolderCallback=function(e,n){var i=t.main.user.id;null!=t.main.workspacesOwnerId&&(i=t.main.workspacesOwnerId);var r=new Nt(e.name,t.main,i);r.isFolder=!0,r.path=e.path.join("/"),r.panelElement=e,e.externalElement=r,t.main.workspaceList.push(r);var o={id:-1,isFolder:!0,name:r.name,path:r.path};t.main.networkManager.sendCreateWorkspace(o,t.main.workspacesOwnerId,(function(i){null==i?(r.id=o.id,n(r)):(alert("Fehler: "+i),t.workspaceListPanel.removeElement(e))}))},this.workspaceListPanel.moveCallback=function(t){Array.isArray(t)||(t=[t]);var n,i=Un(t);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=r.externalElement;o.path=r.path.join("/"),o.saved=!1}}catch(e){i.e(e)}finally{i.f()}e.main.networkManager.sendUpdates()},this.workspaceListPanel.dropElementCallback=function(e,n,i){var r=e.externalElement,o=n.externalElement;if(!(r.moduleStore.getModules(!1).indexOf(o)>=0)){var a={name:o.file.name,dirty:!0,saved:!1,text:o.file.text,text_before_revision:null,submitted_date:null,student_edited_after_revision:!1,version:o.file.version,panelElement:null};"move"==i&&(t.main.currentWorkspace.moduleStore.removeModule(o),t.fileListPanel.removeElement(o),t.main.networkManager.sendDeleteWorkspaceOrFile("file",o.file.id,(function(){})));var s=new tt(a,t.main);r.moduleStore.putModule(s),t.main.networkManager.sendCreateFile(s,r,t.main.workspacesOwnerId,(function(e){null==e||alert("Der Server ist nicht erreichbar!")}))}},this.$homeAction=jQuery('<div class="img_home-dark jo_button jo_active" style="margin-right: 4px" title="Meine eigenen Workspaces anzeigen">'),this.$homeAction.on(i+"down",(function(e){e.stopPropagation(),t.main.networkManager.sendUpdates((function(){t.onHomeButtonClicked()})),t.main.bottomDiv.hideHomeworkTab()})),this.workspaceListPanel.addAction(this.$homeAction),this.$homeAction.hide(),this.workspaceListPanel.contextMenuProvider=function(t){var n=[];return e.main.user.is_teacher&&e.main.teacherExplorer.classPanel.elements.length>0&&n.push({caption:"An Klasse austeilen...",callback:function(e){},subMenu:e.main.teacherExplorer.classPanel.elements.map((function(t){return{caption:t.name,callback:function(n){var i=t.externalElement,r=n.externalElement;e.main.networkManager.sendDistributeWorkspace(r,i,null,(function(t){if(null==t){var n=e.main.networkManager,o=n.updateFrequencyInSeconds*n.forcedUpdateEvery;alert("Der Workspace "+r.name+" wurde an die Klasse "+i.name+" ausgeteilt. Er wird in maximal "+o+" s bei jedem Schüler ankommen.")}else alert(t)}))}}}))},{caption:"An einzelne Schüler/innen austeilen...",callback:function(t){var n=e.main.teacherExplorer.classPanel.elements.map((function(e){return e.externalElement})),i=t.externalElement;new qn(n,i,e.main)}}),n}}},{key:"onHomeButtonClicked",value:function(){this.main.teacherExplorer.restoreOwnWorkspaces(),this.main.networkManager.updateFrequencyInSeconds=this.main.networkManager.ownUpdateFrequencyInSeconds,this.$homeAction.hide(),this.fileListPanel.enableNewButton(this.main.workspaceList.length>0)}},{key:"renderFiles",value:function(e){var t=null==e?"Kein Workspace vorhanden":e.name;if(this.fileListPanel.setCaption(t),this.fileListPanel.clear(),null!=this.main.getCurrentWorkspace()){var n,i=Un(this.main.getCurrentWorkspace().moduleStore.getModules(!1));try{for(i.s();!(n=i.n()).done;)n.value.file.panelElement=null}catch(e){i.e(e)}finally{i.f()}}if(null!=e){var r,o=[],a=Un(e.moduleStore.getModules(!1));try{for(a.s();!(r=a.n()).done;){var s=r.value;o.push(s)}}catch(e){a.e(e)}finally{a.f()}o.sort((function(e,t){return e.file.name>t.file.name?1:e.file.name<t.file.name?-1:0}));for(var l=0,u=o;l<u.length;l++){var c=u[l];c.file.panelElement={name:c.file.name,externalElement:c,isFolder:!1,path:[]},this.fileListPanel.addElement(c.file.panelElement,!0),this.renderHomeworkButton(c.file)}this.fileListPanel.sortElements()}}},{key:"renderWorkspaces",value:function(e){this.fileListPanel.clear(),this.workspaceListPanel.clear();var t,n=Un(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.path.split("/");1==r.length&&""==r[0]&&(r=[]),i.panelElement={name:i.name,externalElement:i,iconClass:"workspace",isFolder:i.isFolder,path:r},this.workspaceListPanel.addElement(i.panelElement,!1),i.renderSettingsButton(i.panelElement)}}catch(e){n.e(e)}finally{n.f()}this.workspaceListPanel.sortElements(),this.fileListPanel.enableNewButton(e.length>0)}},{key:"renderErrorCount",value:function(e,t){if(null!=t){var n,i=Un(e.moduleStore.getModules(!1));try{for(i.s();!(n=i.n()).done;){var r=n.value,o=t.get(r),a=null==o||0==o?"":"("+o+")";this.fileListPanel.setTextAfterFilename(r.file.panelElement,a,"jo_errorcount")}}catch(e){i.e(e)}finally{i.f()}}}},{key:"setWorkspaceActive",value:function(e){var t=this;null!=e&&this.fileListPanel.$buttonNew.show(),this.workspaceListPanel.select(e,!1);var n=function(n){t.initializeDatabaseTool(n,e)};null==e.database?(this.main.waitOverlay.show("Bitte warten, hole Datenbank vom Server ..."),this.main.networkManager.fetchDatabase(e,n)):n(null)}},{key:"initializeDatabaseTool",value:function(e,t){var n=this;if(null==e){var i=this.main.getDatabaseTool(),r=t.database.statements;null==r&&(r=[]),i.initializeWorker(t.database.templateDump,r,(function(){if(n.main.currentWorkspace=t,n.main.user.id==t.owner_id&&(n.main.user.currentWorkspace_id=t.id),n.renderFiles(t),null!=t){var e=t.moduleStore.getModules(!1);null!=t.currentlyOpenModule?n.setModuleActive(t.currentlyOpenModule):e.length>0?n.setModuleActive(e[0]):n.setModuleActive(null);var i,r=Un(e);try{for(r.s();!(i=r.n()).done;)i.value.file.dirty=!0}catch(e){r.e(e)}finally{r.f()}0==e.length&&rn.showHelper("newSQLFileHelper",n.main,n.fileListPanel.$captionElement),n.main.notifier.connect(t)}else n.setModuleActive(null)}),(function(){n.main.databaseExplorer.refreshAfterRetrievingDBStructure(),n.main.getHistoryViewer().clearAndShowStatements(t.database.statements)}))}else alert(e)}},{key:"writeEditorTextToFile",value:function(){var e=this.getCurrentlyEditedModule();null!=e&&(e.file.text=e.getProgramTextFromMonacoModel())}},{key:"setModuleActive",value:function(e){this.main.bottomDiv.homeworkManager.hideRevision(),null!=this.lastOpenModule&&(this.lastOpenModule.file.text=this.lastOpenModule.getProgramTextFromMonacoModel(),this.lastOpenModule.editorState=this.main.getMonacoEditor().saveViewState()),null==e?(this.main.getMonacoEditor().setModel(monaco.editor.createModel("Keine Datei vorhanden.","text")),this.main.getMonacoEditor().updateOptions({readOnly:!0})):(this.main.getMonacoEditor().updateOptions({readOnly:!1}),this.main.getMonacoEditor().setModel(e.model),null!=this.main.getBottomDiv()&&this.main.getBottomDiv().errorManager.showParenthesisWarning(e.bracketError),null!=e.file.text_before_revision?this.main.bottomDiv.homeworkManager.showHomeWorkRevisionButton():this.main.bottomDiv.homeworkManager.hideHomeworkRevisionButton())}},{key:"setActiveAfterExternalModelSet",value:function(e){var t=this;this.fileListPanel.select(e,!1),this.lastOpenModule=e,null!=e.editorState&&(this.main.editor.dontPushNextCursorMove++,this.main.getMonacoEditor().restoreViewState(e.editorState),this.main.editor.dontPushNextCursorMove--),this.setCurrentlyEditedModule(e),this.showProgramPointer(),setTimeout((function(){t.main.getMonacoEditor().getOptions().get(monaco.editor.EditorOption.readOnly)||t.main.getMonacoEditor().focus()}),300)}},{key:"showProgramPointer",value:function(){if(this.programPointerModule==this.getCurrentlyEditedModule()&&null!=this.getCurrentlyEditedModule()){var e=this.programPointerPosition,t={startColumn:e.column,startLineNumber:e.line,endColumn:e.column+e.length,endLineNumber:e.line};this.main.getMonacoEditor().revealRangeInCenterIfOutsideViewport(t),this.programPointerDecoration=this.main.getMonacoEditor().deltaDecorations(this.programPointerDecoration,[{range:t,options:{className:"jo_revealProgramPointer",isWholeLine:!0,overviewRuler:{color:"#6fd61b",position:monaco.editor.OverviewRulerLane.Center},minimap:{color:"#6fd61b",position:monaco.editor.MinimapPosition.Inline}}},{range:t,options:{beforeContentClassName:"jo_revealProgramPointerBefore"}}])}}},{key:"showProgramPointerPosition",value:function(e,t){if(null!=e){var n=this.main.currentWorkspace.moduleStore.findModuleByFile(e);null!=n&&(this.programPointerModule=n,this.programPointerPosition=t,n!=this.getCurrentlyEditedModule()?this.setModuleActive(n):this.showProgramPointer())}}},{key:"hideProgramPointerPosition",value:function(){this.getCurrentlyEditedModule()==this.programPointerModule&&this.main.getMonacoEditor().deltaDecorations(this.programPointerDecoration,[]),this.programPointerModule=null,this.programPointerDecoration=[]}},{key:"getCurrentlyEditedModule",value:function(){var e=this.main.currentWorkspace;return null==e?null:e.currentlyOpenModule}},{key:"setCurrentlyEditedModule",value:function(e){if(null!=e){var t=this.main.currentWorkspace;t.currentlyOpenModule!=e&&(t.currentlyOpenModule=e,t.saved=!1,e.file.dirty=!0)}}},{key:"setExplorerColor",value:function(e){var t;null==e?(e="transparent",t="Meine Datenbanken"):t="Schüler-DB",this.fileListPanel.$listElement.parent().css("background-color",e),this.workspaceListPanel.$listElement.parent().css("background-color",e),this.workspaceListPanel.setCaption(t)}},{key:"getNewModule",value:function(e){return new tt(e,this.main)}}])&&Kn(t.prototype,n),i&&Kn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Gn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Jn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.$rightDiv=n,this.isWholePage=!1,this.$tabs=n.find(".jo_tabs"),this.$headings=n.find(".jo_tabheadings");this.$headings.find(".jo_classDiagramTabHeading").length,this.$headings.find(".jo_objectDiagramTabHeading").length;var i=this,r="100%";n.find(".jo_whole-window").on("click",(function(){i.isWholePage=!i.isWholePage;var e=jQuery(".jo_whole-window");i.isWholePage?(jQuery("#code").css("display","none"),r=jQuery("#rightdiv").css("width"),jQuery("#rightdiv").css("width","100%"),e.removeClass("img_whole-window"),e.addClass("img_whole-window-back"),jQuery(".jo_control-container").append(jQuery("#controls")),e.attr("title","Auf normale Größe zurückführen"),jQuery(".jo_graphics").trigger("sizeChanged")):(jQuery("#code").css("display","flex"),jQuery("#rightdiv").css("width",r),e.removeClass("img_whole-window-back"),e.addClass("img_whole-window"),jQuery("#controls").insertAfter(jQuery("#view-mode")),e.attr("title","Auf Fenstergröße vergrößern"),jQuery(".jo_graphics").trigger("sizeChanged"))}))}var t,n,i;return t=e,(n=[{key:"initGUI",value:function(){dt(this.$rightDiv)}}])&&Gn(t.prototype,n),i&&Gn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Yn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Xn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t}var t,n,i;return t=e,(n=[{key:"initSliders",value:function(){var e=this,t=window.PointerEvent?"pointer":"mouse";jQuery("#slider1").on(t+"down",(function(n){var i=n.clientX;jQuery(document).on(t+"move.slider1",(function(t){var n=t.clientX-i;e.moveLeftPanel(n),i=t.clientX})),jQuery(document).on(t+"up.slider1",(function(){jQuery(document).off(t+"move.slider1"),jQuery(document).off(t+"up.slider1")}))})),jQuery("#slider2").on(t+"down",(function(n){var i=n.clientY;jQuery(document).on(t+"move.slider2",(function(t){var n=t.clientY-i;e.moveBottomDiv(n),i=t.clientY})),jQuery(document).on(t+"up.slider2",(function(){jQuery(document).off(t+"move.slider2"),jQuery(document).off(t+"up.slider2")}))})),jQuery("#slider3").on(t+"down",(function(n){var i=n.clientX;jQuery(document).on(t+"move.slider3",(function(t){var n=t.clientX-i;e.moveRightDiv(n),i=t.clientX,t.stopPropagation()})),jQuery(document).on(t+"up.slider3",(function(){jQuery(document).off(t+"move.slider3"),jQuery(document).off(t+"up.slider3")}))}));var n=jQuery('<div class="jo_sliderknob img_knob jo_button jo_active" style="left: -8px" draggable="false"></div>');jQuery("#slider2").append(n),n.on(t+"down",(function(n){var i=n.clientY,r=n.clientX;n.stopImmediatePropagation(),jQuery(document).on(t+"move.knobleft",(function(t){var n=t.clientY-i,o=t.clientX-r;t.stopImmediatePropagation(),e.moveLeftPanel(o),e.moveBottomDiv(n),r+=o,i+=n})),jQuery(document).on(t+"up.knobleft",(function(){jQuery(document).off(t+"move.knobleft"),jQuery(document).off(t+"up.knobleft")}))}));var i=jQuery('<div class="jo_sliderknob img_knob jo_button jo_active" style="right: -8px" draggable="false"></div>');jQuery("#slider2").append(i),i.on(t+"down",(function(n){var i=n.clientY,r=n.clientX;n.stopImmediatePropagation(),jQuery(document).on(t+"move.knobright",(function(t){var n=t.clientY-i,o=t.clientX-r;t.stopImmediatePropagation(),e.moveRightDiv(o),e.moveBottomDiv(n),r+=o,i+=n})),jQuery(document).on(t+"up.knobright",(function(){jQuery(document).off(t+"move.knobright"),jQuery(document).off(t+"up.knobright")}))}))}},{key:"moveRightDiv",value:function(e){var t=jQuery("#editor>.monaco-editor"),n=jQuery("#rightdiv"),i=Number.parseInt(n.css("width").replace("px",""));n.css("width",i-e+"px");var r=Number.parseInt(t.css("width").replace("px",""));t.css("width",r+e+"px"),this.main.getMonacoEditor().layout(),null!=this.main.bottomDiv.homeworkManager.diffEditor&&this.main.bottomDiv.homeworkManager.diffEditor.layout(),jQuery(".jo_graphics").trigger("sizeChanged"),i+=e}},{key:"moveBottomDiv",value:function(e){var t=jQuery("#editor>.monaco-editor"),n=jQuery("#bottomdiv-outer"),i=Number.parseInt(n.css("height").replace("px",""));n.css("height",i-e+"px");var r=Number.parseInt(t.css("height").replace("px",""));t.css("height",r+e+"px"),this.main.getMonacoEditor().layout(),null!=this.main.bottomDiv.homeworkManager.diffEditor&&this.main.bottomDiv.homeworkManager.diffEditor.layout()}},{key:"moveLeftPanel",value:function(e){var t=jQuery("#leftpanel"),n=jQuery("#editor>.monaco-editor"),i=Number.parseInt(t.css("width").replace("px",""));t.css("width",i+e+"px");var r=Number.parseInt(n.css("width").replace("px",""));n.css("width",r-e+"px"),this.main.getMonacoEditor().layout(),null!=this.main.bottomDiv.homeworkManager.diffEditor&&this.main.bottomDiv.homeworkManager.diffEditor.layout()}}])&&Yn(t.prototype,n),i&&Yn(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Zn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ei(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ei(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ei(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ti(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ni=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.classData=n}var t,n,i;return t=e,(n=[{key:"removePanels",value:function(){this.classPanel.remove(),this.studentPanel.remove()}},{key:"initGUI",value:function(){this.initStudentPanel(),this.initClassPanel(),this.renderClasses(this.classData)}},{key:"initStudentPanel",value:function(){var e=this,t=this;this.studentPanel=new $n(this.main.projectExplorer.accordion,"Schüler/innen","2",null,"","student",!1,!1,"student",!1,[]),this.studentPanel.selectCallback=function(n){t.main.networkManager.sendUpdates((function(){gt("getWorkspaces",{ws_userId:n.id,userId:e.main.user.id,language:1},(function(i){1==i.success&&(t.main.workspacesOwnerId==t.main.user.id&&(t.ownWorkspaces=t.main.workspaceList.slice(),t.currentOwnWorkspace=t.main.currentWorkspace),t.main.restoreWorkspaces(i.workspaces),t.main.workspacesOwnerId=n.id,t.main.projectExplorer.setExplorerColor("rgba(255, 0, 0, 0.2"),t.main.projectExplorer.$homeAction.show(),rn.showHelper("homeButtonHelper",e.main),t.main.bottomDiv.showHomeworkTab(),t.main.bottomDiv.homeworkManager.attachToWorkspaces(t.main.workspaceList)),e.main.networkManager.updateFrequencyInSeconds=e.main.networkManager.teacherUpdateFrequencyInSeconds,e.main.networkManager.secondsTillNextUpdate=e.main.networkManager.teacherUpdateFrequencyInSeconds}))}))}}},{key:"restoreOwnWorkspaces",value:function(){var e=this.main;e.getMonacoEditor().updateOptions({readOnly:!0}),e.workspaceList=this.ownWorkspaces,e.currentWorkspace=this.currentOwnWorkspace,e.workspacesOwnerId=e.user.id,e.projectExplorer.setExplorerColor(null),e.projectExplorer.renderWorkspaces(e.workspaceList),null==e.currentWorkspace&&e.workspaceList.length>0&&(e.currentWorkspace=e.workspaceList[0]),null!=e.currentWorkspace&&e.projectExplorer.setWorkspaceActive(e.currentWorkspace),this.studentPanel.select(null,!1)}},{key:"initClassPanel",value:function(){var e=this,t=this;this.classPanel=new $n(this.main.projectExplorer.accordion,"Klassen","1",null,"","class",!1,!1,"class",!1,[]),this.classPanel.selectCallback=function(n){t.main.networkManager.sendUpdates((function(){var t=n;null!=t&&e.renderStudents(t.students)}))}}},{key:"renderStudents",value:function(e){this.studentPanel.clear(),e.sort((function(e,t){return e.familienname>t.familienname?1:t.familienname>e.familienname?-1:e.rufname>t.rufname?1:t.rufname>e.rufname?-1:0}));var t,n=Zn(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,r={name:i.familienname+", "+i.rufname,sortName:i.familienname+" "+i.rufname,externalElement:i,isFolder:!1,path:[]};this.studentPanel.addElement(r,!0)}}catch(e){n.e(e)}finally{n.f()}}},{key:"renderClasses",value:function(e){this.studentPanel.clear(),e.sort((function(e,t){return e.name>t.name?1:t.name>e.name?-1:0}));var t,n=Zn(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,r={name:i.name,externalElement:i,isFolder:!1,path:[]};this.classPanel.addElement(r,!0)}}catch(e){n.e(e)}finally{n.f()}}}])&&ti(t.prototype,n),i&&ti(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ii(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ri(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oi(e,t,n){return t&&ri(e.prototype,t),n&&ri(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var ai=function(){function e(t){ii(this,e),this.main=t}return oi(e,[{key:"init",value:function(){jQuery("#buttonUserSettings")}}]),e}();function si(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var li=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t}var t,n,i;return t=e,(n=[{key:"initGUI",value:function(){var e=this,t=this,n=jQuery("#login-spinner>img");jQuery("#login-username").focus(),jQuery("#login-username").on("keydown",(function(e){"Enter"==e.key&&jQuery("#login-password").focus()})),jQuery("#login-password").on("keydown",(function(e){"Enter"==e.key&&jQuery("#login-button").trigger("click")})),jQuery("#login-password").on("keydown",(function(e){"Tab"==e.key&&(e.preventDefault(),jQuery("#login-button").focus(),jQuery("#login-button").addClass("jo_active")),"Enter"==e.key&&jQuery("#login-button").trigger("click")})),jQuery("#login-button").on("keydown",(function(e){"Tab"==e.key?(e.preventDefault(),jQuery("#login-username").focus(),jQuery("#login-button").removeClass("jo_active")):jQuery("#login-button").trigger("click")}));var i=!1;jQuery("#login-button").on("click",(function(){n.show(),i||(i=!0,setTimeout((function(){i=!1}),1e3),gt("login",{username:jQuery("#login-username").val(),password:jQuery("#login-password").val(),language:1},(function(i){if(i.success){jQuery("#login").hide(),e.main.waitOverlay.show("Bitte warten...");var r=i.user;null!=r.settings&&null!=r.settings.helperHistory||(r.settings={helperHistory:{},viewModes:null,classDiagram:null}),e.main.waitForGUICallback=function(){t.main.mainMenu.initGUI(r),t.main.waitOverlay.hide(),n.hide(),jQuery("#menupanel-username").html(Ne(r.rufname)+" "+Ne(r.familienname)),new ai(t.main).init(),r.is_teacher&&t.main.initTeacherExplorer(i.classdata),t.main.user=r,t.main.restoreWorkspaces(i.workspaces),t.main.workspacesOwnerId=r.id,t.main.networkManager.initializeTimer(),t.main.projectExplorer.fileListPanel.setFixed(!r.is_teacher),t.main.projectExplorer.workspaceListPanel.setFixed(!r.is_teacher),t.main.viewModeController.initViewMode(),t.main.bottomDiv.hideHomeworkTab(),t.main.networkManager.initializeNotifierClient()},0==e.main.startupComplete&&(e.main.waitForGUICallback(),e.main.waitForGUICallback=null)}else jQuery("#login-message").html("Fehler: Benutzername und/oder Passwort ist falsch.")}),(function(e){jQuery("#login-message").html("Login gescheitert: "+e),jQuery("#login-spinner>img").hide()})))})),jQuery("#buttonLogout").on("click",(function(){e.main.waitOverlay.show("Bitte warten, der letzte Bearbeitungsstand wird noch gespeichert ..."),e.main.workspacesOwnerId!=e.main.user.id&&e.main.projectExplorer.onHomeButtonClicked(),e.main.networkManager.sendUpdates((function(){var t;gt("logout",{currentWorkspaceId:null===(t=e.main.currentWorkspace)||void 0===t?void 0:t.id},(function(){e.main.networkManager.sendUpdateUserSettings((function(){})),jQuery("#login").show(),e.main.waitOverlay.hide(),jQuery("#login-message").empty(),e.main.getMonacoEditor().setModel(monaco.editor.createModel("","myJava")),e.main.projectExplorer.fileListPanel.clear(),e.main.projectExplorer.workspaceListPanel.clear(),e.main.databaseExplorer.clear(),e.main.resultsetPresenter.clear(),e.main.user.is_teacher&&(e.main.teacherExplorer.removePanels(),e.main.teacherExplorer=null),e.main.currentWorkspace=null,e.main.user=null}))}),!0)}))}}])&&si(t.prototype,n),i&&si(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ui(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ci=function(){function e(t,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$buttonsContainer=t,this.main=n,this.$buttonMap={},this.highContrast=!1,this.editorHasFullWidth=!1,this.$buttonEditorFullscreen=jQuery('<div title="Editor in voller Breite" class="img_whole-window jo_button jo_active" style="padding: 1px; margin-right: 20px"></div>'),this.$buttonPresentationMode=jQuery('<div title="Präsentation (Beamer)" class="img_presentation-mode jo_button jo_active" syle="padding: 1px"></div>'),this.$buttonMonitorMode=jQuery('<div title="Monitor" class="img_monitor-mode jo_button jo_active" style="margin-left: 5px; padding: 1px"></div>'),t.append(this.$buttonEditorFullscreen,this.$buttonPresentationMode,this.$buttonMonitorMode),this.$buttonMap={presentation:this.$buttonPresentationMode,monitor:this.$buttonMonitorMode};var r=this.main.actionManager;r.registerAction("editor.fullwidth",[],(function(){i.toggleEditorFullwidth()}),"Editor auf die volle Breite erweitern",this.$buttonEditorFullscreen),r.registerAction("viewmode.presentation",[],(function(){i.setMode("presentation")}),"Präsentationsansicht",this.$buttonPresentationMode),r.registerAction("viewmode.monitor",[],(function(){i.setMode("monitor")}),"Monitoransicht",this.$buttonMonitorMode)}var t,n,i;return t=e,(n=[{key:"toggleEditorFullwidth",value:function(){var e=this;this.editorHasFullWidth?(this.$buttonEditorFullscreen.removeClass("img_whole-window-back"),this.$buttonEditorFullscreen.addClass("img_whole-window"),this.$buttonEditorFullscreen.attr("title","Editor in voller Breite"),jQuery("#rightdiv").show(600),jQuery("#leftpanel").show(600),jQuery("#controls").show()):(this.$buttonEditorFullscreen.removeClass("img_whole-window"),this.$buttonEditorFullscreen.addClass("img_whole-window-back"),this.$buttonEditorFullscreen.attr("title","Editor in normaler Breite"),jQuery("#rightdiv").hide(600),jQuery("#leftpanel").hide(600),jQuery("#controls").hide()),setTimeout((function(){e.main.getMonacoEditor().layout()}),800),this.editorHasFullWidth=!this.editorHasFullWidth}},{key:"setMode",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="presentation"==e?"monitor":"presentation";this.$buttonMap[e].addClass("jo_pressed"),this.$buttonMap[n].removeClass("jo_pressed");var i=this.main.user.settings,r=i.viewModes,o=r[e];if(r.viewModeChosen=e,this.main.themeManager.switchTheme(o.theme),this.main.editor.setFontSize(o.fontSize),this.highContrast!=o.highContrast){var a=this.main.getMonacoEditor();a.getAction("editor.action.toggleHighContrast").run(),this.highContrast=!this.highContrast}t&&this.saveSettings()}},{key:"saveFontSize",value:function(e){this.getChosenViewMode().fontSize=e,this.saveSettings()}},{key:"setTheme",value:function(e){var t=this.getChosenViewMode();t.theme=e,this.main.themeManager.switchTheme(t.theme),this.saveSettings()}},{key:"toggleHighContrast",value:function(){var e=this.getChosenViewMode();e.highContrast=!e.highContrast,this.main.getMonacoEditor().getAction("editor.action.toggleHighContrast").run(),this.saveSettings()}},{key:"getChosenViewMode",value:function(){var e=this.main.user.settings.viewModes;return e[e.viewModeChosen]}},{key:"saveSettings",value:function(){this.main.userDataDirty=!0}},{key:"initViewMode",value:function(){var e=this.main.user.settings;null==e.viewModes&&(e.viewModes={monitor:null,presentation:null,viewModeChosen:"monitor"}),null==e.viewModes.monitor&&(e.viewModes.monitor={fontSize:14,highContrast:!1,theme:"dark"},e.viewModes.presentation={fontSize:18,highContrast:!1,theme:"light"},this.saveSettings()),this.setMode(e.viewModes.viewModeChosen,!1)}}])&&ui(t.prototype,n),i&&ui(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function di(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var hi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.semicolonPositions=[]}var t,n,i;return t=e,(n=[{key:"startRegistering",value:function(){this.semicolonPositions.forEach((function(e){return e.isThereAgain=!1})),this.time=(new Date).getTime()}},{key:"register",value:function(e,t){var n=this.semicolonPositions.find((function(t){return t.position.line==e.line&&t.position.column==e.column}));n?n.isThereAgain=!0:this.semicolonPositions.push({position:e,firstSeenMs:this.time,isThereAgain:!0,module:t})}},{key:"healSemicolons",value:function(){var e=this,t=(new Date).getTime();this.semicolonPositions=this.semicolonPositions.filter((function(e){return e.isThereAgain}));var n=this.main.getCurrentlyEditedModule(),i=this.main.getMonacoEditor().getPosition().lineNumber;this.semicolonPositions.filter((function(e){return t-e.firstSeenMs>2e3})).forEach((function(t){var r=null!=t.module.file.id&&t.module.file.id==n.file.id,o=[{range:new monaco.Range(t.position.line,t.position.column,t.position.line,t.position.column),text:";",forceMoveMarkers:!0}];if(r&&Math.abs(i-t.position.line)>1){var a=e.main.getMonacoEditor(),s=a.getSelection();a.executeEdits("Semicolon-Angel",o),a.setSelection(s),e.semicolonPositions.splice(e.semicolonPositions.indexOf(t),1)}}))}}])&&di(t.prototype,n),i&&di(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function fi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return mi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mi(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function mi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function pi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var vi=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.$mainDiv=n,this.collapsedTables=new Map}var t,n,i;return t=e,(n=[{key:"refresh",value:function(){var e=this;this.main.getDatabaseTool().retrieveDatabaseStructure((function(t){e.refreshAfterRetrievingDBStructure()}))}},{key:"clear",value:function(){this.$mainDiv.empty()}},{key:"refreshAfterRetrievingDBStructure",value:function(){var e=this.main.getDatabaseTool(),t=this.main.getCurrentWorkspace();if(null!=t){var n,i=fi(t.moduleStore.getModules(!1));try{for(i.s();!(n=i.n()).done;)n.value.file.dirty=!0}catch(e){i.e(e)}finally{i.f()}}var r=Se.fromTableStructureList(e.databaseStructure.tables);this.$mainDiv.empty();var o,a=fi(r);try{for(a.s();!(o=a.n()).done;){var s=o.value;if("sqlite_sequence"!=s.identifier){var l=this.renderTable(s);this.$mainDiv.append(l)}}}catch(e){a.e(e)}finally{a.f()}}},{key:"renderTable",value:function(e){var t=this,n=null!=this.collapsedTables.get(e.identifier),i=jQuery('<div class="jo_table">\n           <div class="jo_tableheader">\n              <div class="'.concat(n?"img_tree-collapsed-dark":"img_tree-expanded-dark",' jo_treeswitch jo_button jo_active"></div>\n              <div class="jo_tableheaderlink">\n                <div class="img_table"></div>\n                <div>').concat(e.identifier,'</div></div><div class="jo_tablesize">(').concat(e.size,"&nbsp;Datensätze)</div>\n              </div>\n            </div>\n        </div>"));i.find(".jo_tableheader").on("pointerup",(function(){t.main.getResultsetPresenter().showTable(e.identifier)}));var r,o=jQuery('<div class="jo_columnlist"></div>'),a=fi(e.columns);try{for(a.s();!(r=a.n()).done;){var s=r.value,l=s.isPrimaryKey?"img_key":"img_column",u="";null!=s.references&&(u='<div class="img_foreign_key" style="margin-left: 5px"></div><div class="jo_references">'.concat(s.references.table.identifier,".").concat(s.references.identifier,"</div>"));var c=null==s.type?"":s.type.toString(),d=s.notNull?'<div class="jo_dbnotnull">not null</div>':"",h=s.defaultValue?'<div class="jo_dbdefault">default '.concat(s.defaultValue,"</div>"):"",f=s.isAutoIncrement?'<div class="jo_dbautoincrement">autoincrement</div>':"",m=jQuery('\n            <div class="jo_column">\n                <div class="'.concat(l,'"></div>\n                <div>').concat(s.identifier,'</div>\n                <div class="jo_dbtype">').concat(c,"</div>\n                ").concat(f,"\n                ").concat(u,"\n                ").concat(d,"\n                ").concat(h,"\n            </div>\n            "));o.append(m)}}catch(e){a.e(e)}finally{a.f()}i.append(o);var p=i.find(".jo_treeswitch"),v=this;return p.on("pointerup",(function(t){t.stopPropagation();var n=p.parents(".jo_table").find(".jo_columnlist");p.hasClass("img_tree-collapsed-dark")?(p.removeClass("img_tree-collapsed-dark"),p.addClass("img_tree-expanded-dark"),n.slideDown(300),v.collapsedTables.delete(e.identifier)):(p.removeClass("img_tree-expanded-dark"),p.addClass("img_tree-collapsed-dark"),n.slideUp(300),v.collapsedTables.set(e.identifier,!0))})),i}}])&&pi(t.prototype,n),i&&pi(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function yi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gi(e,t,n){return t&&yi(e.prototype,t),n&&yi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var bi=gi((function e(t,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.$buttonsContainer=n,this.$buttonStart=jQuery('<div title="Start" class="img_start-dark jo_button"></div>'),this.$buttonRollback=jQuery('<div title="Rollback" class="img_undo jo_button"></div>');var r=this.main.getActionManager();r.registerAction("execute",["Strg + Enter"],(function(){r.isActive("execute")&&i.main.getResultsetPresenter().executeSelectedStatements()}),"SQL-Statement ausführen",this.$buttonStart),r.setActive("execute",!1),r.registerAction("rollback",["Strg + LeftArrow"],(function(){r.isActive("rollback")&&i.main.getHistoryViewer().rollback()}),"Letztes schreibendes SQL-Statement rückgängig machen",this.$buttonRollback),r.setActive("rollback",!1),n.append(this.$buttonStart,this.$buttonRollback)}));function ki(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return wi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wi(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function wi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ci(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ti=function(){function e(t,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.$bottomDiv=n,this.paginationSize=1e3,this.writeQueryListeners=[],this.oldErrorDecorations=[],this.showResultsBusy=!1,this.showResultPending=!1,this.$paginationDiv=jQuery(".jo_pagination"),this.$arrowLeft=jQuery('<div class="jo_button img_arrow-left-dark jo_active"></div>'),this.$infoDiv=jQuery('<div class="jo_pagination_info"><span class="jo_pagination_fromto">0001 - 1000</span> von <span class="jo_pagination_all">5000</span></div>'),this.$arrowRight=jQuery('<div class="jo_button img_arrow-right-dark jo_active"></div>'),this.$paginationDiv.append(this.$arrowLeft,this.$infoDiv,this.$arrowRight),this.$paginationDiv.hide();var r=(window.PointerEvent?"pointer":"mouse")+"up",o=this;this.$arrowLeft.on(r,(function(e){o.paginationFrom>1&&(o.paginationFrom=Math.max(o.paginationFrom-o.paginationSize,1),o.paginationFrom%1e3!=1&&(o.paginationFrom=(Math.floor(o.paginationFrom/o.paginationSize)+1)*o.paginationSize+1),o.showResults(),o.activateButtons())})),this.$arrowRight.on(r,(function(e){o.paginationFrom<i.paginationAll-o.paginationSize+1&&(o.paginationFrom=Math.min(o.paginationFrom+o.paginationSize,o.paginationAll-o.paginationSize+1),o.showResults(),o.activateButtons())}))}var t,n,i;return t=e,(n=[{key:"addWriteQueryListener",value:function(e){this.writeQueryListeners.push(e)}},{key:"activateButtons",value:function(){this.$arrowLeft.toggleClass("jo_active",this.paginationFrom>1),this.$arrowRight.toggleClass("jo_active",this.paginationFrom<this.paginationAll-this.paginationSize+1)}},{key:"executeSelectedStatements",value:function(){var e=this,t=this.fetchSelectedStatements().filter((function(e){return e.ast.type!=r.omittedeStatement}));if(0!=t.length){var n=t.some((function(t){return e.isDDLStatement(t)})),i=t.some((function(t){return e.isWriteStatement(t)})),o=this.main.getCurrentWorkspace(),a=o.database;n&&o.permissions<=1?alert("Der Benutzer hat keine Berechtigung zum Ändern der Tabellenstruktur."):i&&0==o.permissions?alert("Der Benutzer hat keine Berechtigung zum Einfügen/Löschen/Ändern von Datensätzen."):n||i?this.main.isEmbedded()?this.executeDDLWriteStatementsEmbedded(o,t,a):this.executeDDLWriteStatementsInOnlineIDE(o,t,a):this.executeStatements(t,0,[],(function(){}))}}},{key:"executeDDLWriteStatementsEmbedded",value:function(e,t,n){var i=this,r=[];this.executeStatements(t,0,r,(function(){0!=r.length&&(i.main.getDatabaseExplorer().refresh(),i.writeQueryListeners.forEach((function(e){return e.notify(r)})))}))}},{key:"executeDDLWriteStatementsInOnlineIDE",value:function(e,t,n){var i=this,r=this.main;r.networkManager.getNewStatements(e,(function(o,a){r.notifier.executeNewStatements(o,a,(function(){}),(function(){var o=[];i.executeStatements(t,0,o,(function(){0!=o.length&&r.networkManager.AddDatabaseStatements(e,o.map((function(e){return null==e.sqlCleaned?e.sql:e.sqlCleaned})),(function(e,t){e.forEach((function(e){return n.statements.push(e)})),i.main.getHistoryViewer().appendStatements(e);var a=o.map((function(e){return null==e.sqlCleaned?e.sql:e.sqlCleaned}));n.statements=n.statements.concat(a),i.main.getHistoryViewer().appendStatements(a),n.version=t,e.length>0?i.resetDatabase(n):r.getDatabaseExplorer().refresh()}))}))}),!1)}))}},{key:"resetDatabase",value:function(e){var t=this;this.main.getDatabaseTool().initializeWorker(e.templateDump,e.statements,(function(){t.main.getDatabaseExplorer().refresh()}))}},{key:"executeStatementsString",value:function(e,t,n){var i=this;0!=e.length&&t<e.length?this.main.getDatabaseTool().executeQuery(e[t],(function(r){i.executeStatementsString(e,t+1,n)}),(function(r){console.log("Error when executing statement "+e[t]+"\nError : "+r),i.executeStatementsString(e,t+1,n)})):n()}},{key:"executeStatements",value:function(e,t,n,i){var o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(t>=e.length)return this.showErrors(a),void i();var s=e[t],l=function(){o.executeStatements(e,t+1,n,i,a)};if(null!=s.ast)if(s.ast.type==r.keywordSelect){for(var u=!1,c=t+1;c<e.length;c++)u=u||this.isSelectStatement(e[c]);if(u)l();else{if(null==s.ast.limitNode){for(s.sql.trimRight();s.sql.endsWith(";")||s.sql.endsWith("\n")||s.sql.endsWith("\r");)s.sql=s.sql.substring(0,s.sql.length-1),s.sql.trimRight();s.sql+=" limit 100000"}this.main.getDatabaseTool().executeQuery(s.sql,(function(e){o.presentResultsIntern(s.sql,e),l()}),(function(e){a.push({statement:s,message:e}),l()}))}}else{var d=(new gn).clean(s);console.log(d),this.main.getDatabaseTool().executeQuery(d,(function(e){n.push(s),l()}),(function(e){a.push({statement:s,message:e}),l()}))}else l()}},{key:"showErrorDecorations",value:function(e){var t,n={error:"#bc1616",warning:"#cca700",info:"#75beff"},i=(this.main.getMonacoEditor(),[]),r=[],o=ki(e);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=void 0,l=n.error;s="jo_revealErrorLine";var u=void 0;u=monaco.MarkerSeverity.Error,i.push({startLineNumber:a.statement.from.line,startColumn:a.statement.from.column,endLineNumber:a.statement.to.line,endColumn:a.statement.to.column,message:a.message,severity:u}),r.push({range:{startLineNumber:a.statement.from.line,startColumn:a.statement.from.column,endLineNumber:a.statement.to.line,endColumn:a.statement.to.column},options:{linesDecorationsClassName:s,minimap:{position:monaco.editor.MinimapPosition.Inline,color:l}}})}}catch(e){o.e(e)}finally{o.f()}var c=this.main.getCurrentlyEditedModule().model;monaco.editor.setModelMarkers(c,"test",i),this.oldErrorDecorations=c.deltaDecorations(this.oldErrorDecorations,r)}},{key:"showTable",value:function(e){var t=this,n="select * from "+e+";";this.main.getDatabaseTool().executeQuery(n,(function(e){t.presentResultsIntern(n,e)}),(function(e){}))}},{key:"showErrors",value:function(e){var t=this,n=this.$bottomDiv.find(".jo_errorsTab"),i=this.$bottomDiv.find(".jo_errorsTabheading");if(n.empty(),this.showErrorDecorations(e),0!=e.length){var r=window.PointerEvent?"pointer":"mouse";i.trigger(r+"down");var o=jQuery('<div class="jo_errorlist"></div>');n.append(o);var a,s=ki(e);try{var l=function(){var e=a.value,n=e.statement.sql;n=(n=n.replace(/\n/g," ")).replace(/\s\s+/g," ");var i=$('<div class="jo_error-line" style="flex-direction:column; width: fit-content"></div>');o.append(i),i.on(r+"down",(function(){var n={startColumn:e.statement.from.column,startLineNumber:e.statement.from.line,endColumn:e.statement.to.column,endLineNumber:e.statement.to.line};t.main.getMonacoEditor().revealRangeInCenter(n),o.find(".jo_error-line").removeClass("jo_active"),i.addClass("jo_active")}));var s=$('<div class="jo_sqlErrorStatement"></div>');i.append(s),monaco.editor.colorize(n,"vscSQL",{}).then((function(e){s.html(e)}));var l=$('<div class="jo_sqlErrorMessage">'+e.message+"</div>");i.append(l)};for(s.s();!(a=s.n()).done;)l()}catch(e){s.e(e)}finally{s.f()}}}},{key:"isSelectStatement",value:function(e){return null!=e.ast&&e.ast.type==r.keywordSelect}},{key:"isDDLStatement",value:function(e){return null!=e.ast&&[r.keywordCreate,r.keywordDrop,r.keywordAlter].indexOf(e.ast.type)>=0}},{key:"isWriteStatement",value:function(e){return null!=e.ast&&[r.keywordInsert,r.keywordDelete,r.keywordUpdate].indexOf(e.ast.type)>=0}},{key:"presentResultsIntern",value:function(e,t){var n=this.$bottomDiv.find(".jo_resultTabheading"),i=this.$bottomDiv.find(".jo_result-header"),r=window.PointerEvent?"pointer":"mouse";n.trigger(r+"down"),this.result=t.pop();var o=i;e=(e=(e=e.replace(/\n/g," ")).replace(/\s\s+/g," ")).replace(/limit 100000/g,""),monaco.editor.colorize(e,"vscSQL",{}).then((function(e){o.html(e)})),this.paginationAll=this.result?this.result.values.length:0,this.$infoDiv.find(".jo_pagination_all").html("".concat(this.paginationAll)),this.paginationFrom=1,this.$paginationDiv.show(),this.activateButtons(),this.showResults()}},{key:"clear",value:function(){this.$bottomDiv.find(".jo_result-body").empty(),this.$paginationDiv.hide()}},{key:"showResults",value:function(){var e=this,t=this.$bottomDiv.find(".jo_result-body");if(null==this.result)return this.$infoDiv.find(".jo_pagination_fromto").html("---"),void t.html("Die Datenbank lieferte eine leere Ergebnistabelle.");var n=this,i=0==this.paginationAll?0:this.paginationFrom,r=0==this.paginationAll?0:Math.min(this.paginationFrom+this.paginationSize-1,this.paginationAll);if(this.$infoDiv.find(".jo_pagination_fromto").html("".concat(i," - ").concat(r)),this.showResultsBusy){if(this.showResultPending)return;this.showResultPending=!0,setTimeout((function e(){n.showResultsBusy?setTimeout((function(){e()}),200):(n.showResultPending=!1,n.showResults())}),200)}else{this.showResultsBusy=!0;var o=jQuery("<table></table>"),a=jQuery("<tr></tr>");o.append(a),this.result.columns.forEach((function(e){a.append(jQuery("<th><div>".concat(e,"</div></th>")))}));var s=this.result.values.slice(this.paginationFrom-1,this.paginationFrom+this.paginationSize-1),l=0;!function n(){if(l<s.length){for(var i=function(e){var t=s[e],n=jQuery("<tr></tr>");o.append(n),t.forEach((function(e){n.append(jQuery("<td>".concat(e,"</td>")))}))},r=l;r<Math.min(l+200,s.length);r++)i(r);(l=Math.min(l+200,s.length))<s.length?setTimeout(n,30):(t.empty().append(o),e.showResultsBusy=!1)}}()}}},{key:"fetchSelectedStatements",value:function(){var e=this.main.getCurrentlyEditedModule();if(null==e)return null;var t,n=this.main.getMonacoEditor(),i=e.getSQLSTatementsAtSelection(n.getSelection()),r=ki(i);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.sql=n.getModel().getValueInRange({startColumn:o.from.column,startLineNumber:o.from.line,endColumn:o.to.column,endLineNumber:o.to.line})}}catch(e){r.e(e)}finally{r.f()}return i}}])&&Ci(t.prototype,n),i&&Ci(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function xi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Ti.StatementDelimiter=";\n\n";var ji=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.isOpen=!1,this.unsentMessages=[],this.isPolling=!1,this.counter=0,this.isLongPolling=!1,this.longPollCounter=0}var t,n,i;return t=e,(n=[{key:"connect",value:function(e){var t=this,n=this;this.workspace=e,this.database=e.database,this.isOpen&&this.connection.close(),gt("getWebSocketToken",{},(function(i){var r=(window.location.protocol.startsWith("https")?"wss://":"ws://")+window.location.host+"/servlet/websocket";t.connection=new WebSocket(r),t.connection.onerror=function(e){t.onError(e)},t.connection.onclose=function(e){t.onClose(e)},t.connection.onmessage=function(e){t.onMessage(e)},t.connection.onopen=function(n){var r={command:1,token:i.token,workspaceId:e.id,databaseId:e.database.id,databaseVersion:e.database.version};t.isOpen=!0,t.sendIntern(JSON.stringify(r)),t.onOpen()},setTimeout((function(){n.startLongPolling()}),2e3)}))}},{key:"sendIntern",value:function(e){if(this.isOpen)try{this.connection.send(e)}catch(e){console.log(e)}else this.unsentMessages.push(e)}},{key:"onClose",value:function(e){this.isOpen=!1}},{key:"disconnect",value:function(){this.sendIntern(JSON.stringify({command:4})),this.connection.close(),this.workspace=null}},{key:"onMessage",value:function(e){var t=this,n=JSON.parse(e.data);if(null!=n.command)switch(n.command){case 2:t.executeNewStatements(n.newStatements,n.firstNewStatementIndex,(function(){var e={command:2,databaseVersion:t.database.version};t.sendIntern(JSON.stringify(e))}));break;case 3:this.isOpen=!1,this.database=null,this.workspace=null;break;case 4:break;case 5:this.database.version>n.new_version&&this.main.getHistoryViewer().rollbackLocal(n.new_version)}}},{key:"executeNewStatements",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(null!=this.database){var o=this,a=t-(this.database.version+1);if(a>0)return n(),void i();a<0&&(e.splice(0,-a),t-=a);var s=e;s.length>0?this.main.resultsetPresenter.executeStatementsString(s,0,(function(){o.main.getHistoryViewer().appendStatements(s),o.database.statements=o.database.statements.concat(s),o.database.version=t+e.length-1,r&&o.main.databaseExplorer.refresh(),i()})):i()}}},{key:"onError",value:function(e){}},{key:"onOpen",value:function(){var e=this;this.isOpen=!0,this.unsentMessages.length>0&&(this.unsentMessages.forEach((function(t){return e.sendIntern(t)})),this.unsentMessages=[])}},{key:"startPolling",value:function(){this.isPolling||(this.isPolling=!0,this.poll())}},{key:"poll",value:function(){var e=this;setTimeout((function(){e.poll()}),6e3),e.isOpen||null==e.workspace||(this.getNewStatementsHttp(),e.counter++,10==e.counter&&(e.counter=0,e.connect(e.workspace)))}},{key:"getNewStatementsHttp",value:function(){var e=this;null!=this.workspace&&null!=this.database&&gt("getNewStatements",{workspaceId:this.workspace.id,version_before:this.workspace.database.version},(function(t){null!=t.rollbackToVersion?e.main.getHistoryViewer().rollbackLocal(t.rollbackToVersion):e.executeNewStatements(t.newStatements,t.firstNewStatementIndex,(function(){e.getNewStatementsHttp()}))}))}},{key:"startLongPolling",value:function(){this.isLongPolling||(this.isLongPolling=!0,this.longPoll())}},{key:"longPoll",value:function(){var e=this;if(e.isOpen||null==e.workspace)setTimeout((function(){e.longPoll()}),5e3);else{var t={workspaceId:e.workspace.id};$.ajax({type:"POST",async:!0,data:JSON.stringify(t),contentType:"application/json",url:"servlet/registerLongPollingListener",success:function(n){var i;console.log(n);var r=JSON.parse(n);!e.isOpen&&(null===(i=e.workspace)||void 0===i?void 0:i.id)==t.workspaceId&&r.success&&(e.executeNewStatements(r.newStatements,r.firstNewStatementIndex,(function(){e.getNewStatementsHttp()})),e.longPollCounter++,10==e.longPollCounter&&(e.longPollCounter=0,e.connect(e.workspace)),setTimeout((function(){e.longPoll()}),2e3))},error:function(n,i){var r;e.isOpen||(null===(r=e.workspace)||void 0===r?void 0:r.id)!=t.workspaceId||setTimeout((function(){e.longPoll()}),2e3)}})}}}])&&xi(t.prototype,n),i&&xi(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Si(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ei=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$waitDiv=t,this.visible=!1,this.fadeOutPending=!1,this.$bitteWartenText=t.find(".bitteWartenText"),this.$bitteWartenProgress=t.find(".bitteWartenProgress")}var t,n,i;return t=e,(n=[{key:"show",value:function(e){this.fadeOutPending=!1,this.$bitteWartenText.html(e),this.$bitteWartenProgress.html(""),this.visible||(this.visible=!0,this.$waitDiv.css("display","flex"),this.$waitDiv.hide(),this.$waitDiv.fadeIn(400))}},{key:"setProgress",value:function(e){this.$bitteWartenProgress.html(e)}},{key:"hide",value:function(){var e=this;this.visible&&(this.fadeOutPending=!0,setTimeout((function(){e.fadeOutPending&&(e.fadeOutPending=!1,e.$waitDiv.fadeOut(200,(function(){e.$waitDiv.css("display","none")})),e.visible=!1)}),50))}}])&&Si(t.prototype,n),i&&Si(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Di=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.$historyPanel=n,this.panelEntries=[]}var t,n,i;return t=e,(n=[{key:"clear",value:function(){this.$historyPanel.empty(),this.main.getActionManager().setActive("rollback",!1),this.panelEntries=[]}},{key:"clearAndShowStatements",value:function(e){this.clear(),this.appendStatements(e),this.main.getActionManager().setActive("rollback",e.length>0)}},{key:"appendStatements",value:function(e){var t=this;e.forEach((function(e){var n=t.makePanelEntry(e,t.panelEntries.length+1);t.$historyPanel.prepend(n.$div),t.panelEntries.unshift(n)})),e.length>0&&this.main.getActionManager().setActive("rollback",!0),this.makeLastButtonActive()}},{key:"makeLastButtonActive",value:function(){this.panelEntries.forEach((function(e){return e.$rollbackButton.removeClass("jo_active")})),this.panelEntries.length>0&&this.panelEntries[0].$rollbackButton.addClass("jo_active")}},{key:"makePanelEntry",value:function(e,t){var n=this,i=jQuery('<div class="jo_panelEntry"></div>'),r=jQuery('<div class="jo_panelEntryIndex">'.concat(t,".</div>")),o=jQuery('<div class="jo_panelEntryText"></div>'),a=e.substring(0,Math.min(400,e.length));e.length>400&&(a+="..."),o.text(a);var s=jQuery('<div class="img_copy jo_panelEntryCopyButton jo_active jo_button" title="In die Zwischenablage kopieren"></div>'),l=jQuery('<div class="img_undo jo_panelEntryRollbackButton jo_button" title="Rollback"></div>');s.on("click",(function(){pt(e)}));var u=window.PointerEvent?"pointer":"mouse";return l.on(u+"up",(function(e){e.preventDefault(),ct([{caption:"Abbrechen",callback:function(){}},{caption:"Ich bin mir sicher: rollback!",color:"#ff6060",callback:function(){n.rollback()}}],e.pageX+2,e.pageY+2),e.stopPropagation()})),i.append(r,o,s,l),{$div:i,statement:e,$rollbackButton:l}}},{key:"rollback",value:function(){var e=this;0!=this.panelEntries.length&&(this.main.isEmbedded()?(this.rollbackEmbedded(),this.main.getActionManager().setActive("rollback",this.panelEntries.length>0)):this.main.networkManager.rollback((function(t,n){null==t&&n&&e.rollbackLocal()})))}},{key:"rollbackLocal",value:function(e){var t=this,n=this.main.getCurrentWorkspace().database;for(null==e&&(e=n.version-1);n.version>e;)n.statements.pop(),n.version--;this.main.getDatabaseTool().initializeWorker(n.templateDump,n.statements,(function(){}),(function(){t.main.getDatabaseExplorer().refreshAfterRetrievingDBStructure(),t.panelEntries.shift().$div.remove(),t.makeLastButtonActive(),t.main.getActionManager().setActive("rollback",t.panelEntries.length>0)}))}},{key:"rollbackEmbedded",value:function(){var e=this,t=this.main;t.writeQueryManager.rollback(),this.main.getDatabaseTool().initializeWorker(t.initialTemplateDump,t.initialStatements.concat(t.writeQueryManager.writtenStatements),(function(){}),(function(){e.main.getDatabaseExplorer().refreshAfterRetrievingDBStructure(),e.panelEntries.shift().$div.remove(),e.makeLastButtonActive()}))}}])&&_i(t.prototype,n),i&&_i(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Pi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Li(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Li(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Li(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Oi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ii=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.workspaceList=[],this.startupComplete=2,this.version=0,this.userDataDirty=!1,this.waitOverlay=new Ei(jQuery(".bitteWarten")),this.historyViewer=new Di(this,jQuery(".jo_historyTab"))}var t,n,i;return t=e,(n=[{key:"isEmbedded",value:function(){return!1}},{key:"getCurrentWorkspace",value:function(){return this.currentWorkspace}},{key:"getMonacoEditor",value:function(){return this.editor.editor}},{key:"getRightDiv",value:function(){return this.rightDiv}},{key:"getBottomDiv",value:function(){return this.bottomDiv}},{key:"getCurrentlyEditedModule",value:function(){return this.projectExplorer.getCurrentlyEditedModule()}},{key:"getActionManager",value:function(){return this.actionManager}},{key:"getCompiler",value:function(){return this.compiler}},{key:"setModuleActive",value:function(e){this.projectExplorer.setModuleActive(e)}},{key:"getSemicolonAngel",value:function(){return this.semicolonAngel}},{key:"getDatabaseTool",value:function(){return this.databaseTool}},{key:"getDatabaseExplorer",value:function(){return this.databaseExplorer}},{key:"getResultsetPresenter",value:function(){return this.resultsetPresenter}},{key:"getWaitOverlay",value:function(){return this.waitOverlay}},{key:"getHistoryViewer",value:function(){return this.historyViewer}},{key:"initGUI",value:function(){matchMedia("(pointer:fine)").matches&&(ft=!0),this.login=new li(this),this.login.initGUI(),this.databaseTool=new mn(this),this.databaseExplorer=new vi(this,jQuery(".jo_db_tree")),this.actionManager=new at(null,this),this.actionManager.init(),this.networkManager=new Dt(this,jQuery("#bottomdiv-outer .jo_updateTimerDiv")),new Xn(this).initSliders(),this.mainMenu=new In(this),this.projectExplorer=new Vn(this,jQuery("#leftpanel>.jo_projectexplorer")),this.projectExplorer.initGUI(),this.bottomDiv=new Qi(this,jQuery("#bottomdiv-outer>.jo_bottomdiv-inner"),jQuery("body")),this.rightDiv=new Jn(this,jQuery("#rightdiv-inner")),this.rightDiv.initGUI(),this.checkStartupComplete(),this.themeManager=new k,this.viewModeController=new ci(jQuery("#view-mode"),this),this.semicolonAngel=new hi(this),new bi(this,jQuery("#controls")),this.resultsetPresenter=new Ti(this,jQuery(".jo_bottomdiv-inner")),this.notifier=new ji(this)}},{key:"initEditor",value:function(){this.editor=new ln(this,!0,!1),(new v).init(),this.editor.initGUI(jQuery("#editor"));var e=this;jQuery(window).on("resize",(function(t){jQuery("#bottomdiv-outer").css("height","450px"),jQuery("#editor").css("height",window.innerHeight-450-30-2+"px"),e.editor.editor.layout(),jQuery("#editor").css("height","")})),jQuery(window).trigger("resize"),this.checkStartupComplete()}},{key:"initTeacherExplorer",value:function(e){this.teacherExplorer=new ni(this,e),this.teacherExplorer.initGUI()}},{key:"checkStartupComplete",value:function(){this.startupComplete--,0==this.startupComplete&&this.start()}},{key:"start",value:function(){null!=this.waitForGUICallback&&this.waitForGUICallback();var e=this;setTimeout((function(){e.getMonacoEditor().layout()}),200),this.compiler=new Ge(this),this.startTimer(),$(window).on("unload",(function(){navigator.sendBeacon&&null!=e.user&&(e.networkManager.sendUpdates(null,!1),e.networkManager.sendUpdateUserSettings((function(){})))}))}},{key:"startTimer",value:function(){null!=this.timerHandle&&clearInterval(this.timerHandle);var e=this;this.timerHandle=setInterval((function(){e.compileIfDirty()}),500)}},{key:"compileIfDirty",value:function(){var e,t;if(null!=this.currentWorkspace&&this.currentWorkspace.moduleStore.isDirty()&&this.compiler.compilerStatus!=qe.compiling)try{this.compiler.compile(this.currentWorkspace.moduleStore);var n=null===(t=null===(e=this.bottomDiv)||void 0===e?void 0:e.errorManager)||void 0===t?void 0:t.showErrors(this.currentWorkspace);this.projectExplorer.renderErrorCount(this.currentWorkspace,n),this.editor.onDidChangeCursorPosition(null),this.projectExplorer&&this.version++}catch(e){console.error(e),this.compiler.compilerStatus=qe.error}}},{key:"removeWorkspace",value:function(e){this.workspaceList.splice(this.workspaceList.indexOf(e),1)}},{key:"restoreWorkspaces",value:function(e){this.workspaceList=[],this.currentWorkspace=null,this.getMonacoEditor().updateOptions({readOnly:!0});var t,n=null,i=Pi(e.workspaces);try{for(i.s();!(t=i.n()).done;){var r=t.value,o=Nt.restoreFromData(r,this);this.workspaceList.push(o),r.id==this.user.currentWorkspace_id&&(n=o)}}catch(e){i.e(e)}finally{i.f()}this.projectExplorer.renderWorkspaces(this.workspaceList),null==n&&this.workspaceList.length>0&&(n=this.workspaceList[0]),null!=n&&this.projectExplorer.setWorkspaceActive(n),0==this.workspaceList.length&&rn.showHelper("newDatabaseHelper",this,this.projectExplorer.workspaceListPanel.$captionElement)}},{key:"createNewWorkspace",value:function(e,t){return new Nt(e,this,t)}}])&&Oi(t.prototype,n),i&&Oi(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ai(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Mi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mi(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Mi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Bi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ni=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.$bottomDiv=n,this.$mainDiv=i,this.oldDecorations=[],this.oldErrorDecorations=[],this.minimapColor={},this.lightBulbOnClickFunctionList=[],this.minimapColor.error="#bc1616",this.minimapColor.warning="#cca700",this.minimapColor.info="#75beff",this.$bracket_warning=i.find(".jo_parenthesis_warning"),this.$bracket_warning.attr("title","Klammeralarm!"),this.$bracket_warning.children().attr("title","Klammeralarm!");var r=this;i.find(".jo_pw_undo").on("click",(function(){r.main.getMonacoEditor().trigger(".","undo",{})})).attr("title","Undo")}var t,n,i;return t=e,(n=[{key:"showParenthesisWarning",value:function(e){null!=e?(this.$bracket_warning.css("visibility","visible"),this.$bracket_warning.find(".jo_pw_heading").text(e)):this.$bracket_warning.css("visibility","hidden")}},{key:"showErrors",value:function(e){var t=this;this.lightBulbOnClickFunctionList=[];var n=new Map;this.$errorDiv=this.$bottomDiv.find(".jo_tabs>.jo_errorsTab"),this.$errorDiv.empty();var i,r=!1,o=e.moduleStore,a=this.main.getMonacoEditor(),s=Ai(o.getModules(!1));try{var l=function(){var e=i.value,o=[],s=[],l=[],u=e.getSortedAndFilteredErrors();n.set(e,e.getErrorCount());var c,d=Ai(u);try{for(d.s();!(c=d.n()).done;){var h=c.value,f=void 0,m=void 0,p=t.minimapColor[h.level];switch(h.level){case"error":f="jo_revealErrorLine",m="jo_borderLeftError";break;case"warning":f="jo_revealWarningLine",m="jo_borderLeftWarning";break;case"info":f="jo_revealInfoLine",m="jo_borderLeftInfo"}null!=h.quickFix&&function(){var n=h.quickFix,i="lb_"+Math.trunc(1e6*Math.random());f="jo_yellowLightBulb "+m+" "+i,t.lightBulbOnClickFunctionList.push({class:"."+i,onClickFunction:function(){var t=n.editsProvider(e.model.uri);a.executeEdits("",t.map((function(e){var t=e.edit.range;return{range:new monaco.Range(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn),text:e.edit.text,forceMoveMarkers:!0}})))},title:n.title})}(),t.processError(h,e,l);var v=void 0;switch(h.level){case"error":v=monaco.MarkerSeverity.Error;break;case"warning":v=monaco.MarkerSeverity.Warning;break;case"info":v=monaco.MarkerSeverity.Info}o.push({startLineNumber:h.position.line,startColumn:h.position.column,endLineNumber:h.position.line,endColumn:h.position.column+h.position.length,message:h.text,severity:v,relatedInformation:h.quickFix}),s.push({range:{startLineNumber:h.position.line,startColumn:h.position.column,endLineNumber:h.position.line,endColumn:h.position.column+h.position.length},options:{linesDecorationsClassName:f,minimap:{position:monaco.editor.MinimapPosition.Inline,color:p}}})}}catch(e){d.e(e)}finally{d.f()}if(monaco.editor.setModelMarkers(e.model,"test",o),e.oldErrorDecorations=e.model.deltaDecorations(e.oldErrorDecorations,s),t.oldDecorations=t.main.getMonacoEditor().deltaDecorations(t.oldDecorations,[]),l.length>0&&t.$errorDiv.length>0){r=!0;var y=jQuery('<div class="jo_error-filename">'+e.file.name+"&nbsp;</div>");t.$errorDiv.append(y);var g,b=Ai(l);try{for(b.s();!(g=b.n()).done;){var k=g.value;t.$errorDiv.append(k)}}catch(e){b.e(e)}finally{b.f()}}};for(s.s();!(i=s.n()).done;)l()}catch(e){s.e(e)}finally{s.f()}return!r&&this.$errorDiv.length>0&&this.$errorDiv.append(jQuery('<div class="jo_noErrorMessage">Keine Fehler gefunden :-)</div>')),this.registerLightbulbOnClickFunctions(),n}},{key:"registerLightbulbOnClickFunctions",value:function(){var e=this;setTimeout((function(){var t,n=Ai(e.lightBulbOnClickFunctionList);try{for(n.s();!(t=n.n()).done;){var i=t.value;jQuery(i.class).off("click",i.onClickFunction),jQuery(i.class).on("click",i.onClickFunction).attr("title",i.title)}}catch(e){n.e(e)}finally{n.f()}}),500)}},{key:"processError",value:function(e,t,n){var i=this,r=jQuery('<div class="jo_error-line"></div>'),o=jQuery('<span class="jo_error-position">[Z&nbsp;<span class="jo_linecolumn">'+e.position.line+'</span> Sp&nbsp;<span class="jo_linecolumn">'+e.position.column+"</span>]</span>:&nbsp;"),a="";switch(e.level){case"error":break;case"warning":a='<span class="jo_warning_category">Warnung: </span>';break;case"info":a='<span class="jo_info_category">Info: </span>'}var s=jQuery('<div class="jo_error-text">'+a+e.text+"</div>");r.append(o).append(s);var l=this;r.on("mousedown",(function(n){i.$errorDiv.find(".jo_error-line").removeClass("jo_active"),r.addClass("jo_active"),l.showError(t,e)})),n.push(r)}},{key:"showError",value:function(e,t){this.main instanceof Ii&&e!=this.main.projectExplorer.getCurrentlyEditedModule()&&this.main.projectExplorer.setModuleActive(e);var n=t.position,i={startColumn:n.column,startLineNumber:n.line,endColumn:n.column+n.length,endLineNumber:n.line};this.main.getMonacoEditor().revealRangeInCenter(i);var r="";switch(t.level){case"error":r="jo_revealError";break;case"warning":r="jo_revealWarning";break;case"info":r="jo_revealInfo"}this.oldDecorations=this.main.getMonacoEditor().deltaDecorations(this.oldDecorations,[{range:i,options:{className:r}}])}}])&&Bi(t.prototype,n),i&&Bi(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Fi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var $i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.$bottomDiv=n,this.showRevisionActive=!1,this.$homeworkTab=n.find(".jo_tabs>.jo_homeworkTab")}var t,n,i;return t=e,(n=[{key:"initGUI",value:function(){var e=this,t=this;this.$homeworkTab.append(this.$homeworkTabLeft=ht("","jo_homeworkTabLeft jo_scrollable")),this.$homeworkTab.append(this.$homeworkTabRight=ht("","jo_homeworkTabRight jo_scrollable")),jQuery("#view-mode").prepend(this.$showRevisionButton=ht("","jo_button jo_active jo_homeworkRevisionButton","")),this.$showRevisionButton.on("click",(function(){e.showRevisionActive?e.hideRevision():e.showRevision(t.main.getCurrentlyEditedModule())})),this.$showRevisionButton.hide(),jQuery("#diffEditor").hide()}},{key:"showHomeWorkRevisionButton",value:function(){this.$showRevisionButton.text(this.showRevisionActive?"Normalansicht":"Korrekturen zeigen"),this.$showRevisionButton.show()}},{key:"hideHomeworkRevisionButton",value:function(){this.$showRevisionButton.hide()}},{key:"showRevision",value:function(e){e.file.text=e.getProgramTextFromMonacoModel();var t=e.file;jQuery("#editor").hide(),jQuery("#diffEditor").show();var n=monaco.editor.createModel(t.text_before_revision,"myJava"),i=monaco.editor.createModel(t.text,"myJava");this.diffEditor=monaco.editor.createDiffEditor(document.getElementById("diffEditor"),{enableSplitViewResizing:!0,originalEditable:!1,readOnly:!0,renderSideBySide:!0}),this.diffEditor.setModel({original:n,modified:i}),this.showRevisionActive=!0,this.showHomeWorkRevisionButton()}},{key:"hideRevision",value:function(){this.showRevisionActive&&(jQuery("#diffEditor").hide(),this.diffEditor.dispose(),this.diffEditor=null,jQuery("#editor").show(),this.showRevisionActive=!1,this.showHomeWorkRevisionButton())}},{key:"attachToWorkspaces",value:function(e){var t=this,n=[],i={};e.forEach((function(e){e.moduleStore.getModules(!1).forEach((function(t){var r,o=t.file.submitted_date;if(null!=o){var a=(r=o.match(/^(\d{2})\.(\d{2})\.(\d{4}), (\d{2}):(\d{2})$/),new Date(Number.parseInt(r[3]),Number.parseInt(r[2]),Number.parseInt(r[1]),Number.parseInt(r[4]),Number.parseInt(r[5]))),s=function(e){return"".concat(Fe(e.getDate()),".").concat(Fe(e.getMonth()),".").concat(e.getFullYear())}(a),l=i[s];null==l&&(l={date:a,day:s,modules:[]},i[s]=l,n.push(l)),l.modules.push({module:t,workspace:e})}}))})),this.$homeworkTabLeft.empty(),this.$homeworkTabRight.empty();var r=this;this.$homeworkTabLeft.append(ht("","jo_homeworkHeading","Abgabetage:")),n.sort((function(e,t){return e.date.getFullYear()!=t.date.getFullYear()?-Math.sign(e.date.getFullYear()-t.date.getFullYear()):e.date.getMonth()!=t.date.getMonth()?-Math.sign(e.date.getMonth()-t.date.getMonth()):e.date.getDate()!=t.date.getDate()?-Math.sign(e.date.getDate()-t.date.getDate()):0}));var o=!0;n.forEach((function(e){e.modules.sort((function(e,t){return e.module.file.name.localeCompare(t.module.file.name)}));var n=ht("","jo_homeworkDate",e.day);t.$homeworkTabLeft.append(n),n.on("click",(function(i){t.$homeworkTabLeft.find(".jo_homeworkDate").removeClass("active"),n.addClass("jo_active"),r.select(e)})),o&&(o=!1,n.addClass("jo_active"),r.select(e))}))}},{key:"select",value:function(e){this.$homeworkTabRight.empty(),this.$homeworkTabRight.append(ht("","jo_homeworkHeading","Abgegebene Dateien:"));var t=this;e.modules.forEach((function(e){var n=jQuery('<div class="jo_homeworkEntry">Workspace <span class="jo_homework-workspace">\n                    '.concat(e.workspace.name,'</span>, Datei <span class="jo_homework-file">\n                    ').concat(e.module.file.name,"</span> (Abgabe: ").concat(e.module.file.submitted_date," )</div>"));t.$homeworkTabRight.append(n),n.on("click",(function(){t.main.projectExplorer.setWorkspaceActive(e.workspace),t.main.projectExplorer.setModuleActive(e.module),t.main.projectExplorer.fileListPanel.select(e.module,!1)}))}))}}])&&Fi(t.prototype,n),i&&Fi(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ri(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Qi=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.$bottomDiv=n,this.$mainDiv=i,this.$bottomDiv.find(".jo_tabheadings>.jo_homeworkTabheading").length>0&&(this.homeworkManager=new $i(t,n)),this.errorManager=new Ni(t,n,i)}var t,n,i;return t=e,(n=[{key:"initGUI",value:function(){dt(this.$bottomDiv),null!=this.homeworkManager&&this.homeworkManager.initGUI(),this.$bottomDiv.find(".jo_tabs").children().first().trigger("click")}},{key:"showHomeworkTab",value:function(){jQuery(".jo_homeworkTabheading").css("visibility","visible"),jQuery(".jo_homeworkTabheading").trigger("mousedown")}},{key:"hideHomeworkTab",value:function(){jQuery(".jo_homeworkTabheading").css("visibility","hidden"),jQuery(".jo_tabheadings").children().first().trigger("mousedown")}}])&&Ri(t.prototype,n),i&&Ri(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Wi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var zi=function(){function e(t,n,i,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$container=t,this.firstLast=n,this.horVert=i,this.callback=r,this.$otherDiv=o,this.initSlider()}var t,n,i;return t=e,(n=[{key:"initSlider",value:function(){var e=this,t=this;null==this.$otherDiv&&this.$container.parent().children().each((function(n,i){i!=e.$container[0]&&(t.$otherDiv=jQuery(i))})),this.$sliderDiv=jQuery('<div class="joe_slider"></div>'),this.$sliderDiv.css({width:this.horVert?"100%":"4px",height:this.horVert?"4px":"100%",cursor:this.horVert?"row-resize":"col-resize"}),this.firstLast?this.$sliderDiv.css({top:"0px",left:"0px"}):this.horVert?this.$sliderDiv.css({bottom:"0px",left:"0px"}):this.$sliderDiv.css({top:"0px",right:"0px"}),this.$container.append(this.$sliderDiv),this.$sliderDiv.on("mousedown",(function(e){var n=e.clientX,i=e.clientY;jQuery(document).on("mousemove.slider",(function(e){var r=e.clientX-n,o=e.clientY-i;t.slide(r,o),n=e.clientX,i=e.clientY})),jQuery(document).on("mouseup.slider",(function(){jQuery(document).off("mousemove.slider"),jQuery(document).off("mouseup.slider")}))})),setTimeout((function(){t.slide(1,1)}),600)}},{key:"setColor",value:function(e){this.$sliderDiv.css("background-color",e)}},{key:"slide",value:function(e,t){if(this.horVert){var n=Number.parseInt(this.$container.css("height").replace("px","")),i=Number.parseInt(this.$otherDiv.css("height").replace("px","")),r=this.firstLast?n-=t:n+=t,o=this.firstLast?i+=t:i-=t;this.$container.css("height",r+"px"),this.$otherDiv.css("height",o+"px"),this.callback(r)}else{var a=Number.parseInt(this.$container.css("width").replace("px","")),s=Number.parseInt(this.$otherDiv.css("width").replace("px","")),l=this.firstLast?a-=e:a+=e,u=this.firstLast?s+=e:s-=e;this.$container.css("width",l+"px"),this.$otherDiv.css("width",u+"px"),this.callback(l)}this.$container.css("flex","0 1 auto")}}])&&Wi(t.prototype,n),i&&Wi(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function qi(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ui(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ui(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ui(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Hi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ki=function(){function e(t,n,i){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.moduleStore=t,this.$fileListDiv=n,this.main=i,this.files=[];var o,a=this,s=qi(t.getModules(!1));try{for(s.s();!(o=s.n()).done;){var l=o.value;this.addModule(l)}}catch(e){s.e(e)}finally{s.f()}var u=n.parent(),c=jQuery('<div class="joe_addFileButton jo_button img_add-dark jo_active" title="Datei hinzufügen"></div>');u.append(c),c.on("click",(function(){var e=r.main.addModule({text:"",title:"Neue Datei.java",type:"sql"}),t=r.addModule(e);r.renameElement(t,(function(){a.currentFile!=t&&a.selectFile(t)}))}))}var t,n,i;return t=e,(n=[{key:"removeAllFiles",value:function(){var e=this;this.files.forEach((function(t){return e.removeFile(t)}))}},{key:"addHint",value:function(e){var t=this,n=jQuery('<div class="jo_file jo_hint" ><div class="jo_fileimage"></div><div class="jo_filename" style="line-height: 22px">'+e.title+'</div><div class="jo_additionalButtons"></div></div></div>');this.$fileListDiv.append(n);var i={module:null,$fileDiv:n,type:"hint",hint:e.text};this.files.push(i),n.on("click",(function(e){t.selectFile(i)}))}},{key:"addModule",value:function(e){var t=this,n=jQuery('<div class="jo_file jo_java" >\n        <div class="jo_fileimage"></div>\n        <div class="jo_filename" style="line-height: 22px">'.concat(e.file.name,'</div>\n        <div class="jo_additionalButtonStart"></div>\n        <div class="jo_delete img_delete jo_button jo_active" title="Datei löschen"></div></div></div>'));this.$fileListDiv.append(n);var i={module:e,$fileDiv:n,type:"sql"};return this.files.push(i),e.file.panelElement={name:e.file.name,$htmlFirstLine:n,isFolder:!1,path:[]},n.find(".jo_delete").on("mousedown",(function(e){t.onDelete(i,e)})),n.find(".jo_delete").on("click",(function(e){e.preventDefault(),e.stopPropagation()})),n.on("click",(function(e){t.selectFile(i)})),n[0].addEventListener("contextmenu",(function(e){e.preventDefault(),ct([{caption:"Umbenennen",callback:function(){t.renameElement(i,(function(){}))}}],e.pageX,e.pageY)}),!1),i}},{key:"onDelete",value:function(e,t){t.preventDefault(),t.stopPropagation();var n=this;ct([{caption:"Abbrechen",callback:function(){}},{caption:"Ich bin mir sicher: löschen!",color:"#ff6060",callback:function(){n.removeFile(e)}}],t.pageX+2,t.pageY+2)}},{key:"removeFile",value:function(e){e.$fileDiv.remove(),this.main.removeModule(e.module),this.files=this.files.filter((function(t){return t!=e})),this.currentFile==e&&(this.files.length>0?this.selectFile(this.files[0]):(this.main.getMonacoEditor().setValue("Keine Datei vorhanden."),this.main.getMonacoEditor().updateOptions({readOnly:!0}))),this.files.forEach((function(e){null!=e.module&&(e.module.file.saved=!1)}))}},{key:"removeModule",value:function(e){var t,n=qi(this.files);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.module==e&&this.removeFile(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"renameElement",value:function(e,t){var n=e.$fileDiv.find(".jo_filename"),i=e.module.file.name.indexOf(".");ut(n,n,(function(i){e.module.file.name=i,n.html(i),null!=t&&t()}),null==i?null:{start:0,end:i})}},{key:"setFirstFileActive",value:function(){this.files.length>0&&this.selectFile(this.files[0])}},{key:"selectFile",value:function(e){var t=this;if(null!=e)switch(e.type){case"sql":this.main.$hintDiv.hide(),this.main.$monacoDiv.show(),this.main.setModuleActive(e.module),this.main.getMonacoEditor().focus();break;case"hint":this.main.$monacoDiv.hide(),this.main.$hintDiv.show();var n={},i=[],r=window.markdownit({highlight:function(e,t){return i.push(e),""}});r.renderer.rules.code_inline=function(e,t,n,r,o){var a=e[t];return i.push(a.content),""},r.render(e.hint),this.colorize(i,n,(function(){var i=window.markdownit({highlight:function(e,t){return n[e]}});i.renderer.rules.code_inline=function(e,t,i,r,o){var a=e[t];return n[a.content].replace("<br/>","")};var r=i.render(e.hint);t.main.$hintDiv.html(r)})),this.$fileListDiv.find(".jo_file").removeClass("jo_active"),e.$fileDiv.addClass("jo_active")}}},{key:"colorize",value:function(e,t,n){var i=this;if(e.length>0){var r=e.pop();monaco.editor.colorize(r,"myJava",{tabSize:3}).then((function(o){t[r]=o,i.colorize(e,t,n)}))}else n()}},{key:"markFile",value:function(e){this.$fileListDiv.find(".jo_file").removeClass("jo_active"),this.currentFile=this.files.find((function(t){return t.module==e})),null!=this.currentFile&&this.currentFile.$fileDiv.addClass("jo_active")}}])&&Hi(t.prototype,n),i&&Hi(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Vi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Gi=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.databaseIdentifier=t}var t,n,i;return t=e,(n=[{key:"open",value:function(e){if(window.indexedDB){var t=window.indexedDB.open(this.databaseIdentifier,1),n=this;t.onerror=function(e){console.log("Couldn't open IndexedDB: "+e.type)},t.onsuccess=function(i){n.db=t.result,n.db.onerror=function(e){console.log("Datenbankfehler: "+e.target.error.message)},e()},t.onupgradeneeded=function(e){n.db=e.target.result;var t=n.db.createObjectStore("scripts",{keyPath:"scriptId",autoIncrement:!1});t.transaction.oncomplete=function(e){},n.db.createObjectStore("databases",{keyPath:"databaseId",autoIncrement:!1}),t.transaction.oncomplete=function(e){}}}else console.log("IndexedDB not available.")}},{key:"writeScript",value:function(e,t){this.db.transaction("scripts","readwrite").objectStore("scripts").put({scriptId:e,script:t})}},{key:"removeScript",value:function(e){this.db.transaction("scripts","readwrite").objectStore("scripts").delete(e)}},{key:"getScript",value:function(e,t){var n=this.db.transaction("scripts","readwrite").objectStore("scripts").get(e);n.onerror=function(e){t(null)},n.onsuccess=function(e){null==n.result?t(null):t(n.result.script)}}},{key:"writeDatabase",value:function(e,t){this.db.transaction("databases","readwrite").objectStore("databases").put({databaseId:e,database:t})}},{key:"removeDatabase",value:function(e){this.db.transaction("databases","readwrite").objectStore("databases").delete(e)}},{key:"getDatabase",value:function(e,t){var n=this.db.transaction("databases","readwrite").objectStore("databases").get(e);n.onerror=function(e){t(null)},n.onsuccess=function(e){null==n.result?t(null):t(n.result.database)}}}])&&Vi(t.prototype,n),i&&Vi(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ji(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Yi=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t,this.databaseIdentifier=n,this.statementsToExecute=[],this.writtenStatements=[],this.statementsToWrite=[],this.atLeastOneExecuted=!1}var t,n,i;return t=e,(n=[{key:"indexedDBReady",value:function(e){var t=this;this.indexedDB=e,this.indexedDB.getDatabase(this.databaseIdentifier,(function(e){null!=e&&(t.writtenStatements=JSON.parse(e),t.statementsToExecute=t.writtenStatements.slice(),t.main.historyViewer.clear(),t.main.historyViewer.appendStatements(t.statementsToExecute),t.executeStatements(),t.writeStatementsIfNecessary())}))}},{key:"reset",value:function(){this.statementsToWrite=[],this.writtenStatements=[],this.statementsToExecute=[],this.main.historyViewer.clear()}},{key:"writeStatementsIfNecessary",value:function(){null!=this.indexedDB&&this.statementsToWrite.length>0&&this.forceWriteStatements()}},{key:"forceWriteStatements",value:function(){this.writtenStatements=this.writtenStatements.concat(this.statementsToWrite),this.statementsToWrite=[],this.indexedDB.writeDatabase(this.databaseIdentifier,JSON.stringify(this.writtenStatements))}},{key:"executeStatements",value:function(){var e=this;if(null!=this.databaseTool&&this.statementsToExecute.length>0){this.atLeastOneExecuted||(this.main.$databaseResetButton.fadeIn(200),this.count=this.statementsToExecute.length,this.main.waitOverlay.show("Schreibe lokale Datenbankänderungen ...")),this.main.waitOverlay.setProgress(Math.round(100*(1-this.statementsToExecute.length/this.count))+" %");var t=this.statementsToExecute.shift();this.atLeastOneExecuted=!0,this.databaseTool.executeQuery(t,(function(){e.executeStatements()}),(function(){e.executeStatements()}))}else this.atLeastOneExecuted&&(this.main.databaseExplorer.refresh(),this.atLeastOneExecuted=!1,this.main.waitOverlay.hide())}},{key:"notify",value:function(e){this.main.$databaseResetButton.fadeIn(200);var t=e.map((function(e){return null==e.sqlCleaned?e.sql:e.sqlCleaned}));this.statementsToWrite=this.statementsToWrite.concat(t),this.main.historyViewer.appendStatements(t),this.writeStatementsIfNecessary()}},{key:"databaseReady",value:function(e){this.databaseTool=e,this.executeStatements()}},{key:"rollback",value:function(){this.writeStatementsIfNecessary(),this.writtenStatements.pop(),this.forceWriteStatements()}}])&&Ji(t.prototype,n),i&&Ji(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Xi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Zi=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},er=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.main=t}var t,n,i;return t=e,(n=[{key:"load",value:function(e){return Zi(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.replace("https://","").replace("http://","").toLocaleLowerCase(),i=n.toLocaleLowerCase(),t.next=4,this.fetchTemplateFromCache(n);case 4:if(null==(r=t.sent)){t.next=8;break}return"binaryCompressed"==mn.getDumpType(r)&&(r=pako.inflate(r)),t.abrupt("return",{binDump:r});case 8:if(!i.endsWith(".sqlite")){t.next=14;break}return t.next=11,this.loadSqLiteDump(e,n);case 11:o=t.sent,t.next=18;break;case 14:if(!i.endsWith(".zip")&&!i.endsWith(".sql")){t.next=18;break}return t.next=17,this.loadMySql(e,n);case 17:o=t.sent;case 18:return this.saveDatabaseToCache(n,o.binDump),t.abrupt("return",o);case 20:case"end":return t.stop()}}),t,this)})))}},{key:"loadMySql",value:function(e,t){return new Tn(this.main).loadFromUrl(e)}},{key:"loadSqLiteDump",value:function(e,t){return Zi(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){jQuery.ajax({type:"GET",async:!0,url:e,xhrFields:{responseType:"arraybuffer"},success:function(e){var n=new Uint8Array(e);"binaryCompressed"==mn.getDumpType(n)&&(n=pako.inflate(n)),t({binDump:n})},error:function(e,t){n(t)}})})));case 1:case"end":return t.stop()}}),t)})))}},{key:"cutSqlToStatements",value:function(e){return(e=e.replace(/\r\n/g,"\n")).indexOf("~@~")>=0?e.split("~@~"):e.split(";\n")}},{key:"fetchTemplateFromCache",value:function(e){return Zi(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e){t.next=2;break}return t.abrupt("return",null);case 2:if(this.cacheAvailable()){t.next=4;break}return t.abrupt("return",null);case 4:return t.next=6,caches.open("my-cache");case 6:return n=t.sent,t.next=9,n.match(e);case 9:if(null!=(i=t.sent)){t.next=12;break}return t.abrupt("return",null);case 12:return t.next=14,i.arrayBuffer();case 14:return r=t.sent,t.abrupt("return",new Uint8Array(r));case 16:case"end":return t.stop()}}),t,this)})))}},{key:"saveDatabaseToCache",value:function(e,t){return Zi(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.cacheAvailable()){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,caches.open("my-cache");case 4:n.sent.put(e,new Response(t));case 6:case"end":return n.stop()}}),n,this)})))}},{key:"cacheAvailable",value:function(){return"caches"in self}}])&&Xi(t.prototype,n),i&&Xi(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function tr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return nr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ir(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var rr=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},or=function(){function e(t,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scriptList=n,this.programPointerDecoration=[],this.programIsExecutable=!1,this.version=0,this.compileRunsAfterCodeReset=0,this.readConfig(t),this.writeQueryManager=new Yi(this,null==this.config.databaseURL?"Empty database":this.config.databaseURL),this.initGUI(t),this.databaseExplorer=new vi(this,this.$dbTreeDiv),this.databaseTool=new mn(this),null!=this.config.databaseURL?new er(this).load(this.config.databaseURL).then((function(e){i.initialTemplateDump=e.binDump,i.initialStatements=null==e.statements?[]:e.statements,i.initDatabase()})).catch((function(e){alert("Fehler beim Landen der Datenbank: "+e)})):this.initDatabase(),this.semicolonAngel=new hi(this)}var t,n,i;return t=e,(n=[{key:"isEmbedded",value:function(){return!0}},{key:"getCompiler",value:function(){return this.compiler}},{key:"getCurrentWorkspace",value:function(){return this.currentWorkspace}},{key:"getMonacoEditor",value:function(){return this.editor.editor}},{key:"getRightDiv",value:function(){return this.rightDiv}},{key:"getBottomDiv",value:function(){return this.bottomDiv}},{key:"getActionManager",value:function(){return this.actionManager}},{key:"getCurrentlyEditedModule",value:function(){var e;return this.config.withFileList?null===(e=this.fileExplorer.currentFile)||void 0===e?void 0:e.module:this.currentWorkspace.moduleStore.getFirstModule()}},{key:"getDatabaseTool",value:function(){return this.databaseTool}},{key:"getDatabaseExplorer",value:function(){return this.databaseExplorer}},{key:"getResultsetPresenter",value:function(){return this.resultsetPresenter}},{key:"getWaitOverlay",value:function(){return this.waitOverlay}},{key:"getHistoryViewer",value:function(){return this.historyViewer}},{key:"initDatabase",value:function(){var e=this;this.resetDatabase((function(){e.initScripts(),e.indexedDB=new Gi("SQL-IDE"),e.indexedDB.open((function(){null!=e.config.id&&(e.writeQueryManager.indexedDBReady(e.indexedDB),e.readScripts())}))}))}},{key:"resetDatabase",value:function(e){var t=this;this.databaseTool.initializeWorker(this.initialTemplateDump,this.initialStatements,(function(){}),(function(){t.writeQueryManager.databaseReady(t.databaseTool),t.databaseExplorer.refreshAfterRetrievingDBStructure(),e()}))}},{key:"initScripts",value:function(){var e,t=this;null===(e=this.fileExplorer)||void 0===e||e.removeAllFiles(),this.initWorkspace(this.scriptList),this.config.withFileList?(this.fileExplorer=new Ki(this.currentWorkspace.moduleStore,this.$filesListDiv,this),this.fileExplorer.setFirstFileActive(),this.scriptList.filter((function(e){return"hint"==e.type})).forEach((function(e){return t.fileExplorer.addHint(e)}))):this.setModuleActive(this.currentWorkspace.moduleStore.getFirstModule())}},{key:"readConfig",value:function(e){var t=this,n=e.data("sql-online");this.config=null!=n&&"string"==typeof n?JSON.parse(n.split("'").join('"')):{},null==this.config.withFileList&&(this.config.withFileList=!1),null==this.config.withOutput&&(this.config.withOutput=!0),null==this.config.withErrorList&&(this.config.withErrorList=!0),null==this.config.withBottomPanel&&(this.config.withBottomPanel=!0),this.config.withOutput||this.config.withFileList||this.config.withErrorList||(this.config.withBottomPanel=!1),this.config.withBottomPanel||(this.config.withFileList=!1,this.config.withOutput=!1,this.config.withErrorList=!1),null!=this.config.databaseURL&&["http:","https:"].forEach((function(e){t.config.databaseURL.startsWith(e)&&!t.config.databaseURL.startsWith(e+"://")&&(t.config.databaseURL=t.config.databaseURL.replace(e,e+"//"))}))}},{key:"setModuleActive",value:function(e){this.config.withFileList&&null!=this.fileExplorer.currentFile&&(this.fileExplorer.currentFile.module.editorState=this.getMonacoEditor().saveViewState()),this.config.withFileList&&this.fileExplorer.markFile(e),this.getMonacoEditor().updateOptions({readOnly:!1,lineNumbersMinChars:4}),this.editor.editor.setModel(e.model),null!=e.editorState&&this.getMonacoEditor().restoreViewState(e.editorState)}},{key:"readScripts",value:function(){var e=this,t=this.currentWorkspace.moduleStore.getModules(!1),n=this;this.indexedDB.getScript(this.config.id,(function(i){var r;null==i?setInterval((function(){n.saveScripts()}),1e3):function(){var o,a=JSON.parse(i),s=a.length,l=tr(t);try{for(l.s();!(o=l.n()).done;){var u=o.value;null===(r=n.fileExplorer)||void 0===r||r.removeModule(u),n.removeModule(u)}}catch(e){l.e(e)}finally{l.f()}var c,d=tr(a);try{var h=function(){var t=c.value,i=e.config.id+t;e.indexedDB.getScript(i,(function(e){var i,r;if(null!=e){var o=n.addModule({title:t,text:e,type:"sql"});null===(i=n.fileExplorer)||void 0===i||i.addModule(o),n.$codeResetButton.fadeIn(1e3)}if(0==--s&&(setInterval((function(){n.saveScripts()}),1e3),null===(r=n.fileExplorer)||void 0===r||r.setFirstFileActive(),null==n.fileExplorer)){var a=n.currentWorkspace.moduleStore.getModules(!1);a.length>0&&n.setModuleActive(a[0])}}))};for(d.s();!(c=d.n()).done;)h()}catch(e){d.e(e)}finally{d.f()}}()}))}},{key:"saveScripts",value:function(){var e=this.currentWorkspace.moduleStore.getModules(!1),t=[],n=!1;if(e.forEach((function(e){return n=n||!e.file.saved})),n){var i,r=tr(e);try{for(r.s();!(i=r.n()).done;){var o=i.value;t.push(o.file.name);var a=this.config.id+o.file.name;this.indexedDB.writeScript(a,o.getProgramTextFromMonacoModel()),o.file.saved=!0}}catch(e){r.e(e)}finally{r.f()}this.indexedDB.writeScript(this.config.id,JSON.stringify(t))}}},{key:"deleteScriptsInDB",value:function(){var e=this;this.indexedDB.getScript(this.config.id,(function(t){if(null!=t){var n,i=tr(JSON.parse(t));try{for(i.s();!(n=i.n()).done;){var r=n.value,o=e.config.id+r;e.indexedDB.removeScript(o)}}catch(e){i.e(e)}finally{i.f()}e.indexedDB.removeScript(e.config.id)}}))}},{key:"initWorkspace",value:function(e){this.currentWorkspace=new Nt("Embedded-Workspace",this,0);var t,n=tr(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;"sql"==i.type&&this.addModule(i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"addModule",value:function(e){var t=tt.restoreFromData({id:this.currentWorkspace.moduleStore.getModules(!0).length,name:e.title,text:e.text,text_before_revision:null,submitted_date:null,student_edited_after_revision:!1,version:1,workspace_id:0,forceUpdate:!1,file_type:11},this);this.currentWorkspace.moduleStore.putModule(t);var n=this;return t.model.onDidChangeContent((function(){n.considerShowingCodeResetButton()})),t}},{key:"removeModule",value:function(e){this.currentWorkspace.moduleStore.removeModule(e)}},{key:"initGUI",value:function(e){var t=this;e.css({"background-image":"none","background-size":"100%"});var n=jQuery('<div class="joe_centerDiv"></div>');e.append(n);var i=this.makeWaitDiv();e.append(i),this.waitOverlay=new Ei(i);var r=this.makeCodeResetModalWindow(e),o=this.makeDatabaseResetModalWindow(e),a=this.makeRightDiv(),s=jQuery('<div class="joe_editorDiv"></div>');this.$monacoDiv=jQuery('<div class="joe_monacoDiv"></div>'),this.$hintDiv=jQuery('<div class="joe_hintDiv jo_scrollable"></div>'),this.$codeResetButton=jQuery('<div class="joe_codeResetButton jo_button jo_active" title="Code auf Ausgangszustand zurücksetzen">Code Reset</div>'),this.$databaseResetButton=jQuery('<div class="joe_databaseResetButton jo_button jo_active" title="Datenbank auf Ausgangszustand zurücksetzen">Datenbank Reset</div>'),s.append(this.$monacoDiv,this.$hintDiv,this.$databaseResetButton),this.$monacoDiv.append(this.$codeResetButton);var l=this.makeBracketErrorDiv();s.append(l),this.$codeResetButton.hide(),this.$codeResetButton.on("click",(function(){r.show()})),this.$databaseResetButton.hide(),this.$databaseResetButton.on("click",(function(){o.show()})),this.$hintDiv.hide();var u=jQuery('<div class="joe_controlsDiv"></div>'),c=jQuery('<div class="joe_bottomDivInner"></div>'),d=jQuery('<div class="joe_bottomDiv"></div>');if(this.makeBottomDiv(c,u),d.append(c),this.config.withFileList){var h=this.makeFilesDiv();d.prepend(h),new zi(h,!1,!1,(function(){}))}dt(c),e.append(d),e.addClass("joe_javaOnlineDiv"),this.editor=new ln(this,!1,!0),this.editor.initGUI(this.$monacoDiv),this.$monacoDiv.find(".monaco-editor").css("z-index","10"),null==e.attr("tabindex")&&e.attr("tabindex","0"),this.actionManager=new at(e,this),this.actionManager.init(),this.bottomDiv=new Qi(this,c,e),this.bottomDiv.initGUI(),this.rightDiv=new Jn(this,this.$rightDivInner),this.rightDiv.initGUI(),n.append(s,d),e.append(a);var f=jQuery('<div class="jo_rightdiv-rightside-container"></div>'),m=jQuery('<div class="jo_button jo_active img_ellipsis-dark" style="margin-right: 10px"></div>');u.append(m),this.$rightDivInner.append(f),new zi(a,!0,!1,(function(){t.editor.editor.layout()}),n),new zi(d,!0,!0,(function(){t.editor.editor.layout()})),m.on("mouseup",(function(e){e.preventDefault(),e.stopPropagation(),ct([{caption:"Über die Online-IDE ...",link:"https://learnj.de",callback:function(){}}],e.pageX+2,e.pageY+2)}));var p=jQuery('<label type="file" class="img_open-file jo_button jo_active"style="margin-right: 8px;" title="Datenbank-Dump aus Datei laden"><input type="file" style="display:none"></label>'),v=this,y=p.find("input");y.on("change",(function(e){var t=e.originalEvent.target.files;v.loadDatabaseFromFile(t[0]).then((function(){y.val(null)}))}));var g=jQuery('<div class="img_save-dark jo_button jo_active"style="margin-right: 8px;" title="Datenbank-Dump in Datei speichern"></div>');g.on("click",(function(){v.saveDatabaseToFile()})),u.append(p,g),this.resultsetPresenter=new Ti(this,c),this.resultsetPresenter.addWriteQueryListener(this.writeQueryManager),new bi(this,u),this.historyViewer=new Di(this,e.find(".jo_historyTab")),setTimeout((function(){t.editor.editor.layout(),t.compiler=new Ge(t),t.startTimer()}),200)}},{key:"saveDatabaseToFile",value:function(){(new Sn).saveToFile(this.databaseTool)}},{key:"loadDatabaseFromFile",value:function(e){return rr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Sn,t.next=3,n.loadFromFile(e,this);case 3:if(null!=(i=t.sent)){t.next=9;break}return alert("Es ist ein Fehler beim Import aufgetreten."),t.abrupt("return");case 9:this.databaseTool.initializeWorker(i.binDump,[],(function(e){e.length>0&&(alert("Es sind Fehler beim Import aufgetreten. Ausführliche Fehlermeldungen sehen Sie in der Konsole (F12)."),console.log(e))}),(function(){r.databaseExplorer.refreshAfterRetrievingDBStructure()}));case 10:return t.abrupt("return");case 11:case"end":return t.stop()}}),t,this)})))}},{key:"makeWaitDiv",value:function(){var e=(null==window.javaOnlineDir?"":window.javaOnlineDir)+"assets/projectexplorer/svg-loaders/grid.svg",t='\n        <div class="bitteWarten">\n        <div style="margin-bottom: 30px">\n            <div class="bitteWartenText" style="font-size: 20px"></div>\n        </div>\n        <div>\n            <img src="'.concat(e,'" alt="" style="height: 40px">\n        </div>\n        <div class="bitteWartenProgress" style="font-size: 20px"></div>\n        </div>\n        ');return jQuery(t)}},{key:"makeBracketErrorDiv",value:function(){return jQuery('\n        <div class="jo_parenthesis_warning" title="Klammerwarnung!" style="bottom: 55px">\n        <div class="jo_warning_light"></div>\n        <div class="jo_pw_heading">{ }</div>\n        <div title="Letzten Schritt rückgängig" \n            class="jo_pw_undo img_undo jo_button jo_active"></div>\n        </div>\n        ')}},{key:"makeCodeResetModalWindow",value:function(e){var t=this,n=jQuery('\n            <div class="joe_codeResetModal">\n            <div style="flex: 1"></div>\n            <div style="display: flex">\n                <div style="flex: 1"></div>\n                <div style="padding-left: 30px;">\n                <div style="color: red; margin-bottom: 10px; font-weight: bold">Warnung:</div>\n                <div>Soll der Code wirklich auf den Ausgangszustand zurückgesetzt werden?</div>\n                <div>Alle von Dir gemachten Änderungen werden damit verworfen.</div>\n                </div>\n                <div style="flex: 1"></div>\n            </div>\n            <div class="joe_codeResetModalButtons">\n            <div class="joe_codeResetModalCancel jo_button jo_active">Abbrechen</div>\n            <div class="joe_codeResetModalOK jo_button jo_active">OK</div>\n            </div>\n            <div style="flex: 2"></div>\n            </div>\n        ');return n.hide(),e.append(n),e.find(".joe_codeResetModalCancel").on("click",(function(){n.hide()})),e.find(".joe_codeResetModalOK").on("click",(function(){t.initScripts(),t.deleteScriptsInDB(),n.hide(),t.$codeResetButton.hide(),t.compileRunsAfterCodeReset=1})),n}},{key:"makeDatabaseResetModalWindow",value:function(e){var t=this,n=jQuery('\n            <div class="joe_databaseResetModal">\n            <div style="flex: 1"></div>\n            <div style="display: flex">\n                <div style="flex: 1"></div>\n                <div style="padding-left: 30px;">\n                <div style="color: red; margin-bottom: 10px; font-weight: bold">Warnung:</div>\n                <div>Soll die Datenbank wirklich auf den Ausgangszustand zurückgesetzt werden?</div>\n                <div>Alle bisher ausgeführten Anweisungen (siehe Tab Write History) werden dann rückgängig gemacht.</div>\n                </div>\n                <div style="flex: 1"></div>\n            </div>\n            <div class="joe_databaseResetModalButtons">\n            <div class="joe_databaseResetModalCancel jo_button jo_active">Abbrechen</div>\n            <div class="joe_databaseResetModalOK jo_button jo_active">OK</div>\n            </div>\n            <div style="flex: 2"></div>\n            </div>\n        ');return n.hide(),e.append(n),e.find(".joe_databaseResetModalCancel").on("click",(function(){n.hide()})),e.find(".joe_databaseResetModalOK").on("click",(function(){n.hide(),t.resetDatabase((function(){t.writeQueryManager.reset()})),t.$databaseResetButton.hide(),t.compileRunsAfterCodeReset=1})),n}},{key:"makeFilesDiv",value:function(){var e=jQuery('<div class="joe_bottomDivFiles jo_scrollable"></div>'),t=jQuery('<div class="joe_filesHeader jo_tabheading jo_active"  style="line-height: 24px">Dateien</div>');return this.$filesListDiv=jQuery('<div class="joe_filesList jo_scrollable"></div>'),e.append(t,this.$filesListDiv),e}},{key:"startTimer",value:function(){null!=this.timerHandle&&clearInterval(this.timerHandle);var e=this;this.timerHandle=setInterval((function(){e.compileIfDirty()}),500)}},{key:"compileIfDirty",value:function(){var e,t;if(null!=this.currentWorkspace&&this.currentWorkspace.moduleStore.isDirty()&&this.compiler.compilerStatus!=qe.compiling&&null!=this.getDatabaseTool().databaseStructure)try{this.compiler.compile(this.currentWorkspace.moduleStore),null===(t=null===(e=this.bottomDiv)||void 0===e?void 0:e.errorManager)||void 0===t||t.showErrors(this.currentWorkspace),this.editor.onDidChangeCursorPosition(null),this.version++}catch(e){console.error(e),this.compiler.compilerStatus=qe.error}}},{key:"considerShowingCodeResetButton",value:function(){this.compileRunsAfterCodeReset++,3==this.compileRunsAfterCodeReset&&this.$codeResetButton.fadeIn(1e3)}},{key:"makeBottomDiv",value:function(e,t){var n=jQuery('<div class="jo_tabheadings"></div>');n.css("position","relative");var i=jQuery('<div class="joe_tabheading-right jo_noHeading joe_controlsTabheading"></div>');if(i.append(t),n.append(i),this.config.withErrorList){var r=jQuery('<div class="jo_tabheading jo_active" data-target="jo_errorsTab" style="line-height: 24px">Fehler</div>');n.append(r)}if(this.config.withOutput){var o=jQuery('<div class="jo_tabheading jo_resultTabheading" data-target="jo_resultTab" style="line-height: 24px">Ausgabe</div>');n.append(o)}var a=jQuery('<div class="jo_tabheading jo_historyTabheading" data-target="jo_historyTab" style="line-height: 24px">Write History</div>');n.append(a);var s=jQuery('<div class="joe_tabheading-right jo_noHeading joe_paginationHeading"><div class="jo_pagination"></div></div>');n.append(s),e.append(n);var l=jQuery('<div class="jo_tabs jo_scrollable"></div>');if(this.config.withErrorList){var u=jQuery('<div class="jo_active jo_scrollable jo_errorsTab"></div>');l.append(u)}if(this.config.withOutput){var c=jQuery('<div class="jo_editorFontSize jo_resultTab">\n            <div class="jo_result-inner">\n                <div class="jo_result-header"></div>\n                <div class="jo_scrollable jo_result-body"></div>\n            </div>\n            </div>\n    ');l.append(c)}var d=jQuery('<div class="jo_scrollable jo_historyTab"></div>');l.append(d),e.append(l)}},{key:"makeRightDiv",value:function(){var e=jQuery('<div class="joe_rightDiv"></div>');this.$rightDivInner=jQuery('<div class="joe_rightDivInner"></div>'),e.append(this.$rightDivInner);var t=jQuery('<div class="jo_tabheadings"></div>');t.css("position","relative");var n=jQuery('<div class="jo_tabheading jo_active" data-target="jo_db_tree" style="line-height: 24px">DB (Baum)</div>');t.append(n),this.$rightDivInner.append(t);var i=jQuery('<div class="jo_tabs jo_scrollable"></div>');return this.$dbTreeDiv=jQuery('<div class="jo_tab jo_scrollable jo_editorFontSize jo_active jo_db_tree">DB-Baum</div>'),i.append(this.$dbTreeDiv),this.$rightDivInner.append(i),dt(e),e}},{key:"getSemicolonAngel",value:function(){return this.semicolonAngel}}])&&ir(t.prototype,n),i&&ir(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ar(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,"EmbeddedStarter",(function(){return sr}));var sr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.startupComplete=2,this.mainEmbeddedList=[]}var t,n,i;return t=e,(n=[{key:"initGUI",value:function(){this.checkStartupComplete(),this.themeManager=new k}},{key:"initEditor",value:function(){(new v).init(),this.checkStartupComplete()}},{key:"checkStartupComplete",value:function(){this.startupComplete--,0==this.startupComplete&&this.start()}},{key:"start",value:function(){this.initJavaOnlineDivs()}},{key:"initJavaOnlineDivs",value:function(){var e=this;jQuery(".sql-online").each((function(t,n){var i=jQuery(n),r=[];i.find("script").each((function(e,t){var n=jQuery(t),i="sql";null!=n.data("type")&&(i=n.data("type"));var o={type:i,title:n.attr("title"),text:n.text().trim()};r.push(o)})),e.initDiv(i,r)}))}},{key:"initDiv",value:function(e,t){new or(e,t)}}])&&ar(t.prototype,n),i&&ar(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();jQuery((function(){var e=new sr,t="",n="lib/monaco-editor/dev/vs";null!=window.javaOnlineDir&&(t=window.javaOnlineDir),null!=window.monacoEditorPath&&(n=window.monacoEditorPath),window.require.config({paths:{vs:t+n}}),window.require.config({"vs/nls":{availableLanguages:{"*":"de"}},ignoreDuplicateModules:["vs/editor/editor.main"]}),window.require(["vs/editor/editor.main"],(function(){e.initEditor(),e.initGUI()}))}))}]);
//# sourceMappingURL=sql-ide-embedded.js.map